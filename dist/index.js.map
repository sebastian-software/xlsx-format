{"version":3,"sources":["../src/zip/index.ts","../src/xml/parser.ts","../src/xml/escape.ts","../src/utils/helpers.ts","../src/xml/writer.ts","../src/xml/namespaces.ts","../src/opc/content-types.ts","../src/opc/relationships.ts","../src/opc/core-properties.ts","../src/opc/extended-properties.ts","../src/opc/custom-properties.ts","../src/utils/buffer.ts","../src/xlsx/shared-strings.ts","../src/ssf/table.ts","../src/xlsx/styles.ts","../src/xlsx/theme.ts","../src/xlsx/workbook.ts","../src/utils/cell.ts","../src/utils/date.ts","../src/ssf/format.ts","../src/xlsx/worksheet.ts","../src/xlsx/comments.ts","../src/xlsx/vml.ts","../src/xlsx/metadata.ts","../src/xlsx/calc-chain.ts","../src/xlsx/parse-zip.ts","../src/utils/base64.ts","../src/read.ts","../src/xlsx/write-zip.ts","../src/write.ts","../src/api/book.ts","../src/api/aoa.ts","../src/types.ts","../src/api/format.ts","../src/api/json.ts","../src/api/csv.ts","../src/api/html.ts","../src/index.ts"],"names":["s","addr","wxt_helper","resolve_path","sheets","fs2","fs"],"mappings":"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","file":"index.js","sourcesContent":["import { unzipSync, zipSync, type Unzipped, type Zippable } from \"fflate\";\n\nexport interface ZipEntry {\n\tdata: Uint8Array;\n\tname: string;\n}\n\nexport interface ZipArchive {\n\tfiles: Record<string, Uint8Array>;\n}\n\nconst encoder = new TextEncoder();\nconst decoder = new TextDecoder();\n\n/** Read a ZIP archive from a Uint8Array */\nexport function zip_read(data: Uint8Array): ZipArchive {\n\tconst unzipped = unzipSync(data);\n\treturn { files: unzipped as Record<string, Uint8Array> };\n}\n\n/** Write a ZIP archive to a Uint8Array */\nexport function zip_write(archive: ZipArchive, compress?: boolean): Uint8Array {\n\tconst zippable: Zippable = {};\n\tfor (const [name, data] of Object.entries(archive.files)) {\n\t\tzippable[name] = compress ? data : [data, { level: 0 }];\n\t}\n\treturn zipSync(zippable);\n}\n\n/** Get a file from a ZIP archive as string */\nexport function zip_read_str(archive: ZipArchive, path: string): string | null {\n\t// Try exact path first\n\tlet data = archive.files[path];\n\tif (!data) {\n\t\t// Try without leading slash\n\t\tconst normalized = path.startsWith(\"/\") ? path.slice(1) : \"/\" + path;\n\t\tdata = archive.files[normalized];\n\t}\n\tif (!data) return null;\n\treturn decoder.decode(data);\n}\n\n/** Get a file from a ZIP archive as Uint8Array */\nexport function zip_read_bin(archive: ZipArchive, path: string): Uint8Array | null {\n\tlet data = archive.files[path];\n\tif (!data) {\n\t\tconst normalized = path.startsWith(\"/\") ? path.slice(1) : \"/\" + path;\n\t\tdata = archive.files[normalized];\n\t}\n\treturn data ?? null;\n}\n\n/** Add a string file to a ZIP archive */\nexport function zip_add_str(archive: ZipArchive, path: string, content: string): void {\n\tarchive.files[path] = encoder.encode(content);\n}\n\n/** Add a binary file to a ZIP archive */\nexport function zip_add_bin(archive: ZipArchive, path: string, data: Uint8Array): void {\n\tarchive.files[path] = data;\n}\n\n/** Create a new empty ZIP archive */\nexport function zip_new(): ZipArchive {\n\treturn { files: {} };\n}\n\n/** List all file paths in a ZIP archive */\nexport function zip_list(archive: ZipArchive): string[] {\n\treturn Object.keys(archive.files);\n}\n\n/** Check if a file exists in the archive (case-insensitive fallback) */\nexport function zip_has(archive: ZipArchive, path: string): boolean {\n\tif (archive.files[path]) return true;\n\tconst normalized = path.startsWith(\"/\") ? path.slice(1) : \"/\" + path;\n\tif (archive.files[normalized]) return true;\n\t// Case-insensitive search\n\tconst lpath = path.toLowerCase();\n\tfor (const k of Object.keys(archive.files)) {\n\t\tif (k.toLowerCase() === lpath) return true;\n\t}\n\treturn false;\n}\n\n/** Find a file path in the archive (case-insensitive) */\nexport function zip_find(archive: ZipArchive, path: string): string | null {\n\tif (archive.files[path]) return path;\n\tconst normalized = path.startsWith(\"/\") ? path.slice(1) : \"/\" + path;\n\tif (archive.files[normalized]) return normalized;\n\tconst lpath = path.toLowerCase();\n\tfor (const k of Object.keys(archive.files)) {\n\t\tif (k.toLowerCase() === lpath) return k;\n\t}\n\treturn null;\n}\n","const attregexg =\n\t/\\s([^\"\\s?>\\/]+)\\s*=\\s*((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:')|([^'\">\\s]+))/g;\nconst tagregex1 =\n\t/<[\\/\\?]?[a-zA-Z0-9:_-]+(?:\\s+[^\"\\s?<>\\/]+\\s*=\\s*(?:\"[^\"]*\"|'[^']*'|[^'\"<>\\s=]+))*\\s*[\\/\\?]?>/gm;\nconst tagregex2 = /<[^<>]*>/g;\n\nexport const XML_HEADER = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n';\n\nexport const tagregex: RegExp = XML_HEADER.match(tagregex1) ? tagregex1 : tagregex2;\n\nconst nsregex2 = /<(\\/?)\\w+:/;\n\n/** Parse XML attributes from a tag string */\nexport function parsexmltag(tag: string, skip_root?: boolean, skip_LC?: boolean): Record<string, any> {\n\tconst z: Record<string, any> = {};\n\tlet eq = 0;\n\tlet c = 0;\n\tfor (; eq !== tag.length; ++eq) if ((c = tag.charCodeAt(eq)) === 32 || c === 10 || c === 13) break;\n\tif (!skip_root) z[0] = tag.slice(0, eq);\n\tif (eq === tag.length) return z;\n\tconst m = tag.match(attregexg);\n\tif (m) {\n\t\tfor (let i = 0; i < m.length; ++i) {\n\t\t\tconst cc = m[i].slice(1);\n\t\t\tlet c2 = 0;\n\t\t\tfor (c2 = 0; c2 < cc.length; ++c2) if (cc.charCodeAt(c2) === 61) break;\n\t\t\tlet q = cc.slice(0, c2).trim();\n\t\t\twhile (cc.charCodeAt(c2 + 1) === 32) ++c2;\n\t\t\tconst quot = (eq = cc.charCodeAt(c2 + 1)) === 34 || eq === 39 ? 1 : 0;\n\t\t\tconst v = cc.slice(c2 + 1 + quot, cc.length - quot);\n\t\t\tlet j = 0;\n\t\t\tfor (j = 0; j < q.length; ++j) if (q.charCodeAt(j) === 58) break;\n\t\t\tif (j === q.length) {\n\t\t\t\tif (q.indexOf(\"_\") > 0) q = q.slice(0, q.indexOf(\"_\"));\n\t\t\t\tz[q] = v;\n\t\t\t\tif (!skip_LC) z[q.toLowerCase()] = v;\n\t\t\t} else {\n\t\t\t\tconst k = (j === 5 && q.slice(0, 5) === \"xmlns\" ? \"xmlns\" : \"\") + q.slice(j + 1);\n\t\t\t\tif (z[k] && q.slice(j - 3, j) === \"ext\") continue;\n\t\t\t\tz[k] = v;\n\t\t\t\tif (!skip_LC) z[k.toLowerCase()] = v;\n\t\t\t}\n\t\t}\n\t}\n\treturn z;\n}\n\n/** Strip namespace prefixes from XML */\nexport function strip_ns(x: string): string {\n\treturn x.replace(nsregex2, \"<$1\");\n}\n\n/** Parse xsd:boolean values */\nexport function parsexmlbool(value: any): boolean {\n\tswitch (value) {\n\t\tcase 1:\n\t\tcase true:\n\t\tcase \"1\":\n\t\tcase \"true\":\n\t\t\treturn true;\n\t\tcase 0:\n\t\tcase false:\n\t\tcase \"0\":\n\t\tcase \"false\":\n\t\t\treturn false;\n\t}\n\treturn false;\n}\n","const encodings: Record<string, string> = {\n\t\"&quot;\": '\"',\n\t\"&apos;\": \"'\",\n\t\"&gt;\": \">\",\n\t\"&lt;\": \"<\",\n\t\"&amp;\": \"&\",\n};\n\nconst rencoding: Record<string, string> = {\n\t'\"': \"&quot;\",\n\t\"'\": \"&apos;\",\n\t\">\": \"&gt;\",\n\t\"<\": \"&lt;\",\n\t\"&\": \"&amp;\",\n};\n\nconst encregex = /&(?:quot|apos|gt|lt|amp|#x?([\\da-fA-F]+));/gi;\nconst coderegex = /_x([\\da-fA-F]{4})_/g;\nconst decregex = /[&<>'\"]/g;\nconst charegex = /[\\u0000-\\u0008\\u000b-\\u001f\\uFFFE-\\uFFFF]/g;\n\nfunction raw_unescapexml(text: string): string {\n\tconst s = text + \"\";\n\tconst i = s.indexOf(\"<![CDATA[\");\n\tif (i === -1) {\n\t\treturn s\n\t\t\t.replace(encregex, ($$, $1) => {\n\t\t\t\treturn (\n\t\t\t\t\tencodings[$$] || String.fromCharCode(parseInt($1, $$.indexOf(\"x\") > -1 ? 16 : 10)) || $$\n\t\t\t\t);\n\t\t\t})\n\t\t\t.replace(coderegex, (_m, c) => {\n\t\t\t\treturn String.fromCharCode(parseInt(c, 16));\n\t\t\t});\n\t}\n\tconst j = s.indexOf(\"]]>\");\n\treturn raw_unescapexml(s.slice(0, i)) + s.slice(i + 9, j) + raw_unescapexml(s.slice(j + 3));\n}\n\n/** Unescape XML entities. When xlsx=true, normalize \\r\\n -> \\n */\nexport function unescapexml(text: string, xlsx?: boolean): string {\n\tconst out = raw_unescapexml(text);\n\treturn xlsx ? out.replace(/\\r\\n/g, \"\\n\") : out;\n}\n\n/** Escape a string for XML text content */\nexport function escapexml(text: string): string {\n\tconst s = text + \"\";\n\treturn s\n\t\t.replace(decregex, (y) => rencoding[y])\n\t\t.replace(charegex, (s) => \"_x\" + (\"000\" + s.charCodeAt(0).toString(16)).slice(-4) + \"_\");\n}\n\n/** Escape a string for XML tag names (spaces -> _x0020_) */\nexport function escapexmltag(text: string): string {\n\treturn escapexml(text).replace(/ /g, \"_x0020_\");\n}\n\nconst htmlcharegex = /[\\u0000-\\u001f]/g;\n\n/** Escape a string for HTML output */\nexport function escapehtml(text: string): string {\n\tconst s = text + \"\";\n\treturn s\n\t\t.replace(decregex, (y) => rencoding[y])\n\t\t.replace(/\\n/g, \"<br/>\")\n\t\t.replace(htmlcharegex, (s) => \"&#x\" + (\"000\" + s.charCodeAt(0).toString(16)).slice(-4) + \";\");\n}\n\nconst entities: [RegExp, string][] = [\n\t[\"nbsp\", \" \"],\n\t[\"middot\", \"\\u00B7\"],\n\t[\"quot\", '\"'],\n\t[\"apos\", \"'\"],\n\t[\"gt\", \">\"],\n\t[\"lt\", \"<\"],\n\t[\"amp\", \"&\"],\n].map(([name, ch]) => [new RegExp(\"&\" + name + \";\", \"gi\"), ch as string]);\n\n/** Decode HTML entities */\nexport function htmldecode(str: string): string {\n\tlet o = str\n\t\t.replace(/^[\\t\\n\\r ]+/, \"\")\n\t\t.replace(/(^|[^\\t\\n\\r ])[\\t\\n\\r ]+$/, \"$1\")\n\t\t.replace(/>\\s+/g, \">\")\n\t\t.replace(/\\b\\s+</g, \"<\")\n\t\t.replace(/[\\t\\n\\r ]+/g, \" \")\n\t\t.replace(/<\\s*[bB][rR]\\s*\\/?>/g, \"\\n\")\n\t\t.replace(/<[^<>]*>/g, \"\");\n\tfor (let i = 0; i < entities.length; ++i) o = o.replace(entities[i][0], entities[i][1]);\n\treturn o;\n}\n","/** Fill string with repeated character */\nexport function fill(c: string, l: number): string {\n\tlet o = \"\";\n\twhile (o.length < l) o += c;\n\treturn o;\n}\n\n/** Object keys helper */\nexport function keys<T extends object>(o: T): string[] {\n\treturn Object.keys(o);\n}\n\n/** Reverse map: values become keys */\nexport function evert(obj: Record<string, string>): Record<string, string> {\n\tconst o: Record<string, string> = {};\n\tfor (const k of Object.keys(obj)) o[obj[k]] = k;\n\treturn o;\n}\n\n/** Shallow clone */\nexport function dup<T>(o: T): T {\n\tif (typeof o === \"object\" && o !== null) {\n\t\tif (Array.isArray(o)) return o.slice() as T;\n\t\tconst out = {} as any;\n\t\tfor (const k of Object.keys(o as any)) out[k] = (o as any)[k];\n\t\treturn out as T;\n\t}\n\treturn o;\n}\n\n/** Match XML namespace-agnostic tags globally */\nexport function str_match_xml_ns_g(str: string, tag: string): string[] | null {\n\tconst re = new RegExp(\"<(?:\\\\w+:)?\" + tag + \"[\\\\s>][\\\\s\\\\S]*?<\\\\/(?:\\\\w+:)?\" + tag + \">\", \"g\");\n\treturn str.match(re);\n}\n\n/** Match XML namespace-agnostic tag (first) */\nexport function str_match_xml_ns(str: string, tag: string): string | null {\n\tconst m = str_match_xml_ns_g(str, tag);\n\treturn m ? m[0] : null;\n}\n","import { escapexml } from \"./escape.js\";\nimport { keys } from \"../utils/helpers.js\";\n\nconst wtregex = /(^\\s|\\s$|\\n)/;\n\n/** Write an XML tag with text content */\nexport function writetag(f: string, g: string): string {\n\treturn \"<\" + f + (g.match(wtregex) ? ' xml:space=\"preserve\"' : \"\") + \">\" + g + \"</\" + f + \">\";\n}\n\nfunction wxt_helper(h: Record<string, string>): string {\n\treturn keys(h)\n\t\t.map((k) => \" \" + k + '=\"' + h[k] + '\"')\n\t\t.join(\"\");\n}\n\n/** Write an XML tag with optional attributes and content */\nexport function writextag(f: string, g?: string | null, h?: Record<string, string> | null): string {\n\treturn (\n\t\t\"<\" +\n\t\tf +\n\t\t(h != null ? wxt_helper(h) : \"\") +\n\t\t(g != null\n\t\t\t? (g.match(wtregex) ? ' xml:space=\"preserve\"' : \"\") + \">\" + g + \"</\" + f\n\t\t\t: \"/\") +\n\t\t\">\"\n\t);\n}\n\n/** Write a W3C datetime string from a Date */\nexport function write_w3cdtf(d: Date, t?: boolean): string {\n\ttry {\n\t\treturn d.toISOString().replace(/\\.\\d*/, \"\");\n\t} catch (e) {\n\t\tif (t) throw e;\n\t}\n\treturn \"\";\n}\n\n/** Write a vt: (variant type) XML element */\nexport function write_vt(s: any, xlsx?: boolean): string {\n\tswitch (typeof s) {\n\t\tcase \"string\": {\n\t\t\tlet o = writextag(\"vt:lpwstr\", escapexml(s));\n\t\t\tif (xlsx) o = o.replace(/&quot;/g, \"_x0022_\");\n\t\t\treturn o;\n\t\t}\n\t\tcase \"number\":\n\t\t\treturn writextag((s | 0) === s ? \"vt:i4\" : \"vt:r8\", escapexml(String(s)));\n\t\tcase \"boolean\":\n\t\t\treturn writextag(\"vt:bool\", s ? \"true\" : \"false\");\n\t}\n\tif (s instanceof Date) return writextag(\"vt:filetime\", write_w3cdtf(s));\n\tthrow new Error(\"Unable to serialize \" + s);\n}\n","export const XMLNS: Record<string, string> = {\n\tCORE_PROPS: \"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\",\n\tCUST_PROPS: \"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties\",\n\tEXT_PROPS: \"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\",\n\tCT: \"http://schemas.openxmlformats.org/package/2006/content-types\",\n\tRELS: \"http://schemas.openxmlformats.org/package/2006/relationships\",\n\tTCMNT: \"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments\",\n\tdc: \"http://purl.org/dc/elements/1.1/\",\n\tdcterms: \"http://purl.org/dc/terms/\",\n\tdcmitype: \"http://purl.org/dc/dcmitype/\",\n\tmx: \"http://schemas.microsoft.com/office/mac/excel/2008/main\",\n\tr: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships\",\n\tsjs: \"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties\",\n\tvt: \"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\",\n\txsi: \"http://www.w3.org/2001/XMLSchema-instance\",\n\txsd: \"http://www.w3.org/2001/XMLSchema\",\n};\n\nexport const XMLNS_main = [\n\t\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\",\n\t\"http://purl.oclc.org/ooxml/spreadsheetml/main\",\n\t\"http://schemas.microsoft.com/office/excel/2006/main\",\n\t\"http://schemas.microsoft.com/office/excel/2006/2\",\n];\n\nexport const RELS = {\n\tWB: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",\n\tSHEET: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\",\n\tCHARTSHEET: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet\",\n\tHLINK: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink\",\n\tVML: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing\",\n\tCMNT: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments\",\n\tCORE_PROPS: \"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\",\n\tEXT_PROPS:\n\t\t\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties\",\n\tCUST_PROPS:\n\t\t\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties\",\n\tSST: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\",\n\tSTY: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\",\n\tTHEME: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\",\n\tCHART: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart\",\n\tCCHAIN: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain\",\n\tTCMNT: \"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment\",\n\tPEOPLE: \"http://schemas.microsoft.com/office/2017/10/relationships/person\",\n\tDRAWING: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing\",\n\tMETA: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata\",\n\tXLINK: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink\",\n};\n","import { parsexmltag, XML_HEADER, tagregex } from \"../xml/parser.js\";\nimport { writextag } from \"../xml/writer.js\";\nimport { XMLNS } from \"../xml/namespaces.js\";\n\nconst nsregex = /<(\\w+):/;\n\n/** Map content types to internal categories */\nconst ct2type: Record<string, string> = {\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\": \"workbooks\",\n\t\"application/vnd.ms-excel.sheet.macroEnabled.main+xml\": \"workbooks\",\n\t\"application/vnd.ms-excel.sheet.binary.macroEnabled.main\": \"workbooks\",\n\t\"application/vnd.ms-excel.addin.macroEnabled.main+xml\": \"workbooks\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml\": \"workbooks\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\": \"sheets\",\n\t\"application/vnd.ms-excel.worksheet\": \"sheets\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml\": \"charts\",\n\t\"application/vnd.ms-excel.chartsheet\": \"charts\",\n\t\"application/vnd.ms-excel.macrosheet+xml\": \"macros\",\n\t\"application/vnd.ms-excel.macrosheet\": \"macros\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml\": \"dialogs\",\n\t\"application/vnd.ms-excel.dialogsheet\": \"dialogs\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\": \"strs\",\n\t\"application/vnd.ms-excel.sharedStrings\": \"strs\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\": \"styles\",\n\t\"application/vnd.ms-excel.styles\": \"styles\",\n\t\"application/vnd.openxmlformats-package.core-properties+xml\": \"coreprops\",\n\t\"application/vnd.openxmlformats-officedocument.custom-properties+xml\": \"custprops\",\n\t\"application/vnd.openxmlformats-officedocument.extended-properties+xml\": \"extprops\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\": \"comments\",\n\t\"application/vnd.ms-excel.comments\": \"comments\",\n\t\"application/vnd.ms-excel.threadedcomments+xml\": \"threadedcomments\",\n\t\"application/vnd.ms-excel.person+xml\": \"people\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml\": \"metadata\",\n\t\"application/vnd.ms-excel.sheetMetadata\": \"metadata\",\n\t\"application/vnd.ms-excel.calcChain\": \"calcchains\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml\": \"calcchains\",\n\t\"application/vnd.openxmlformats-officedocument.theme+xml\": \"themes\",\n\t\"application/vnd.ms-office.vbaProject\": \"vba\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml\": \"links\",\n\t\"application/vnd.ms-excel.externalLink\": \"links\",\n\t\"application/vnd.openxmlformats-officedocument.drawing+xml\": \"drawings\",\n\t\"application/vnd.openxmlformats-package.relationships+xml\": \"rels\",\n};\n\nconst CT_LIST: Record<string, Record<string, string>> = {\n\tworkbooks: {\n\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\",\n\t\txlsm: \"application/vnd.ms-excel.sheet.macroEnabled.main+xml\",\n\t},\n\tstrs: {\n\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\",\n\t},\n\tcomments: {\n\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\",\n\t},\n\tsheets: {\n\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\",\n\t},\n\tcharts: {\n\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml\",\n\t},\n\tdialogs: {\n\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml\",\n\t},\n\tmacros: {\n\t\txlsx: \"application/vnd.ms-excel.macrosheet+xml\",\n\t},\n\tmetadata: {\n\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml\",\n\t},\n\tstyles: {\n\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\",\n\t},\n};\n\nexport interface ContentTypes {\n\tworkbooks: string[];\n\tsheets: string[];\n\tcharts: string[];\n\tdialogs: string[];\n\tmacros: string[];\n\trels: string[];\n\tstrs: string[];\n\tcomments: string[];\n\tthreadedcomments: string[];\n\tlinks: string[];\n\tcoreprops: string[];\n\textprops: string[];\n\tcustprops: string[];\n\tthemes: string[];\n\tstyles: string[];\n\tcalcchains: string[];\n\tvba: string[];\n\tdrawings: string[];\n\tmetadata: string[];\n\tpeople: string[];\n\txmlns: string;\n\tcalcchain?: string;\n\tsst?: string;\n\tstyle?: string;\n\tdefaults?: Record<string, string>;\n}\n\nexport function new_ct(): ContentTypes {\n\treturn {\n\t\tworkbooks: [],\n\t\tsheets: [],\n\t\tcharts: [],\n\t\tdialogs: [],\n\t\tmacros: [],\n\t\trels: [],\n\t\tstrs: [],\n\t\tcomments: [],\n\t\tthreadedcomments: [],\n\t\tlinks: [],\n\t\tcoreprops: [],\n\t\textprops: [],\n\t\tcustprops: [],\n\t\tthemes: [],\n\t\tstyles: [],\n\t\tcalcchains: [],\n\t\tvba: [],\n\t\tdrawings: [],\n\t\tmetadata: [],\n\t\tpeople: [],\n\t\txmlns: \"\",\n\t};\n}\n\nexport function parse_ct(data: string | null | undefined): ContentTypes {\n\tconst ct = new_ct();\n\tif (!data) return ct;\n\tconst ctext: Record<string, string> = {};\n\tconst matches = data.match(tagregex) || [];\n\tfor (const x of matches) {\n\t\tconst y = parsexmltag(x);\n\t\tswitch ((y[0] as string).replace(nsregex, \"<\")) {\n\t\t\tcase \"<?xml\":\n\t\t\t\tbreak;\n\t\t\tcase \"<Types\":\n\t\t\t\tct.xmlns = y[\"xmlns\" + ((y[0] as string).match(/<(\\w+):/) || [\"\", \"\"])[1]];\n\t\t\t\tbreak;\n\t\t\tcase \"<Default\":\n\t\t\t\tctext[y.Extension.toLowerCase()] = y.ContentType;\n\t\t\t\tbreak;\n\t\t\tcase \"<Override\":\n\t\t\t\tif (ct2type[y.ContentType] && (ct as any)[ct2type[y.ContentType]] !== undefined) {\n\t\t\t\t\t(ct as any)[ct2type[y.ContentType]].push(y.PartName);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tif (ct.xmlns !== XMLNS.CT) throw new Error(\"Unknown Namespace: \" + ct.xmlns);\n\tct.calcchain = ct.calcchains.length > 0 ? ct.calcchains[0] : \"\";\n\tct.sst = ct.strs.length > 0 ? ct.strs[0] : \"\";\n\tct.style = ct.styles.length > 0 ? ct.styles[0] : \"\";\n\tct.defaults = ctext;\n\treturn ct;\n}\n\n/** Build reverse map from type category to content-type strings */\nfunction evert_arr(obj: Record<string, string>): Record<string, string[]> {\n\tconst o: Record<string, string[]> = {};\n\tfor (const [k, v] of Object.entries(obj)) {\n\t\tif (!o[v]) o[v] = [];\n\t\to[v].push(k);\n\t}\n\treturn o;\n}\n\nexport function write_ct(ct: ContentTypes, opts: { bookType?: string }): string {\n\tconst type2ct = evert_arr(ct2type);\n\tconst o: string[] = [];\n\n\to.push(XML_HEADER);\n\to.push(\n\t\twritextag(\"Types\", null, {\n\t\t\txmlns: XMLNS.CT,\n\t\t\t\"xmlns:xsd\": XMLNS.xsd,\n\t\t\t\"xmlns:xsi\": XMLNS.xsi,\n\t\t}),\n\t);\n\n\tconst defaults: [string, string][] = [\n\t\t[\"xml\", \"application/xml\"],\n\t\t[\"bin\", \"application/vnd.ms-excel.sheet.binary.macroEnabled.main\"],\n\t\t[\"vml\", \"application/vnd.openxmlformats-officedocument.vmlDrawing\"],\n\t\t[\"data\", \"application/vnd.openxmlformats-officedocument.model+data\"],\n\t\t[\"bmp\", \"image/bmp\"],\n\t\t[\"png\", \"image/png\"],\n\t\t[\"gif\", \"image/gif\"],\n\t\t[\"emf\", \"image/x-emf\"],\n\t\t[\"wmf\", \"image/x-wmf\"],\n\t\t[\"jpg\", \"image/jpeg\"],\n\t\t[\"jpeg\", \"image/jpeg\"],\n\t\t[\"tif\", \"image/tiff\"],\n\t\t[\"tiff\", \"image/tiff\"],\n\t\t[\"pdf\", \"application/pdf\"],\n\t\t[\"rels\", \"application/vnd.openxmlformats-package.relationships+xml\"],\n\t];\n\n\tfor (const [ext, contentType] of defaults) {\n\t\to.push(writextag(\"Default\", null, { Extension: ext, ContentType: contentType }));\n\t}\n\n\tconst f1 = (w: string) => {\n\t\tif ((ct as any)[w] && (ct as any)[w].length > 0) {\n\t\t\tconst v = (ct as any)[w][0];\n\t\t\to.push(\n\t\t\t\twritextag(\"Override\", null, {\n\t\t\t\t\tPartName: (v[0] === \"/\" ? \"\" : \"/\") + v,\n\t\t\t\t\tContentType: CT_LIST[w]?.[opts.bookType || \"xlsx\"] || CT_LIST[w]?.[\"xlsx\"],\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\t};\n\n\tconst f2 = (w: string) => {\n\t\tfor (const v of (ct as any)[w] || []) {\n\t\t\to.push(\n\t\t\t\twritextag(\"Override\", null, {\n\t\t\t\t\tPartName: (v[0] === \"/\" ? \"\" : \"/\") + v,\n\t\t\t\t\tContentType: CT_LIST[w]?.[opts.bookType || \"xlsx\"] || CT_LIST[w]?.[\"xlsx\"],\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\t};\n\n\tconst f3 = (t: string) => {\n\t\tfor (const v of (ct as any)[t] || []) {\n\t\t\to.push(\n\t\t\t\twritextag(\"Override\", null, {\n\t\t\t\t\tPartName: (v[0] === \"/\" ? \"\" : \"/\") + v,\n\t\t\t\t\tContentType: type2ct[t]?.[0],\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\t};\n\n\tf1(\"workbooks\");\n\tf2(\"sheets\");\n\tf2(\"charts\");\n\tf3(\"themes\");\n\tf1(\"strs\");\n\tf1(\"styles\");\n\tf3(\"coreprops\");\n\tf3(\"extprops\");\n\tf3(\"custprops\");\n\tf3(\"vba\");\n\tf3(\"comments\");\n\tf3(\"threadedcomments\");\n\tf3(\"drawings\");\n\tf2(\"metadata\");\n\tf3(\"people\");\n\n\tif (o.length > 2) {\n\t\to.push(\"</Types>\");\n\t\to[1] = o[1].replace(\"/>\", \">\");\n\t}\n\treturn o.join(\"\");\n}\n","import { parsexmltag, XML_HEADER, tagregex } from \"../xml/parser.js\";\nimport { unescapexml } from \"../xml/escape.js\";\nimport { writextag } from \"../xml/writer.js\";\nimport { XMLNS, RELS } from \"../xml/namespaces.js\";\n\nexport interface RelEntry {\n\tId: string;\n\tType: string;\n\tTarget: string;\n\tTargetMode?: string;\n}\n\nexport interface Relationships {\n\t[target: string]: any;\n\t\"!id\": Record<string, RelEntry>;\n\t\"!idx\"?: number;\n}\n\n/** Resolve relative path against current file path */\nfunction resolve_path(target: string, basePath: string): string {\n\tif (target.charAt(0) === \"/\") return target;\n\tconst base = basePath.slice(0, basePath.lastIndexOf(\"/\") + 1);\n\tconst parts = (base + target).split(\"/\");\n\tconst resolved: string[] = [];\n\tfor (const p of parts) {\n\t\tif (p === \"..\") resolved.pop();\n\t\telse if (p !== \".\") resolved.push(p);\n\t}\n\treturn resolved.join(\"/\");\n}\n\n/** Get the .rels path for a given file */\nexport function get_rels_path(file: string): string {\n\tconst n = file.lastIndexOf(\"/\");\n\treturn file.slice(0, n + 1) + \"_rels/\" + file.slice(n + 1) + \".rels\";\n}\n\n/** Parse a .rels XML file */\nexport function parse_rels(data: string | null | undefined, currentFilePath: string): Relationships {\n\tconst rels = { \"!id\": {} } as any as Relationships;\n\tif (!data) return rels;\n\tif (currentFilePath.charAt(0) !== \"/\") {\n\t\tcurrentFilePath = \"/\" + currentFilePath;\n\t}\n\n\tconst matches = data.match(tagregex) || [];\n\tfor (const x of matches) {\n\t\tconst y = parsexmltag(x);\n\t\tif (y[0] === \"<Relationship\") {\n\t\t\tconst rel: RelEntry = {\n\t\t\t\tType: y.Type,\n\t\t\t\tTarget: unescapexml(y.Target),\n\t\t\t\tId: y.Id,\n\t\t\t};\n\t\t\tif (y.TargetMode) rel.TargetMode = y.TargetMode;\n\t\t\tconst canonictarget =\n\t\t\t\ty.TargetMode === \"External\" ? y.Target : resolve_path(y.Target, currentFilePath);\n\t\t\t(rels as any)[canonictarget] = rel;\n\t\t\trels[\"!id\"][y.Id] = rel;\n\t\t}\n\t}\n\treturn rels;\n}\n\n/** Serialize relationships to XML */\nexport function write_rels(rels: Relationships): string {\n\tconst o: string[] = [\n\t\tXML_HEADER,\n\t\twritextag(\"Relationships\", null, {\n\t\t\txmlns: XMLNS.RELS,\n\t\t}),\n\t];\n\tfor (const rid of Object.keys(rels[\"!id\"])) {\n\t\to.push(writextag(\"Relationship\", null, rels[\"!id\"][rid] as any));\n\t}\n\tif (o.length > 2) {\n\t\to.push(\"</Relationships>\");\n\t\to[1] = o[1].replace(\"/>\", \">\");\n\t}\n\treturn o.join(\"\");\n}\n\n/** Add a relationship entry */\nexport function add_rels(\n\trels: Relationships,\n\trId: number,\n\tf: string,\n\ttype: string,\n\ttargetmode?: string,\n): number {\n\tif (!rels[\"!id\"]) (rels as any)[\"!id\"] = {};\n\tif (!(rels as any)[\"!idx\"]) (rels as any)[\"!idx\"] = 1;\n\tif (rId < 0) {\n\t\tfor (rId = (rels as any)[\"!idx\"]; rels[\"!id\"][\"rId\" + rId]; ++rId) {\n\t\t\t/* find next free rId */\n\t\t}\n\t}\n\t(rels as any)[\"!idx\"] = rId + 1;\n\tconst relobj: RelEntry = {\n\t\tId: \"rId\" + rId,\n\t\tType: type,\n\t\tTarget: f,\n\t};\n\tif (targetmode) relobj.TargetMode = targetmode;\n\telse if ([RELS.HLINK].indexOf(type) > -1) relobj.TargetMode = \"External\";\n\tif (rels[\"!id\"][relobj.Id]) throw new Error(\"Cannot rewrite rId \" + rId);\n\trels[\"!id\"][relobj.Id] = relobj;\n\t(rels as any)[(\"/\" + relobj.Target).replace(\"//\", \"/\")] = relobj;\n\treturn rId;\n}\n","import type { FullProperties } from \"../types.js\";\nimport { XML_HEADER } from \"../xml/parser.js\";\nimport { unescapexml, escapexml } from \"../xml/escape.js\";\nimport { writetag, writextag, write_w3cdtf } from \"../xml/writer.js\";\nimport { XMLNS } from \"../xml/namespaces.js\";\n\nconst CORE_PROPS: [string, string, string?][] = [\n\t[\"cp:category\", \"Category\"],\n\t[\"cp:contentStatus\", \"ContentStatus\"],\n\t[\"cp:keywords\", \"Keywords\"],\n\t[\"cp:lastModifiedBy\", \"LastAuthor\"],\n\t[\"cp:lastPrinted\", \"LastPrinted\"],\n\t[\"cp:revision\", \"Revision\"],\n\t[\"cp:version\", \"Version\"],\n\t[\"dc:creator\", \"Author\"],\n\t[\"dc:description\", \"Comments\"],\n\t[\"dc:identifier\", \"Identifier\"],\n\t[\"dc:language\", \"Language\"],\n\t[\"dc:subject\", \"Subject\"],\n\t[\"dc:title\", \"Title\"],\n\t[\"dcterms:created\", \"CreatedDate\", \"date\"],\n\t[\"dcterms:modified\", \"ModifiedDate\", \"date\"],\n];\n\n/** Simple XML tag content extraction */\nfunction xml_extract(data: string, tag: string): string | null {\n\tconst open = \"<\" + tag;\n\tconst close = \"</\" + tag + \">\";\n\tlet si = data.indexOf(open);\n\tif (si === -1) {\n\t\t// Try with namespace prefix removed for tags like \"dc:creator\"\n\t\treturn null;\n\t}\n\tconst gt = data.indexOf(\">\", si);\n\tif (gt === -1) return null;\n\tconst ei = data.indexOf(close, gt);\n\tif (ei === -1) return null;\n\treturn data.slice(gt + 1, ei);\n}\n\nexport function parse_core_props(data: string): Partial<FullProperties> {\n\tconst p: Record<string, any> = {};\n\n\tfor (const f of CORE_PROPS) {\n\t\tconst content = xml_extract(data, f[0]);\n\t\tif (content != null && content.length > 0) {\n\t\t\tp[f[1]] = unescapexml(content);\n\t\t}\n\t\tif (f[2] === \"date\" && p[f[1]]) {\n\t\t\tp[f[1]] = new Date(p[f[1]]);\n\t\t}\n\t}\n\n\treturn p as Partial<FullProperties>;\n}\n\nfunction cp_doit(\n\tf: string,\n\tg: string | null | undefined,\n\th: Record<string, string> | null,\n\to: string[],\n\tp: Record<string, any>,\n): void {\n\tif (p[f] != null || g == null || g === \"\") return;\n\tp[f] = g;\n\tg = escapexml(g);\n\to.push(h ? writextag(f, g, h) : writetag(f, g));\n}\n\nexport function write_core_props(cp: Partial<FullProperties> | undefined, opts?: { WTF?: boolean; Props?: Record<string, any> }): string {\n\tconst o: string[] = [\n\t\tXML_HEADER,\n\t\twritextag(\"cp:coreProperties\", null, {\n\t\t\t\"xmlns:cp\": XMLNS.CORE_PROPS,\n\t\t\t\"xmlns:dc\": XMLNS.dc,\n\t\t\t\"xmlns:dcterms\": XMLNS.dcterms,\n\t\t\t\"xmlns:dcmitype\": XMLNS.dcmitype,\n\t\t\t\"xmlns:xsi\": XMLNS.xsi,\n\t\t}),\n\t];\n\tconst p: Record<string, any> = {};\n\tif (!cp && !opts?.Props) return o.join(\"\");\n\n\tif (cp) {\n\t\tif (cp.CreatedDate != null) {\n\t\t\tcp_doit(\n\t\t\t\t\"dcterms:created\",\n\t\t\t\ttypeof cp.CreatedDate === \"string\" ? cp.CreatedDate : write_w3cdtf(cp.CreatedDate, opts?.WTF),\n\t\t\t\t{ \"xsi:type\": \"dcterms:W3CDTF\" },\n\t\t\t\to,\n\t\t\t\tp,\n\t\t\t);\n\t\t}\n\t\tif (cp.ModifiedDate != null) {\n\t\t\tcp_doit(\n\t\t\t\t\"dcterms:modified\",\n\t\t\t\ttypeof cp.ModifiedDate === \"string\" ? cp.ModifiedDate : write_w3cdtf(cp.ModifiedDate, opts?.WTF),\n\t\t\t\t{ \"xsi:type\": \"dcterms:W3CDTF\" },\n\t\t\t\to,\n\t\t\t\tp,\n\t\t\t);\n\t\t}\n\t}\n\n\tfor (const f of CORE_PROPS) {\n\t\tlet v: any = opts?.Props?.[f[1]] != null ? opts.Props[f[1]] : cp ? (cp as any)[f[1]] : null;\n\t\tif (v === true) v = \"1\";\n\t\telse if (v === false) v = \"0\";\n\t\telse if (typeof v === \"number\") v = String(v);\n\t\tif (v != null) cp_doit(f[0], v, null, o, p);\n\t}\n\tif (o.length > 2) {\n\t\to.push(\"</cp:coreProperties>\");\n\t\to[1] = o[1].replace(\"/>\", \">\");\n\t}\n\treturn o.join(\"\");\n}\n","import type { FullProperties } from \"../types.js\";\nimport { XML_HEADER } from \"../xml/parser.js\";\nimport { unescapexml, escapexml } from \"../xml/escape.js\";\nimport { writextag } from \"../xml/writer.js\";\nimport { XMLNS } from \"../xml/namespaces.js\";\n\nconst EXT_PROPS: [string, string, string][] = [\n\t[\"Application\", \"Application\", \"string\"],\n\t[\"AppVersion\", \"AppVersion\", \"string\"],\n\t[\"Company\", \"Company\", \"string\"],\n\t[\"DocSecurity\", \"DocSecurity\", \"string\"],\n\t[\"Manager\", \"Manager\", \"string\"],\n\t[\"HyperlinksChanged\", \"HyperlinksChanged\", \"bool\"],\n\t[\"SharedDoc\", \"SharedDoc\", \"bool\"],\n\t[\"LinksUpToDate\", \"LinksUpToDate\", \"bool\"],\n\t[\"ScaleCrop\", \"ScaleCrop\", \"bool\"],\n];\n\n/** Simple namespace-aware XML tag content extraction */\nfunction xml_extract_ns(data: string, tag: string): string | null {\n\t// Match <tag>...</tag> or <ns:tag>...</ns:tag>\n\tconst re = new RegExp(\"<(?:\\\\w+:)?\" + tag + \"[\\\\s>]([\\\\s\\\\S]*?)<\\\\/(?:\\\\w+:)?\" + tag + \">\");\n\tconst m = data.match(re);\n\treturn m ? m[1] : null;\n}\n\nexport function parse_ext_props(data: string, p?: Partial<FullProperties>): Partial<FullProperties> {\n\tif (!p) p = {};\n\n\tfor (const f of EXT_PROPS) {\n\t\tconst xml = xml_extract_ns(data, f[0]);\n\t\tswitch (f[2]) {\n\t\t\tcase \"string\":\n\t\t\t\tif (xml) (p as any)[f[1]] = unescapexml(xml);\n\t\t\t\tbreak;\n\t\t\tcase \"bool\":\n\t\t\t\t(p as any)[f[1]] = xml === \"true\";\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t// Parse HeadingPairs and TitlesOfParts for sheet names\n\tconst hpMatch = data.match(/<HeadingPairs>([\\s\\S]*?)<\\/HeadingPairs>/);\n\tconst topMatch = data.match(/<TitlesOfParts>([\\s\\S]*?)<\\/TitlesOfParts>/);\n\tif (hpMatch && topMatch) {\n\t\tconst lpstrs = topMatch[1].match(/<vt:lpstr>([\\s\\S]*?)<\\/vt:lpstr>/g);\n\t\tif (lpstrs) {\n\t\t\tconst parts = lpstrs.map((s) => {\n\t\t\t\tconst m = s.match(/<vt:lpstr>([\\s\\S]*?)<\\/vt:lpstr>/);\n\t\t\t\treturn m ? unescapexml(m[1]) : \"\";\n\t\t\t});\n\t\t\t// Try to extract Worksheets count from HeadingPairs\n\t\t\tconst i4match = hpMatch[1].match(/<vt:i4>(\\d+)<\\/vt:i4>/);\n\t\t\tif (i4match) {\n\t\t\t\t(p as any).Worksheets = parseInt(i4match[1], 10);\n\t\t\t\t(p as any).SheetNames = parts.slice(0, (p as any).Worksheets);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn p;\n}\n\nexport function write_ext_props(cp: Record<string, any> | undefined): string {\n\tconst o: string[] = [];\n\tconst W = writextag;\n\tif (!cp) cp = {};\n\tcp.Application = \"xlsx-format\";\n\n\to.push(XML_HEADER);\n\to.push(\n\t\twritextag(\"Properties\", null, {\n\t\t\txmlns: XMLNS.EXT_PROPS,\n\t\t\t\"xmlns:vt\": XMLNS.vt,\n\t\t}),\n\t);\n\n\tfor (const f of EXT_PROPS) {\n\t\tif (cp[f[1]] === undefined) continue;\n\t\tlet v: string | undefined;\n\t\tswitch (f[2]) {\n\t\t\tcase \"string\":\n\t\t\t\tv = escapexml(String(cp[f[1]]));\n\t\t\t\tbreak;\n\t\t\tcase \"bool\":\n\t\t\t\tv = cp[f[1]] ? \"true\" : \"false\";\n\t\t\t\tbreak;\n\t\t}\n\t\tif (v !== undefined) o.push(W(f[0], v));\n\t}\n\n\to.push(\n\t\tW(\n\t\t\t\"HeadingPairs\",\n\t\t\tW(\n\t\t\t\t\"vt:vector\",\n\t\t\t\tW(\"vt:variant\", \"<vt:lpstr>Worksheets</vt:lpstr>\") +\n\t\t\t\t\tW(\"vt:variant\", W(\"vt:i4\", String(cp.Worksheets))),\n\t\t\t\t{ size: \"2\", baseType: \"variant\" },\n\t\t\t),\n\t\t),\n\t);\n\n\to.push(\n\t\tW(\n\t\t\t\"TitlesOfParts\",\n\t\t\tW(\n\t\t\t\t\"vt:vector\",\n\t\t\t\t(cp.SheetNames as string[])\n\t\t\t\t\t.map((s: string) => \"<vt:lpstr>\" + escapexml(s) + \"</vt:lpstr>\")\n\t\t\t\t\t.join(\"\"),\n\t\t\t\t{ size: String(cp.Worksheets), baseType: \"lpstr\" },\n\t\t\t),\n\t\t),\n\t);\n\n\tif (o.length > 2) {\n\t\to.push(\"</Properties>\");\n\t\to[1] = o[1].replace(\"/>\", \">\");\n\t}\n\treturn o.join(\"\");\n}\n","import { XML_HEADER, parsexmltag } from \"../xml/parser.js\";\nimport { unescapexml, escapexml } from \"../xml/escape.js\";\nimport { parsexmlbool, strip_ns } from \"../xml/parser.js\";\nimport { writextag, write_vt } from \"../xml/writer.js\";\nimport { XMLNS } from \"../xml/namespaces.js\";\n\nconst custregex = /<[^<>]+>[^<]*/g;\n\nexport function parse_cust_props(data: string, opts?: { WTF?: boolean }): Record<string, any> {\n\tconst p: Record<string, any> = {};\n\tlet name = \"\";\n\tconst m = data.match(custregex);\n\tif (m) {\n\t\tfor (let i = 0; i < m.length; ++i) {\n\t\t\tconst x = m[i];\n\t\t\tconst y = parsexmltag(x);\n\t\t\tswitch (strip_ns(y[0])) {\n\t\t\t\tcase \"<?xml\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"<Properties\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"<property\":\n\t\t\t\t\tname = unescapexml(y.name);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"</property>\":\n\t\t\t\t\tname = \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tif (x.indexOf(\"<vt:\") === 0) {\n\t\t\t\t\t\tconst toks = x.split(\">\");\n\t\t\t\t\t\tconst type = toks[0].slice(4);\n\t\t\t\t\t\tconst text = toks[1];\n\t\t\t\t\t\tswitch (type) {\n\t\t\t\t\t\t\tcase \"lpstr\":\n\t\t\t\t\t\t\tcase \"bstr\":\n\t\t\t\t\t\t\tcase \"lpwstr\":\n\t\t\t\t\t\t\t\tp[name] = unescapexml(text);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"bool\":\n\t\t\t\t\t\t\t\tp[name] = parsexmlbool(text);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"i1\":\n\t\t\t\t\t\t\tcase \"i2\":\n\t\t\t\t\t\t\tcase \"i4\":\n\t\t\t\t\t\t\tcase \"i8\":\n\t\t\t\t\t\t\tcase \"int\":\n\t\t\t\t\t\t\tcase \"uint\":\n\t\t\t\t\t\t\t\tp[name] = parseInt(text, 10);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"r4\":\n\t\t\t\t\t\t\tcase \"r8\":\n\t\t\t\t\t\t\tcase \"decimal\":\n\t\t\t\t\t\t\t\tp[name] = parseFloat(text);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"filetime\":\n\t\t\t\t\t\t\tcase \"date\":\n\t\t\t\t\t\t\t\tp[name] = new Date(text);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"cy\":\n\t\t\t\t\t\t\tcase \"error\":\n\t\t\t\t\t\t\t\tp[name] = unescapexml(text);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tif (type.slice(-1) === \"/\") break;\n\t\t\t\t\t\t\t\tif (opts?.WTF && typeof console !== \"undefined\")\n\t\t\t\t\t\t\t\t\tconsole.warn(\"Unexpected\", x, type, toks);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn p;\n}\n\nexport function write_cust_props(cp: Record<string, any> | undefined): string {\n\tconst o: string[] = [\n\t\tXML_HEADER,\n\t\twritextag(\"Properties\", null, {\n\t\t\txmlns: XMLNS.CUST_PROPS,\n\t\t\t\"xmlns:vt\": XMLNS.vt,\n\t\t}),\n\t];\n\tif (!cp) return o.join(\"\");\n\tlet pid = 1;\n\tfor (const k of Object.keys(cp)) {\n\t\t++pid;\n\t\to.push(\n\t\t\twritextag(\"property\", write_vt(cp[k], true), {\n\t\t\t\tfmtid: \"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\",\n\t\t\t\tpid: String(pid),\n\t\t\t\tname: escapexml(k),\n\t\t\t}),\n\t\t);\n\t}\n\tif (o.length > 2) {\n\t\to.push(\"</Properties>\");\n\t\to[1] = o[1].replace(\"/>\", \">\");\n\t}\n\treturn o.join(\"\");\n}\n","const encoder = new TextEncoder();\nconst decoder = new TextDecoder();\n\n/** Create a new zero-filled Uint8Array */\nexport function new_buf(len: number): Uint8Array {\n\treturn new Uint8Array(len);\n}\n\n/** Create a new uninitialized Uint8Array */\nexport function new_unsafe_buf(len: number): Uint8Array {\n\treturn new Uint8Array(len);\n}\n\n/** Convert a binary string to Uint8Array */\nexport function s2a(s: string): Uint8Array {\n\tconst buf = new Uint8Array(s.length);\n\tfor (let i = 0; i < s.length; ++i) buf[i] = s.charCodeAt(i) & 0xff;\n\treturn buf;\n}\n\n/** Convert Uint8Array to binary string */\nexport function a2s(data: Uint8Array | number[]): string {\n\tconst o: string[] = [];\n\tfor (let i = 0; i < data.length; ++i) o[i] = String.fromCharCode(data[i]);\n\treturn o.join(\"\");\n}\n\n/** Concatenate multiple Uint8Arrays */\nexport function bconcat(bufs: Uint8Array[]): Uint8Array {\n\tlet maxlen = 0;\n\tfor (let i = 0; i < bufs.length; ++i) maxlen += bufs[i].length;\n\tconst o = new Uint8Array(maxlen);\n\tlet offset = 0;\n\tfor (let i = 0; i < bufs.length; ++i) {\n\t\to.set(bufs[i], offset);\n\t\toffset += bufs[i].length;\n\t}\n\treturn o;\n}\n\n/** Encode a string as UTF-8 Uint8Array */\nexport function utf8encode(s: string): Uint8Array {\n\treturn encoder.encode(s);\n}\n\n/** Decode UTF-8 Uint8Array to string */\nexport function utf8decode(data: Uint8Array): string {\n\treturn decoder.decode(data);\n}\n\n/** Read a UTF-8 encoded binary string (charCode-based) into a proper string */\nexport function utf8read(orig: string): string {\n\tlet out = \"\";\n\tlet i = 0;\n\tlet c = 0;\n\tlet d = 0;\n\tlet e = 0;\n\tlet f = 0;\n\tlet w = 0;\n\twhile (i < orig.length) {\n\t\tc = orig.charCodeAt(i++);\n\t\tif (c < 128) {\n\t\t\tout += String.fromCharCode(c);\n\t\t\tcontinue;\n\t\t}\n\t\td = orig.charCodeAt(i++);\n\t\tif (c > 191 && c < 224) {\n\t\t\tf = ((c & 31) << 6) | (d & 63);\n\t\t\tout += String.fromCharCode(f);\n\t\t\tcontinue;\n\t\t}\n\t\te = orig.charCodeAt(i++);\n\t\tif (c < 240) {\n\t\t\tout += String.fromCharCode(((c & 15) << 12) | ((d & 63) << 6) | (e & 63));\n\t\t\tcontinue;\n\t\t}\n\t\tf = orig.charCodeAt(i++);\n\t\tw = (((c & 7) << 18) | ((d & 63) << 12) | ((e & 63) << 6) | (f & 63)) - 65536;\n\t\tout += String.fromCharCode(0xd800 + ((w >>> 10) & 1023));\n\t\tout += String.fromCharCode(0xdc00 + (w & 1023));\n\t}\n\treturn out;\n}\n\n/** Write a string to UTF-8 encoded binary string */\nexport function utf8write(orig: string): string {\n\tconst out: string[] = [];\n\tlet i = 0;\n\tlet c = 0;\n\tlet d = 0;\n\twhile (i < orig.length) {\n\t\tc = orig.charCodeAt(i++);\n\t\tif (c < 128) {\n\t\t\tout.push(String.fromCharCode(c));\n\t\t} else if (c < 2048) {\n\t\t\tout.push(String.fromCharCode(192 + (c >> 6)));\n\t\t\tout.push(String.fromCharCode(128 + (c & 63)));\n\t\t} else if (c >= 55296 && c < 57344) {\n\t\t\tc -= 55296;\n\t\t\td = orig.charCodeAt(i++) - 56320 + (c << 10);\n\t\t\tout.push(String.fromCharCode(240 + ((d >> 18) & 7)));\n\t\t\tout.push(String.fromCharCode(144 + ((d >> 12) & 63)));\n\t\t\tout.push(String.fromCharCode(128 + ((d >> 6) & 63)));\n\t\t\tout.push(String.fromCharCode(128 + (d & 63)));\n\t\t} else {\n\t\t\tout.push(String.fromCharCode(224 + (c >> 12)));\n\t\t\tout.push(String.fromCharCode(128 + ((c >> 6) & 63)));\n\t\t\tout.push(String.fromCharCode(128 + (c & 63)));\n\t\t}\n\t}\n\treturn out.join(\"\");\n}\n\nexport const chr0 = /\\u0000/g;\nexport const chr1 = /[\\u0001-\\u0006]/g;\n","import { parsexmltag, tagregex } from \"../xml/parser.js\";\nimport { unescapexml, escapexml, escapehtml } from \"../xml/escape.js\";\nimport { writextag } from \"../xml/writer.js\";\nimport { XML_HEADER } from \"../xml/parser.js\";\nimport { XMLNS_main } from \"../xml/namespaces.js\";\nimport { utf8read } from \"../utils/buffer.js\";\n\nexport interface XLString {\n\tt: string;\n\tr?: string;\n\th?: string;\n\ts?: any;\n}\n\nexport interface SST extends Array<XLString> {\n\tCount?: number;\n\tUnique?: number;\n}\n\n/** Parse rich-text run properties */\nfunction parse_rpr(rpr: string): Record<string, any> {\n\tconst font: Record<string, any> = {};\n\tconst m = rpr.match(tagregex);\n\tlet pass = false;\n\tif (m) {\n\t\tfor (let i = 0; i < m.length; ++i) {\n\t\t\tconst y = parsexmltag(m[i]);\n\t\t\tswitch ((y[0] as string).replace(/<\\w*:/g, \"<\")) {\n\t\t\t\tcase \"<condense\":\n\t\t\t\tcase \"<extend\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"<shadow\":\n\t\t\t\t\tif (!y.val) break;\n\t\t\t\tcase \"<shadow>\":\n\t\t\t\tcase \"<shadow/>\":\n\t\t\t\t\tfont.shadow = 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"</shadow>\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"<rFont\":\n\t\t\t\t\tfont.name = y.val;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"<sz\":\n\t\t\t\t\tfont.sz = y.val;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"<strike\":\n\t\t\t\t\tif (!y.val) break;\n\t\t\t\tcase \"<strike>\":\n\t\t\t\tcase \"<strike/>\":\n\t\t\t\t\tfont.strike = 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"</strike>\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"<u\":\n\t\t\t\t\tif (!y.val) break;\n\t\t\t\t\tswitch (y.val) {\n\t\t\t\t\t\tcase \"double\":\n\t\t\t\t\t\t\tfont.uval = \"double\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"singleAccounting\":\n\t\t\t\t\t\t\tfont.uval = \"single-accounting\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"doubleAccounting\":\n\t\t\t\t\t\t\tfont.uval = \"double-accounting\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\tcase \"<u>\":\n\t\t\t\tcase \"<u/>\":\n\t\t\t\t\tfont.u = 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"</u>\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"<b\":\n\t\t\t\t\tif (y.val === \"0\") break;\n\t\t\t\tcase \"<b>\":\n\t\t\t\tcase \"<b/>\":\n\t\t\t\t\tfont.b = 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"</b>\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"<i\":\n\t\t\t\t\tif (y.val === \"0\") break;\n\t\t\t\tcase \"<i>\":\n\t\t\t\tcase \"<i/>\":\n\t\t\t\t\tfont.i = 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"</i>\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"<color\":\n\t\t\t\t\tif (y.rgb) font.color = y.rgb.slice(2, 8);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"<color>\":\n\t\t\t\tcase \"<color/>\":\n\t\t\t\tcase \"</color>\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"<family\":\n\t\t\t\t\tfont.family = y.val;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"<vertAlign\":\n\t\t\t\t\tfont.valign = y.val;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"<scheme\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"<extLst\":\n\t\t\t\tcase \"<extLst>\":\n\t\t\t\tcase \"</extLst>\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"<ext\":\n\t\t\t\t\tpass = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"</ext>\":\n\t\t\t\t\tpass = false;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tif ((y[0] as string).charCodeAt(1) !== 47 && !pass)\n\t\t\t\t\t\tthrow new Error(\"Unrecognized rich format \" + y[0]);\n\t\t\t}\n\t\t}\n\t}\n\treturn font;\n}\n\nconst rregex = /<(?:\\w+:)?r>/g;\nconst rend = /<\\/(?:\\w+:)?r>/;\n\nfunction str_match_xml_ns_local(str: string, tag: string): [string, string] | null {\n\tconst re = new RegExp(\"<(?:\\\\w+:)?\" + tag + \"\\\\b[^<>]*>\", \"g\");\n\tconst reEnd = new RegExp(\"<\\\\/(?:\\\\w+:)?\" + tag + \">\", \"g\");\n\tconst m = re.exec(str);\n\tif (!m) return null;\n\tconst si = m.index;\n\tconst sf = re.lastIndex;\n\treEnd.lastIndex = re.lastIndex;\n\tconst m2 = reEnd.exec(str);\n\tif (!m2) return null;\n\tconst ei = m2.index;\n\tconst ef = reEnd.lastIndex;\n\treturn [str.slice(si, ef), str.slice(sf, ei)];\n}\n\nfunction str_remove_xml_ns_g_local(str: string, tag: string): string {\n\tconst re = new RegExp(\"<(?:\\\\w+:)?\" + tag + \"\\\\b[^<>]*>\", \"g\");\n\tconst reEnd = new RegExp(\"<\\\\/(?:\\\\w+:)?\" + tag + \">\", \"g\");\n\tconst out: string[] = [];\n\tlet lastEnd = 0;\n\tlet m;\n\twhile ((m = re.exec(str))) {\n\t\tout.push(str.slice(lastEnd, m.index));\n\t\treEnd.lastIndex = re.lastIndex;\n\t\tconst m2 = reEnd.exec(str);\n\t\tif (!m2) break;\n\t\tlastEnd = reEnd.lastIndex;\n\t\tre.lastIndex = reEnd.lastIndex;\n\t}\n\tout.push(str.slice(lastEnd));\n\treturn out.join(\"\");\n}\n\nfunction parse_r(r: string): { t: string; v: string; s?: any } {\n\tconst t = str_match_xml_ns_local(r, \"t\");\n\tif (!t) return { t: \"s\", v: \"\" };\n\tconst o: any = { t: \"s\", v: unescapexml(t[1]) };\n\tconst rpr = str_match_xml_ns_local(r, \"rPr\");\n\tif (rpr) o.s = parse_rpr(rpr[1]);\n\treturn o;\n}\n\nfunction parse_rs(rs: string): { t: string; v: string; s?: any }[] {\n\treturn rs\n\t\t.replace(rregex, \"\")\n\t\t.split(rend)\n\t\t.map(parse_r)\n\t\t.filter((r) => r.v);\n}\n\nfunction rs_to_html(rs: { t: string; v: string; s?: any }[]): string {\n\tconst nlregex = /(\\r\\n|\\n)/g;\n\treturn rs\n\t\t.map((r) => {\n\t\t\tif (!r.v) return \"\";\n\t\t\tconst intro: string[] = [];\n\t\t\tconst outro: string[] = [];\n\t\t\tif (r.s) {\n\t\t\t\tconst font = r.s;\n\t\t\t\tconst style: string[] = [];\n\t\t\t\tif (font.u) style.push(\"text-decoration: underline;\");\n\t\t\t\tif (font.uval) style.push(\"text-underline-style:\" + font.uval + \";\");\n\t\t\t\tif (font.sz) style.push(\"font-size:\" + font.sz + \"pt;\");\n\t\t\t\tif (font.outline) style.push(\"text-effect: outline;\");\n\t\t\t\tif (font.shadow) style.push(\"text-shadow: auto;\");\n\t\t\t\tintro.push('<span style=\"' + style.join(\"\") + '\">');\n\t\t\t\tif (font.b) {\n\t\t\t\t\tintro.push(\"<b>\");\n\t\t\t\t\toutro.push(\"</b>\");\n\t\t\t\t}\n\t\t\t\tif (font.i) {\n\t\t\t\t\tintro.push(\"<i>\");\n\t\t\t\t\toutro.push(\"</i>\");\n\t\t\t\t}\n\t\t\t\tif (font.strike) {\n\t\t\t\t\tintro.push(\"<s>\");\n\t\t\t\t\toutro.push(\"</s>\");\n\t\t\t\t}\n\t\t\t\tlet align = font.valign || \"\";\n\t\t\t\tif (align === \"superscript\" || align === \"super\") align = \"sup\";\n\t\t\t\telse if (align === \"subscript\") align = \"sub\";\n\t\t\t\tif (align !== \"\") {\n\t\t\t\t\tintro.push(\"<\" + align + \">\");\n\t\t\t\t\toutro.push(\"</\" + align + \">\");\n\t\t\t\t}\n\t\t\t\toutro.push(\"</span>\");\n\t\t\t}\n\t\t\treturn intro.join(\"\") + r.v.replace(nlregex, \"<br/>\") + outro.join(\"\");\n\t\t})\n\t\t.join(\"\");\n}\n\nconst sitregex = /<(?:\\w+:)?t\\b[^<>]*>([^<]*)<\\/(?:\\w+:)?t>/g;\nconst sirregex = /<(?:\\w+:)?r\\b[^<>]*>/;\n\nfunction parse_si(x: string, opts?: { cellHTML?: boolean }): XLString {\n\tconst html = opts ? opts.cellHTML !== false : true;\n\tconst z: any = {};\n\tif (!x) return { t: \"\" };\n\n\tif (x.match(/^\\s*<(?:\\w+:)?t[^>]*>/)) {\n\t\tz.t = unescapexml(utf8read(x.slice(x.indexOf(\">\") + 1).split(/<\\/(?:\\w+:)?t>/)[0] || \"\"), true);\n\t\tz.r = utf8read(x);\n\t\tif (html) z.h = escapehtml(z.t);\n\t} else if (x.match(sirregex)) {\n\t\tz.r = utf8read(x);\n\t\tconst stripped = str_remove_xml_ns_g_local(x, \"rPh\");\n\t\tsitregex.lastIndex = 0;\n\t\tconst matches = stripped.match(sitregex) || [];\n\t\tz.t = unescapexml(utf8read(matches.join(\"\").replace(tagregex, \"\")), true);\n\t\tif (html) z.h = rs_to_html(parse_rs(z.r));\n\t}\n\treturn z;\n}\n\nconst sstr1 = /<(?:\\w+:)?(?:si|sstItem)>/g;\nconst sstr2 = /<\\/(?:\\w+:)?(?:si|sstItem)>/;\n\n/** Parse the Shared String Table XML */\nexport function parse_sst_xml(data: string, opts?: { cellHTML?: boolean }): SST {\n\tconst s: SST = [] as any;\n\tif (!data) return s;\n\n\tconst sst = str_match_xml_ns_local(data, \"sst\");\n\tif (sst) {\n\t\tconst ss = sst[1].replace(sstr1, \"\").split(sstr2);\n\t\tfor (let i = 0; i < ss.length; ++i) {\n\t\t\tconst o = parse_si(ss[i].trim(), opts);\n\t\t\tif (o != null) s[s.length] = o;\n\t\t}\n\t\tconst tag = parsexmltag(sst[0].slice(0, sst[0].indexOf(\">\")));\n\t\ts.Count = tag.count;\n\t\ts.Unique = tag.uniquecount;\n\t}\n\treturn s;\n}\n\nconst straywsregex = /^\\s|\\s$|[\\t\\n\\r]/;\n\n/** Write the Shared String Table XML */\nexport function write_sst_xml(sst: SST, opts: { bookSST?: boolean }): string {\n\tif (!opts.bookSST) return \"\";\n\tconst o: string[] = [XML_HEADER];\n\to.push(\n\t\twritextag(\"sst\", null, {\n\t\t\txmlns: XMLNS_main[0],\n\t\t\tcount: String(sst.Count),\n\t\t\tuniqueCount: String(sst.Unique),\n\t\t}),\n\t);\n\tfor (let i = 0; i !== sst.length; ++i) {\n\t\tif (sst[i] == null) continue;\n\t\tconst s = sst[i];\n\t\tlet sitag = \"<si>\";\n\t\tif (s.r) sitag += s.r;\n\t\telse {\n\t\t\tsitag += \"<t\";\n\t\t\tif (!s.t) s.t = \"\";\n\t\t\tif (typeof s.t !== \"string\") s.t = String(s.t);\n\t\t\tif (s.t.match(straywsregex)) sitag += ' xml:space=\"preserve\"';\n\t\t\tsitag += \">\" + escapexml(s.t) + \"</t>\";\n\t\t}\n\t\tsitag += \"</si>\";\n\t\to.push(sitag);\n\t}\n\tif (o.length > 2) {\n\t\to.push(\"</sst>\");\n\t\to[1] = o[1].replace(\"/>\", \">\");\n\t}\n\treturn o.join(\"\");\n}\n","/** Built-in Excel number format table */\nexport function SSF_init_table(t?: Record<number, string>): Record<number, string> {\n\tif (!t) t = {};\n\tt[0] = \"General\";\n\tt[1] = \"0\";\n\tt[2] = \"0.00\";\n\tt[3] = \"#,##0\";\n\tt[4] = \"#,##0.00\";\n\tt[9] = \"0%\";\n\tt[10] = \"0.00%\";\n\tt[11] = \"0.00E+00\";\n\tt[12] = \"# ?/?\";\n\tt[13] = \"# ??/??\";\n\tt[14] = \"m/d/yy\";\n\tt[15] = \"d-mmm-yy\";\n\tt[16] = \"d-mmm\";\n\tt[17] = \"mmm-yy\";\n\tt[18] = \"h:mm AM/PM\";\n\tt[19] = \"h:mm:ss AM/PM\";\n\tt[20] = \"h:mm\";\n\tt[21] = \"h:mm:ss\";\n\tt[22] = \"m/d/yy h:mm\";\n\tt[37] = \"#,##0 ;(#,##0)\";\n\tt[38] = \"#,##0 ;[Red](#,##0)\";\n\tt[39] = \"#,##0.00;(#,##0.00)\";\n\tt[40] = \"#,##0.00;[Red](#,##0.00)\";\n\tt[45] = \"mm:ss\";\n\tt[46] = \"[h]:mm:ss\";\n\tt[47] = \"mmss.0\";\n\tt[48] = \"##0.0E+0\";\n\tt[49] = \"@\";\n\tt[56] = '\"/ \"hh\"\"mm\"\"ss\" \"';\n\treturn t;\n}\n\n/** Default number format table */\nexport let table_fmt: Record<number, string> = SSF_init_table();\n\n/** Defaults determined by systematically testing in Excel 2019 */\nexport const SSF_default_map: Record<number, number> = {\n\t5: 37, 6: 38, 7: 39, 8: 40,\n\t23: 0, 24: 0, 25: 0, 26: 0,\n\t27: 14, 28: 14, 29: 14, 30: 14, 31: 14,\n\t50: 14, 51: 14, 52: 14, 53: 14, 54: 14,\n\t55: 14, 56: 14, 57: 14, 58: 14,\n\t59: 1, 60: 2, 61: 3, 62: 4,\n\t67: 9, 68: 10,\n\t69: 12, 70: 13, 71: 14,\n\t72: 14, 73: 15, 74: 16, 75: 17,\n\t76: 20, 77: 21, 78: 22,\n\t79: 45, 80: 46, 81: 47,\n\t82: 0,\n};\n\n/** Accounting formats with no equivalent in the base table */\nexport const SSF_default_str: Record<number, string> = {\n\t5: '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n\t63: '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n\t6: '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n\t64: '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n\t7: '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n\t65: '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n\t8: '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n\t66: '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n\t41: '_(* #,##0_);_(* \\\\(#,##0\\\\);_(* \"-\"_);_(@_)',\n\t42: '_(\"$\"* #,##0_);_(\"$\"* \\\\(#,##0\\\\);_(\"$\"* \"-\"_);_(@_)',\n\t43: '_(* #,##0.00_);_(* \\\\(#,##0.00\\\\);_(* \"-\"??_);_(@_)',\n\t44: '_(\"$\"* #,##0.00_);_(\"$\"* \\\\(#,##0.00\\\\);_(\"$\"* \"-\"??_);_(@_)',\n};\n\nexport function SSF_load(fmt: string, idx?: number): number {\n\tif (typeof idx !== \"number\") {\n\t\tidx = +idx! || -1;\n\t\tfor (let i = 0; i < 0x0188; ++i) {\n\t\t\tif (table_fmt[i] === undefined) {\n\t\t\t\tif (idx < 0) idx = i;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (table_fmt[i] === fmt) {\n\t\t\t\tidx = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (idx < 0) idx = 0x187;\n\t}\n\ttable_fmt[idx] = fmt;\n\treturn idx;\n}\n\nexport function SSF_load_table(tbl: Record<number, string>): void {\n\tfor (let i = 0; i < 0x0188; ++i) if (tbl[i] !== undefined) SSF_load(tbl[i], i);\n}\n\nexport function make_ssf(): void {\n\ttable_fmt = SSF_init_table();\n}\n","import { parsexmltag, tagregex, XML_HEADER } from \"../xml/parser.js\";\nimport { unescapexml, escapexml } from \"../xml/escape.js\";\nimport { writextag } from \"../xml/writer.js\";\nimport { XMLNS_main } from \"../xml/namespaces.js\";\nimport { SSF_load } from \"../ssf/table.js\";\n\nexport interface StylesData {\n\tNumberFmt: Record<number, string>;\n\tCellXf: CellXfEntry[];\n\tFonts: any[];\n\tFills: any[];\n\tBorders: any[];\n}\n\nexport interface CellXfEntry {\n\tnumFmtId: number;\n\tfontId?: number;\n\tfillId?: number;\n\tborderId?: number;\n\txfId?: number;\n\tapplyNumberFormat?: boolean;\n\tapplyFont?: boolean;\n\tapplyFill?: boolean;\n\tapplyBorder?: boolean;\n\tapplyAlignment?: boolean;\n}\n\nfunction parse_numFmts(t: string, styles: StylesData, opts: any): void {\n\tconst m = t.match(tagregex);\n\tif (!m) return;\n\tfor (let i = 0; i < m.length; ++i) {\n\t\tconst y = parsexmltag(m[i]);\n\t\tswitch (strip_tag(y[0])) {\n\t\t\tcase \"<numFmt\": {\n\t\t\t\tconst f = unescapexml(y.formatCode);\n\t\t\t\tconst j = parseInt(y.numFmtId, 10);\n\t\t\t\tstyles.NumberFmt[j] = f;\n\t\t\t\tif (j > 0) {\n\t\t\t\t\tif (j > 0x188) {\n\t\t\t\t\t\t// high-numbered format\n\t\t\t\t\t}\n\t\t\t\t\tSSF_load(f, j);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction parse_cellXfs(t: string, styles: StylesData): void {\n\tconst m = t.match(tagregex);\n\tif (!m) return;\n\tlet xf: CellXfEntry | null = null;\n\tfor (let i = 0; i < m.length; ++i) {\n\t\tconst y = parsexmltag(m[i]);\n\t\tswitch (strip_tag(y[0])) {\n\t\t\tcase \"<xf\":\n\t\t\t\txf = {\n\t\t\t\t\tnumFmtId: parseInt(y.numFmtId, 10) || 0,\n\t\t\t\t\tfontId: parseInt(y.fontId, 10) || 0,\n\t\t\t\t\tfillId: parseInt(y.fillId, 10) || 0,\n\t\t\t\t\tborderId: parseInt(y.borderId, 10) || 0,\n\t\t\t\t\txfId: parseInt(y.xfId, 10) || 0,\n\t\t\t\t};\n\t\t\t\tif (y.applyNumberFormat) xf.applyNumberFormat = y.applyNumberFormat === \"1\";\n\t\t\t\tstyles.CellXf.push(xf);\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n\nfunction strip_tag(tag: string): string {\n\treturn tag.replace(/<\\w+:/, \"<\");\n}\n\n/** Parse a styles XML file */\nexport function parse_sty_xml(data: string, _themes?: any, opts?: any): StylesData {\n\tconst styles: StylesData = {\n\t\tNumberFmt: {},\n\t\tCellXf: [],\n\t\tFonts: [],\n\t\tFills: [],\n\t\tBorders: [],\n\t};\n\n\tif (!data) return styles;\n\n\t/* numFmts */\n\tconst numFmts = data.match(/<(?:\\w+:)?numFmts[^>]*>([\\s\\S]*?)<\\/(?:\\w+:)?numFmts>/);\n\tif (numFmts) parse_numFmts(numFmts[1], styles, opts);\n\n\t/* cellXfs */\n\tconst cellXfs = data.match(/<(?:\\w+:)?cellXfs[^>]*>([\\s\\S]*?)<\\/(?:\\w+:)?cellXfs>/);\n\tif (cellXfs) parse_cellXfs(cellXfs[1], styles);\n\n\treturn styles;\n}\n\n/** Write a minimal styles XML */\nexport function write_sty_xml(_wb: any, _opts: any): string {\n\tconst o: string[] = [XML_HEADER];\n\to.push(\n\t\twritextag(\"styleSheet\", null, {\n\t\t\txmlns: XMLNS_main[0],\n\t\t\t\"xmlns:vt\": \"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\",\n\t\t}),\n\t);\n\n\t// Number Formats\n\to.push('<numFmts count=\"1\"><numFmt numFmtId=\"164\" formatCode=\"General\"/></numFmts>');\n\n\t// Fonts\n\to.push(\n\t\t'<fonts count=\"1\"><font><sz val=\"11\"/><color theme=\"1\"/><name val=\"Calibri\"/><family val=\"2\"/><scheme val=\"minor\"/></font></fonts>',\n\t);\n\n\t// Fills\n\to.push(\n\t\t'<fills count=\"2\"><fill><patternFill patternType=\"none\"/></fill><fill><patternFill patternType=\"gray125\"/></fill></fills>',\n\t);\n\n\t// Borders\n\to.push(\n\t\t'<borders count=\"1\"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',\n\t);\n\n\t// Cell Style Xfs\n\to.push(\n\t\t'<cellStyleXfs count=\"1\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\"/></cellStyleXfs>',\n\t);\n\n\t// Cell Xfs\n\to.push(\n\t\t'<cellXfs count=\"2\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" xfId=\"0\"/><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" xfId=\"0\"/></cellXfs>',\n\t);\n\n\t// Cell Styles\n\to.push(\n\t\t'<cellStyles count=\"1\"><cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\"/></cellStyles>',\n\t);\n\n\to.push(\"</styleSheet>\");\n\to[1] = o[1].replace(\"/>\", \">\");\n\treturn o.join(\"\");\n}\n","/** Parse a theme XML file, extracting color scheme */\nexport function parse_theme_xml(data: string): ThemeData {\n\tconst theme: ThemeData = { themeElements: { clrScheme: [] } };\n\n\t// Extract color scheme colors\n\tconst colors: string[] = [];\n\tconst clrMatch = data.match(/<a:clrScheme[^>]*>([\\s\\S]*?)<\\/a:clrScheme>/);\n\tif (clrMatch) {\n\t\tconst valRegex = /<a:(?:sysClr|srgbClr)[^>]*(?:val|lastClr)=\"([0-9A-Fa-f]{6})\"/g;\n\t\tlet m: RegExpExecArray | null;\n\t\twhile ((m = valRegex.exec(clrMatch[1]))) {\n\t\t\tcolors.push(m[1]);\n\t\t}\n\t}\n\ttheme.themeElements.clrScheme = colors;\n\n\treturn theme;\n}\n\nexport interface ThemeData {\n\tthemeElements: {\n\t\tclrScheme: string[];\n\t};\n}\n\n/** Default XLSX theme XML */\nexport function write_theme_xml(): string {\n\t// Minimal theme - based on Office default\n\treturn `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\">\n<a:themeElements>\n<a:clrScheme name=\"Office\">\n<a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1>\n<a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1>\n<a:dk2><a:srgbClr val=\"44546A\"/></a:dk2>\n<a:lt2><a:srgbClr val=\"E7E6E6\"/></a:lt2>\n<a:accent1><a:srgbClr val=\"4472C4\"/></a:accent1>\n<a:accent2><a:srgbClr val=\"ED7D31\"/></a:accent2>\n<a:accent3><a:srgbClr val=\"A5A5A5\"/></a:accent3>\n<a:accent4><a:srgbClr val=\"FFC000\"/></a:accent4>\n<a:accent5><a:srgbClr val=\"5B9BD5\"/></a:accent5>\n<a:accent6><a:srgbClr val=\"70AD47\"/></a:accent6>\n<a:hlink><a:srgbClr val=\"0563C1\"/></a:hlink>\n<a:folHlink><a:srgbClr val=\"954F72\"/></a:folHlink>\n</a:clrScheme>\n<a:fontScheme name=\"Office\">\n<a:majorFont><a:latin typeface=\"Calibri Light\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/></a:majorFont>\n<a:minorFont><a:latin typeface=\"Calibri\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/></a:minorFont>\n</a:fontScheme>\n<a:fmtScheme name=\"Office\">\n<a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill></a:fillStyleLst>\n<a:lnStyleLst><a:ln w=\"6350\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill></a:ln><a:ln w=\"6350\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill></a:ln><a:ln w=\"6350\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill></a:ln></a:lnStyleLst>\n<a:effectStyleLst><a:effectStyle><a:effectLst/></a:effectStyle><a:effectStyle><a:effectLst/></a:effectStyle><a:effectStyle><a:effectLst/></a:effectStyle></a:effectStyleLst>\n<a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill></a:bgFillStyleLst>\n</a:fmtScheme>\n</a:themeElements>\n</a:theme>`;\n}\n","import { parsexmltag, tagregex, XML_HEADER, strip_ns, parsexmlbool } from \"../xml/parser.js\";\nimport { unescapexml, escapexml } from \"../xml/escape.js\";\nimport { writextag } from \"../xml/writer.js\";\nimport { XMLNS_main, XMLNS } from \"../xml/namespaces.js\";\nimport { utf8read } from \"../utils/buffer.js\";\nimport type { WorkBook } from \"../types.js\";\n\nexport interface WorkbookFile {\n\tAppVersion: Record<string, any>;\n\tWBProps: Record<string, any>;\n\tWBView: Record<string, any>[];\n\tSheets: SheetEntry[];\n\tCalcPr: Record<string, any>;\n\tNames: DefinedNameEntry[];\n\txmlns: string;\n}\n\nexport interface SheetEntry {\n\tname: string;\n\tsheetId: string;\n\tHidden?: number;\n\t[key: string]: any;\n}\n\nexport interface DefinedNameEntry {\n\tName: string;\n\tRef?: string;\n\tSheet?: number;\n\tComment?: string;\n\tHidden?: boolean;\n}\n\nconst WBPropsDef: [string, any, string?][] = [\n\t[\"allowRefreshQuery\", false, \"bool\"],\n\t[\"autoCompressPictures\", true, \"bool\"],\n\t[\"backupFile\", false, \"bool\"],\n\t[\"checkCompatibility\", false, \"bool\"],\n\t[\"CodeName\", \"\"],\n\t[\"date1904\", false, \"bool\"],\n\t[\"defaultThemeVersion\", 0, \"int\"],\n\t[\"filterPrivacy\", false, \"bool\"],\n\t[\"hidePivotFieldList\", false, \"bool\"],\n\t[\"promptedSolutions\", false, \"bool\"],\n\t[\"publishItems\", false, \"bool\"],\n\t[\"refreshAllConnections\", false, \"bool\"],\n\t[\"saveExternalLinkValues\", true, \"bool\"],\n\t[\"showBorderUnselectedTables\", true, \"bool\"],\n\t[\"showInkAnnotation\", true, \"bool\"],\n\t[\"showObjects\", \"all\"],\n\t[\"showPivotChartFilter\", false, \"bool\"],\n\t[\"updateLinks\", \"userSet\"],\n];\n\nconst WBViewDef: [string, any, string?][] = [\n\t[\"activeTab\", 0, \"int\"],\n\t[\"autoFilterDateGrouping\", true, \"bool\"],\n\t[\"firstSheet\", 0, \"int\"],\n\t[\"minimized\", false, \"bool\"],\n\t[\"showHorizontalScroll\", true, \"bool\"],\n\t[\"showSheetTabs\", true, \"bool\"],\n\t[\"showVerticalScroll\", true, \"bool\"],\n\t[\"tabRatio\", 600, \"int\"],\n\t[\"visibility\", \"visible\"],\n];\n\nconst SheetDef: [string, any, string?][] = [];\n\nconst CalcPrDef: [string, any, string?][] = [\n\t[\"calcCompleted\", \"true\"],\n\t[\"calcMode\", \"auto\"],\n\t[\"calcOnSave\", \"true\"],\n\t[\"concurrentCalc\", \"true\"],\n\t[\"fullCalcOnLoad\", \"false\"],\n\t[\"fullPrecision\", \"true\"],\n\t[\"iterate\", \"false\"],\n\t[\"iterateCount\", \"100\"],\n\t[\"iterateDelta\", \"0.001\"],\n\t[\"refMode\", \"A1\"],\n];\n\nfunction push_defaults_array(target: any[], defaults: [string, any, string?][]): void {\n\tfor (let j = 0; j < target.length; ++j) {\n\t\tconst w = target[j];\n\t\tfor (let i = 0; i < defaults.length; ++i) {\n\t\t\tconst z = defaults[i];\n\t\t\tif (w[z[0]] == null) w[z[0]] = z[1];\n\t\t\telse\n\t\t\t\tswitch (z[2]) {\n\t\t\t\t\tcase \"bool\":\n\t\t\t\t\t\tif (typeof w[z[0]] === \"string\") w[z[0]] = parsexmlbool(w[z[0]]);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"int\":\n\t\t\t\t\t\tif (typeof w[z[0]] === \"string\") w[z[0]] = parseInt(w[z[0]], 10);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t}\n\t}\n}\n\nfunction push_defaults(target: Record<string, any>, defaults: [string, any, string?][]): void {\n\tfor (let i = 0; i < defaults.length; ++i) {\n\t\tconst z = defaults[i];\n\t\tif (target[z[0]] == null) target[z[0]] = z[1];\n\t\telse\n\t\t\tswitch (z[2]) {\n\t\t\t\tcase \"bool\":\n\t\t\t\t\tif (typeof target[z[0]] === \"string\") target[z[0]] = parsexmlbool(target[z[0]]);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"int\":\n\t\t\t\t\tif (typeof target[z[0]] === \"string\") target[z[0]] = parseInt(target[z[0]], 10);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t}\n}\n\nexport function parse_wb_defaults(wb: WorkbookFile): void {\n\tpush_defaults(wb.WBProps, WBPropsDef);\n\tpush_defaults(wb.CalcPr, CalcPrDef);\n\tpush_defaults_array(wb.WBView, WBViewDef);\n\tpush_defaults_array(wb.Sheets, SheetDef);\n}\n\nexport function safe1904(wb: WorkBook): string {\n\tif (!wb.Workbook) return \"false\";\n\tif (!wb.Workbook.WBProps) return \"false\";\n\treturn parsexmlbool(wb.Workbook.WBProps.date1904) ? \"true\" : \"false\";\n}\n\nconst badchars = \":][*?/\\\\\".split(\"\");\n\nexport function check_ws_name(n: string, safe?: boolean): boolean {\n\ttry {\n\t\tif (n === \"\") throw new Error(\"Sheet name cannot be blank\");\n\t\tif (n.length > 31) throw new Error(\"Sheet name cannot exceed 31 chars\");\n\t\tif (n.charCodeAt(0) === 0x27 || n.charCodeAt(n.length - 1) === 0x27)\n\t\t\tthrow new Error(\"Sheet name cannot start or end with apostrophe (')\");\n\t\tif (n.toLowerCase() === \"history\") throw new Error(\"Sheet name cannot be 'History'\");\n\t\tfor (const c of badchars) {\n\t\t\tif (n.indexOf(c) !== -1) throw new Error(\"Sheet name cannot contain : \\\\ / ? * [ ]\");\n\t\t}\n\t} catch (e) {\n\t\tif (safe) return false;\n\t\tthrow e;\n\t}\n\treturn true;\n}\n\nexport function check_wb_names(N: string[], S?: any[]): void {\n\tfor (let i = 0; i < N.length; ++i) {\n\t\tcheck_ws_name(N[i]);\n\t\tfor (let j = 0; j < i; ++j) {\n\t\t\tif (N[i] === N[j]) throw new Error(\"Duplicate Sheet Name: \" + N[i]);\n\t\t}\n\t}\n}\n\nexport function check_wb(wb: WorkBook): void {\n\tif (!wb || !wb.SheetNames || !wb.Sheets) throw new Error(\"Invalid Workbook\");\n\tif (!wb.SheetNames.length) throw new Error(\"Workbook is empty\");\n\tconst Sheets = (wb.Workbook && wb.Workbook.Sheets) || [];\n\tcheck_wb_names(wb.SheetNames, Sheets);\n}\n\nconst wbnsregex = /<\\w+:workbook/;\n\n/** Parse a workbook XML file */\nexport function parse_wb_xml(data: string, opts?: any): WorkbookFile {\n\tif (!data) throw new Error(\"Could not find file\");\n\tconst wb: WorkbookFile = {\n\t\tAppVersion: {},\n\t\tWBProps: {},\n\t\tWBView: [],\n\t\tSheets: [],\n\t\tCalcPr: {},\n\t\tNames: [],\n\t\txmlns: \"\",\n\t};\n\tlet pass = false;\n\tlet xmlns = \"xmlns\";\n\tlet dname: any = {};\n\tlet dnstart = 0;\n\n\tdata.replace(tagregex, function xml_wb(x: string, idx: number): string {\n\t\tconst y: any = parsexmltag(x);\n\t\tswitch (strip_ns(y[0])) {\n\t\t\tcase \"<?xml\":\n\t\t\t\tbreak;\n\n\t\t\tcase \"<workbook\":\n\t\t\t\tif (x.match(wbnsregex)) xmlns = \"xmlns\" + x.match(/<(\\w+):/)?.[1];\n\t\t\t\twb.xmlns = y[xmlns];\n\t\t\t\tbreak;\n\t\t\tcase \"</workbook>\":\n\t\t\t\tbreak;\n\n\t\t\tcase \"<fileVersion\":\n\t\t\t\tdelete y[0];\n\t\t\t\twb.AppVersion = y;\n\t\t\t\tbreak;\n\t\t\tcase \"<fileVersion/>\":\n\t\t\tcase \"</fileVersion>\":\n\t\t\t\tbreak;\n\n\t\t\tcase \"<fileSharing\":\n\t\t\tcase \"<fileSharing/>\":\n\t\t\t\tbreak;\n\n\t\t\tcase \"<workbookPr\":\n\t\t\tcase \"<workbookPr/>\":\n\t\t\t\tWBPropsDef.forEach((w) => {\n\t\t\t\t\tif (y[w[0]] == null) return;\n\t\t\t\t\tswitch (w[2]) {\n\t\t\t\t\t\tcase \"bool\":\n\t\t\t\t\t\t\twb.WBProps[w[0]] = parsexmlbool(y[w[0]]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"int\":\n\t\t\t\t\t\t\twb.WBProps[w[0]] = parseInt(y[w[0]], 10);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\twb.WBProps[w[0]] = y[w[0]];\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (y.codeName) wb.WBProps.CodeName = utf8read(y.codeName);\n\t\t\t\tbreak;\n\t\t\tcase \"</workbookPr>\":\n\t\t\t\tbreak;\n\n\t\t\tcase \"<workbookProtection\":\n\t\t\tcase \"<workbookProtection/>\":\n\t\t\t\tbreak;\n\n\t\t\tcase \"<bookViews\":\n\t\t\tcase \"<bookViews>\":\n\t\t\tcase \"</bookViews>\":\n\t\t\t\tbreak;\n\t\t\tcase \"<workbookView\":\n\t\t\tcase \"<workbookView/>\":\n\t\t\t\tdelete y[0];\n\t\t\t\twb.WBView.push(y);\n\t\t\t\tbreak;\n\t\t\tcase \"</workbookView>\":\n\t\t\t\tbreak;\n\n\t\t\tcase \"<sheets\":\n\t\t\tcase \"<sheets>\":\n\t\t\tcase \"</sheets>\":\n\t\t\t\tbreak;\n\t\t\tcase \"<sheet\":\n\t\t\t\tswitch (y.state) {\n\t\t\t\t\tcase \"hidden\":\n\t\t\t\t\t\ty.Hidden = 1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"veryHidden\":\n\t\t\t\t\t\ty.Hidden = 2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\ty.Hidden = 0;\n\t\t\t\t}\n\t\t\t\tdelete y.state;\n\t\t\t\ty.name = unescapexml(utf8read(y.name));\n\t\t\t\tdelete y[0];\n\t\t\t\twb.Sheets.push(y);\n\t\t\t\tbreak;\n\t\t\tcase \"</sheet>\":\n\t\t\t\tbreak;\n\n\t\t\tcase \"<functionGroups\":\n\t\t\tcase \"<functionGroups/>\":\n\t\t\tcase \"<functionGroup\":\n\t\t\t\tbreak;\n\n\t\t\tcase \"<externalReferences\":\n\t\t\tcase \"</externalReferences>\":\n\t\t\tcase \"<externalReferences>\":\n\t\t\tcase \"<externalReference\":\n\t\t\t\tbreak;\n\n\t\t\tcase \"<definedNames/>\":\n\t\t\t\tbreak;\n\t\t\tcase \"<definedNames>\":\n\t\t\tcase \"<definedNames\":\n\t\t\t\tpass = true;\n\t\t\t\tbreak;\n\t\t\tcase \"</definedNames>\":\n\t\t\t\tpass = false;\n\t\t\t\tbreak;\n\t\t\tcase \"<definedName\": {\n\t\t\t\tdname = {};\n\t\t\t\tdname.Name = utf8read(y.name);\n\t\t\t\tif (y.comment) dname.Comment = y.comment;\n\t\t\t\tif (y.localSheetId) dname.Sheet = +y.localSheetId;\n\t\t\t\tif (parsexmlbool(y.hidden || \"0\")) dname.Hidden = true;\n\t\t\t\tdnstart = idx + x.length;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase \"</definedName>\": {\n\t\t\t\tdname.Ref = unescapexml(utf8read(data.slice(dnstart, idx)));\n\t\t\t\twb.Names.push(dname);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase \"<definedName/>\":\n\t\t\t\tbreak;\n\n\t\t\tcase \"<calcPr\":\n\t\t\tcase \"<calcPr/>\":\n\t\t\t\tdelete y[0];\n\t\t\t\twb.CalcPr = y;\n\t\t\t\tbreak;\n\t\t\tcase \"</calcPr>\":\n\t\t\t\tbreak;\n\n\t\t\tcase \"<oleSize\":\n\t\t\t\tbreak;\n\n\t\t\tcase \"<customWorkbookViews>\":\n\t\t\tcase \"</customWorkbookViews>\":\n\t\t\tcase \"<customWorkbookViews\":\n\t\t\tcase \"<customWorkbookView\":\n\t\t\tcase \"</customWorkbookView>\":\n\t\t\t\tbreak;\n\n\t\t\tcase \"<pivotCaches>\":\n\t\t\tcase \"</pivotCaches>\":\n\t\t\tcase \"<pivotCaches\":\n\t\t\tcase \"<pivotCache\":\n\t\t\t\tbreak;\n\n\t\t\tcase \"<smartTagPr\":\n\t\t\tcase \"<smartTagPr/>\":\n\t\t\t\tbreak;\n\n\t\t\tcase \"<smartTagTypes\":\n\t\t\tcase \"<smartTagTypes>\":\n\t\t\tcase \"</smartTagTypes>\":\n\t\t\tcase \"<smartTagType\":\n\t\t\t\tbreak;\n\n\t\t\tcase \"<webPublishing\":\n\t\t\tcase \"<webPublishing/>\":\n\t\t\t\tbreak;\n\n\t\t\tcase \"<fileRecoveryPr\":\n\t\t\tcase \"<fileRecoveryPr/>\":\n\t\t\t\tbreak;\n\n\t\t\tcase \"<webPublishObjects>\":\n\t\t\tcase \"<webPublishObjects\":\n\t\t\tcase \"</webPublishObjects>\":\n\t\t\tcase \"<webPublishObject\":\n\t\t\t\tbreak;\n\n\t\t\tcase \"<extLst\":\n\t\t\tcase \"<extLst>\":\n\t\t\tcase \"</extLst>\":\n\t\t\tcase \"<extLst/>\":\n\t\t\t\tbreak;\n\t\t\tcase \"<ext\":\n\t\t\t\tpass = true;\n\t\t\t\tbreak;\n\t\t\tcase \"</ext>\":\n\t\t\t\tpass = false;\n\t\t\t\tbreak;\n\n\t\t\tcase \"<ArchID\":\n\t\t\t\tbreak;\n\t\t\tcase \"<AlternateContent\":\n\t\t\tcase \"<AlternateContent>\":\n\t\t\t\tpass = true;\n\t\t\t\tbreak;\n\t\t\tcase \"</AlternateContent>\":\n\t\t\t\tpass = false;\n\t\t\t\tbreak;\n\n\t\t\tcase \"<revisionPtr\":\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\treturn x;\n\t});\n\n\tif (XMLNS_main.indexOf(wb.xmlns) === -1) throw new Error(\"Unknown Namespace: \" + wb.xmlns);\n\n\tparse_wb_defaults(wb);\n\n\treturn wb;\n}\n\n/** Write the workbook XML */\nexport function write_wb_xml(wb: WorkBook): string {\n\tconst o: string[] = [XML_HEADER];\n\to.push(\n\t\twritextag(\"workbook\", null, {\n\t\t\txmlns: XMLNS_main[0],\n\t\t\t\"xmlns:r\": XMLNS.r,\n\t\t}),\n\t);\n\n\tconst write_names = !!(wb.Workbook && (wb.Workbook.Names || []).length > 0);\n\n\tconst workbookPr: any = { codeName: \"ThisWorkbook\" };\n\tif (wb.Workbook && wb.Workbook.WBProps) {\n\t\tWBPropsDef.forEach((x) => {\n\t\t\tif (!wb.Workbook || !wb.Workbook.WBProps) return;\n\t\t\tconst wbp = wb.Workbook.WBProps as any;\n\t\t\tif (wbp[x[0]] == null) return;\n\t\t\tif (wbp[x[0]] === x[1]) return;\n\t\t\tworkbookPr[x[0]] = wbp[x[0]];\n\t\t});\n\t\tif (wb.Workbook.WBProps.CodeName) {\n\t\t\tworkbookPr.codeName = wb.Workbook.WBProps.CodeName;\n\t\t\tdelete workbookPr.CodeName;\n\t\t}\n\t}\n\to.push(writextag(\"workbookPr\", null, workbookPr));\n\n\tconst sheets = (wb.Workbook && wb.Workbook.Sheets) || [];\n\n\t/* bookViews only written if first worksheet is hidden */\n\tif (sheets[0] && !!sheets[0].Hidden) {\n\t\to.push(\"<bookViews>\");\n\t\tlet i = 0;\n\t\tfor (i = 0; i < wb.SheetNames.length; ++i) {\n\t\t\tif (!sheets[i]) break;\n\t\t\tif (!sheets[i].Hidden) break;\n\t\t}\n\t\tif (i === wb.SheetNames.length) i = 0;\n\t\to.push('<workbookView firstSheet=\"' + i + '\" activeTab=\"' + i + '\"/>');\n\t\to.push(\"</bookViews>\");\n\t}\n\n\to.push(\"<sheets>\");\n\tfor (let i = 0; i < wb.SheetNames.length; ++i) {\n\t\tconst sht: any = { name: escapexml(wb.SheetNames[i].slice(0, 31)) };\n\t\tsht.sheetId = \"\" + (i + 1);\n\t\tsht[\"r:id\"] = \"rId\" + (i + 1);\n\t\tif (sheets[i])\n\t\t\tswitch (sheets[i].Hidden) {\n\t\t\t\tcase 1:\n\t\t\t\t\tsht.state = \"hidden\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tsht.state = \"veryHidden\";\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\to.push(writextag(\"sheet\", null, sht));\n\t}\n\to.push(\"</sheets>\");\n\n\tif (write_names) {\n\t\to.push(\"<definedNames>\");\n\t\tif (wb.Workbook && wb.Workbook.Names)\n\t\t\twb.Workbook.Names.forEach((n) => {\n\t\t\t\tconst d: any = { name: n.Name };\n\t\t\t\tif (n.Comment) d.comment = n.Comment;\n\t\t\t\tif (n.Sheet != null) d.localSheetId = \"\" + n.Sheet;\n\t\t\t\tif (n.Hidden) d.hidden = \"1\";\n\t\t\t\tif (!n.Ref) return;\n\t\t\t\to.push(writextag(\"definedName\", escapexml(n.Ref), d));\n\t\t\t});\n\t\to.push(\"</definedNames>\");\n\t}\n\n\tif (o.length > 2) {\n\t\to.push(\"</workbook>\");\n\t\to[1] = o[1].replace(\"/>\", \">\");\n\t}\n\treturn o.join(\"\");\n}\n","import type { CellAddress, Range } from \"../types.js\";\n\nexport function decode_row(rowstr: string): number {\n\treturn parseInt(unfix_row(rowstr), 10) - 1;\n}\n\nexport function encode_row(row: number): string {\n\treturn \"\" + (row + 1);\n}\n\nexport function fix_row(cstr: string): string {\n\treturn cstr.replace(/([A-Z]|^)(\\d+)$/, \"$1$$$2\");\n}\n\nexport function unfix_row(cstr: string): string {\n\treturn cstr.replace(/\\$(\\d+)$/, \"$1\");\n}\n\nexport function decode_col(colstr: string): number {\n\tconst c = unfix_col(colstr);\n\tlet d = 0;\n\tfor (let i = 0; i < c.length; ++i) d = 26 * d + c.charCodeAt(i) - 64;\n\treturn d - 1;\n}\n\nexport function encode_col(col: number): string {\n\tif (col < 0) throw new Error(\"invalid column \" + col);\n\tlet s = \"\";\n\tfor (++col; col; col = Math.floor((col - 1) / 26))\n\t\ts = String.fromCharCode(((col - 1) % 26) + 65) + s;\n\treturn s;\n}\n\nexport function fix_col(cstr: string): string {\n\treturn cstr.replace(/^([A-Z])/, \"$$$1\");\n}\n\nexport function unfix_col(cstr: string): string {\n\treturn cstr.replace(/^\\$([A-Z])/, \"$1\");\n}\n\nexport function split_cell(cstr: string): string[] {\n\treturn cstr.replace(/(\\$?[A-Z]*)(\\$?\\d*)/, \"$1,$2\").split(\",\");\n}\n\nexport function decode_cell(cstr: string): CellAddress {\n\tlet R = 0,\n\t\tC = 0;\n\tfor (let i = 0; i < cstr.length; ++i) {\n\t\tconst cc = cstr.charCodeAt(i);\n\t\tif (cc >= 48 && cc <= 57) R = 10 * R + (cc - 48);\n\t\telse if (cc >= 65 && cc <= 90) C = 26 * C + (cc - 64);\n\t}\n\treturn { c: C - 1, r: R - 1 };\n}\n\nexport function encode_cell(cell: CellAddress): string {\n\tlet col = cell.c + 1;\n\tlet s = \"\";\n\tfor (; col; col = ((col - 1) / 26) | 0)\n\t\ts = String.fromCharCode(((col - 1) % 26) + 65) + s;\n\treturn s + (cell.r + 1);\n}\n\nexport function decode_range(range: string): Range {\n\tconst idx = range.indexOf(\":\");\n\tif (idx === -1) return { s: decode_cell(range), e: decode_cell(range) };\n\treturn { s: decode_cell(range.slice(0, idx)), e: decode_cell(range.slice(idx + 1)) };\n}\n\nexport function encode_range(cs: CellAddress | Range, ce?: CellAddress): string {\n\tif (typeof ce === \"undefined\" || typeof ce === \"number\") {\n\t\treturn encode_range((cs as Range).s, (cs as Range).e);\n\t}\n\tconst s = typeof cs === \"string\" ? cs : encode_cell(cs as CellAddress);\n\tconst e = typeof ce === \"string\" ? ce : encode_cell(ce);\n\treturn s === e ? s : s + \":\" + e;\n}\n\nexport function safe_decode_range(range: string): Range {\n\tconst o = { s: { c: 0, r: 0 }, e: { c: 0, r: 0 } };\n\tlet idx = 0,\n\t\ti = 0,\n\t\tcc = 0;\n\tconst len = range.length;\n\tfor (idx = 0; i < len; ++i) {\n\t\tif ((cc = range.charCodeAt(i) - 64) < 1 || cc > 26) break;\n\t\tidx = 26 * idx + cc;\n\t}\n\to.s.c = --idx;\n\n\tfor (idx = 0; i < len; ++i) {\n\t\tif ((cc = range.charCodeAt(i) - 48) < 0 || cc > 9) break;\n\t\tidx = 10 * idx + cc;\n\t}\n\to.s.r = --idx;\n\n\tif (i === len || cc !== 10) {\n\t\to.e.c = o.s.c;\n\t\to.e.r = o.s.r;\n\t\treturn o;\n\t}\n\t++i;\n\n\tfor (idx = 0; i !== len; ++i) {\n\t\tif ((cc = range.charCodeAt(i) - 64) < 1 || cc > 26) break;\n\t\tidx = 26 * idx + cc;\n\t}\n\to.e.c = --idx;\n\n\tfor (idx = 0; i !== len; ++i) {\n\t\tif ((cc = range.charCodeAt(i) - 48) < 0 || cc > 9) break;\n\t\tidx = 10 * idx + cc;\n\t}\n\to.e.r = --idx;\n\treturn o;\n}\n\nexport function formula_quote_sheet_name(sname: string): string {\n\tif (!sname) throw new Error(\"empty sheet name\");\n\tif (/[^\\w\\u4E00-\\u9FFF\\u3040-\\u30FF]/.test(sname)) return \"'\" + sname.replace(/'/g, \"''\") + \"'\";\n\treturn sname;\n}\n","/** Convert a JS Date to Excel serial date number */\nexport function datenum(v: Date, date1904?: boolean): number {\n\tlet epoch = v.getTime();\n\tif (date1904) epoch -= 1462 * 24 * 60 * 60 * 1000;\n\tconst dnthresh = Date.UTC(1899, 11, 30, 0, 0, 0);\n\tconst result = (epoch - dnthresh) / (24 * 60 * 60 * 1000);\n\t// Excel intentionally considers 1900-02-29 a valid date (Lotus 1-2-3 bug)\n\tif (result < 60) return result;\n\tif (result >= 60) return result + 1;\n\treturn result;\n}\n\n/** Convert an Excel serial date number to a JS Date */\nexport function numdate(v: number, date1904?: boolean): Date {\n\tlet date = v;\n\tif (date1904) date += 1462;\n\t// Excel's Lotus 1-2-3 bug: date 60 is 1900-02-29 which doesn't exist\n\tif (date > 60) --date;\n\tconst dnthresh = Date.UTC(1899, 11, 30, 0, 0, 0);\n\treturn new Date(dnthresh + date * 24 * 60 * 60 * 1000);\n}\n\n/** Convert a local Date to UTC (shift by timezone offset) */\nexport function local_to_utc(d: Date): Date {\n\tconst off = d.getTimezoneOffset();\n\treturn new Date(d.getTime() + off * 60 * 1000);\n}\n\n/** Convert a UTC Date to local (shift by timezone offset) */\nexport function utc_to_local(d: Date): Date {\n\tconst off = d.getTimezoneOffset();\n\treturn new Date(d.getTime() - off * 60 * 1000);\n}\n","/* ssf.js (C) 2013-present SheetJS -- http://sheetjs.com */\n/* Ported to TypeScript for xlsx-format. 1:1 faithful port. */\n\nimport { datenum } from \"../utils/date.js\";\nimport { fill } from \"../utils/helpers.js\";\nimport { table_fmt, SSF_default_map, SSF_default_str } from \"./table.js\";\n\nfunction _strrev(x: string): string {\n\tlet o = \"\";\n\tlet i = x.length - 1;\n\twhile (i >= 0) o += x.charAt(i--);\n\treturn o;\n}\nfunction pad0(v: any, d: number): string {\n\tconst t = \"\" + v;\n\treturn t.length >= d ? t : fill(\"0\", d - t.length) + t;\n}\nfunction pad_(v: any, d: number): string {\n\tconst t = \"\" + v;\n\treturn t.length >= d ? t : fill(\" \", d - t.length) + t;\n}\nfunction rpad_(v: any, d: number): string {\n\tconst t = \"\" + v;\n\treturn t.length >= d ? t : t + fill(\" \", d - t.length);\n}\nfunction pad0r1(v: any, d: number): string {\n\tconst t = \"\" + Math.round(v);\n\treturn t.length >= d ? t : fill(\"0\", d - t.length) + t;\n}\nfunction pad0r2(v: any, d: number): string {\n\tconst t = \"\" + v;\n\treturn t.length >= d ? t : fill(\"0\", d - t.length) + t;\n}\nconst p2_32 = Math.pow(2, 32);\nfunction pad0r(v: any, d: number): string {\n\tif (v > p2_32 || v < -p2_32) return pad0r1(v, d);\n\tconst i = Math.round(v);\n\treturn pad0r2(i, d);\n}\n\nfunction SSF_isgeneral(s: string, i?: number): boolean {\n\ti = i || 0;\n\treturn (\n\t\ts.length >= 7 + i &&\n\t\t(s.charCodeAt(i) | 32) === 103 &&\n\t\t(s.charCodeAt(i + 1) | 32) === 101 &&\n\t\t(s.charCodeAt(i + 2) | 32) === 110 &&\n\t\t(s.charCodeAt(i + 3) | 32) === 101 &&\n\t\t(s.charCodeAt(i + 4) | 32) === 114 &&\n\t\t(s.charCodeAt(i + 5) | 32) === 97 &&\n\t\t(s.charCodeAt(i + 6) | 32) === 108\n\t);\n}\n\nconst days: string[][] = [\n\t[\"Sun\", \"Sunday\"],\n\t[\"Mon\", \"Monday\"],\n\t[\"Tue\", \"Tuesday\"],\n\t[\"Wed\", \"Wednesday\"],\n\t[\"Thu\", \"Thursday\"],\n\t[\"Fri\", \"Friday\"],\n\t[\"Sat\", \"Saturday\"],\n];\nconst months: string[][] = [\n\t[\"J\", \"Jan\", \"January\"],\n\t[\"F\", \"Feb\", \"February\"],\n\t[\"M\", \"Mar\", \"March\"],\n\t[\"A\", \"Apr\", \"April\"],\n\t[\"M\", \"May\", \"May\"],\n\t[\"J\", \"Jun\", \"June\"],\n\t[\"J\", \"Jul\", \"July\"],\n\t[\"A\", \"Aug\", \"August\"],\n\t[\"S\", \"Sep\", \"September\"],\n\t[\"O\", \"Oct\", \"October\"],\n\t[\"N\", \"Nov\", \"November\"],\n\t[\"D\", \"Dec\", \"December\"],\n];\n\ninterface SSFDateVal {\n\tD: number;\n\tT: number;\n\tu: number;\n\ty: number;\n\tm: number;\n\td: number;\n\tH: number;\n\tM: number;\n\tS: number;\n\tq: number;\n}\n\nfunction SSF_normalize_xl_unsafe(v: number): number {\n\tconst s = v.toPrecision(16);\n\tif (s.indexOf(\"e\") > -1) {\n\t\tconst m = s.slice(0, s.indexOf(\"e\"));\n\t\tconst ml =\n\t\t\tm.indexOf(\".\") > -1\n\t\t\t\t? m.slice(0, m.slice(0, 2) === \"0.\" ? 17 : 16)\n\t\t\t\t: m.slice(0, 15) + fill(\"0\", m.length - 15);\n\t\treturn +ml + +(\"1\" + s.slice(s.indexOf(\"e\"))) - 1 || +s;\n\t}\n\tconst n =\n\t\ts.indexOf(\".\") > -1\n\t\t\t? s.slice(0, s.slice(0, 2) === \"0.\" ? 17 : 16)\n\t\t\t: s.slice(0, 15) + fill(\"0\", s.length - 15);\n\treturn Number(n);\n}\n\nfunction SSF_fix_hijri(_date: Date, o: number[]): number {\n\to[0] -= 581;\n\tconst dow = _date.getDay();\n\tif (_date.getTime() < -2203891200000) return (dow + 6) % 7;\n\treturn dow;\n}\n\nexport function SSF_parse_date_code(v: number, opts?: any, b2?: boolean): SSFDateVal | null {\n\tif (v > 2958465 || v < 0) return null;\n\tv = SSF_normalize_xl_unsafe(v);\n\tlet date = v | 0;\n\tlet time = Math.floor(86400 * (v - date));\n\tconst out: SSFDateVal = {\n\t\tD: date,\n\t\tT: time,\n\t\tu: 86400 * (v - date) - time,\n\t\ty: 0,\n\t\tm: 0,\n\t\td: 0,\n\t\tH: 0,\n\t\tM: 0,\n\t\tS: 0,\n\t\tq: 0,\n\t};\n\tif (Math.abs(out.u) < 1e-6) out.u = 0;\n\tif (opts && opts.date1904) date += 1462;\n\tif (out.u > 0.9999) {\n\t\tout.u = 0;\n\t\tif (++time === 86400) {\n\t\t\tout.T = time = 0;\n\t\t\t++date;\n\t\t\t++out.D;\n\t\t}\n\t}\n\tlet dout: number[];\n\tlet dow = 0;\n\tif (date === 60) {\n\t\tdout = b2 ? [1317, 10, 29] : [1900, 2, 29];\n\t\tdow = 3;\n\t} else if (date === 0) {\n\t\tdout = b2 ? [1317, 8, 29] : [1900, 1, 0];\n\t\tdow = 6;\n\t} else {\n\t\tif (date > 60) --date;\n\t\tconst d = new Date(1900, 0, 1);\n\t\td.setDate(d.getDate() + date - 1);\n\t\tdout = [d.getFullYear(), d.getMonth() + 1, d.getDate()];\n\t\tdow = d.getDay();\n\t\tif (date < 60) dow = (dow + 6) % 7;\n\t\tif (b2) dow = SSF_fix_hijri(d, dout);\n\t}\n\tout.y = dout[0];\n\tout.m = dout[1];\n\tout.d = dout[2];\n\tout.S = time % 60;\n\ttime = Math.floor(time / 60);\n\tout.M = time % 60;\n\ttime = Math.floor(time / 60);\n\tout.H = time;\n\tout.q = dow;\n\treturn out;\n}\n\nfunction SSF_strip_decimal(o: string): string {\n\treturn o.indexOf(\".\") === -1 ? o : o.replace(/(?:\\.0*|(\\.\\d*[1-9])0+)$/, \"$1\");\n}\n\nfunction SSF_normalize_exp(o: string): string {\n\tif (o.indexOf(\"E\") === -1) return o;\n\treturn o.replace(/(?:\\.0*|(\\.\\d*[1-9])0+)[Ee]/, \"$1E\").replace(/(E[+-])(\\d)$/, \"$10$2\");\n}\n\nfunction SSF_small_exp(v: number): string {\n\tconst w = v < 0 ? 12 : 11;\n\tlet o = SSF_strip_decimal(v.toFixed(12));\n\tif (o.length <= w) return o;\n\to = v.toPrecision(10);\n\tif (o.length <= w) return o;\n\treturn v.toExponential(5);\n}\n\nfunction SSF_large_exp(v: number): string {\n\tconst o = SSF_strip_decimal(v.toFixed(11));\n\treturn o.length > (v < 0 ? 12 : 11) || o === \"0\" || o === \"-0\" ? v.toPrecision(6) : o;\n}\n\nfunction SSF_general_num(v: number): string {\n\tif (!isFinite(v)) return isNaN(v) ? \"#NUM!\" : \"#DIV/0!\";\n\tconst V = Math.floor(Math.log(Math.abs(v)) * Math.LOG10E);\n\tlet o: string;\n\n\tif (V >= -4 && V <= -1) o = v.toPrecision(10 + V);\n\telse if (Math.abs(V) <= 9) o = SSF_small_exp(v);\n\telse if (V === 10) o = v.toFixed(10).substr(0, 12);\n\telse o = SSF_large_exp(v);\n\n\treturn SSF_strip_decimal(SSF_normalize_exp(o.toUpperCase()));\n}\n\nfunction SSF_general(v: any, opts: any): string {\n\tswitch (typeof v) {\n\t\tcase \"string\":\n\t\t\treturn v;\n\t\tcase \"boolean\":\n\t\t\treturn v ? \"TRUE\" : \"FALSE\";\n\t\tcase \"number\":\n\t\t\treturn (v | 0) === v ? v.toString(10) : SSF_general_num(v);\n\t\tcase \"undefined\":\n\t\t\treturn \"\";\n\t\tcase \"object\":\n\t\t\tif (v == null) return \"\";\n\t\t\tif (v instanceof Date) return SSF_format(14, datenum(v, opts && opts.date1904), opts);\n\t}\n\tthrow new Error(\"unsupported value in General format: \" + v);\n}\n\nfunction SSF_write_date(type: number, fmt: string, val: SSFDateVal, ss0?: number): string {\n\tlet o = \"\";\n\tlet ss = 0;\n\tlet tt = 0;\n\tlet y = val.y;\n\tlet out: number = 0;\n\tlet outl = 0;\n\tswitch (type) {\n\t\tcase 98 /* 'b' buddhist year */:\n\t\t\ty = val.y + 543;\n\t\t/* falls through */\n\t\tcase 121 /* 'y' year */:\n\t\t\tswitch (fmt.length) {\n\t\t\t\tcase 1:\n\t\t\t\tcase 2:\n\t\t\t\t\tout = y % 100;\n\t\t\t\t\toutl = 2;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tout = y % 10000;\n\t\t\t\t\toutl = 4;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 109 /* 'm' month */:\n\t\t\tswitch (fmt.length) {\n\t\t\t\tcase 1:\n\t\t\t\tcase 2:\n\t\t\t\t\tout = val.m;\n\t\t\t\t\toutl = fmt.length;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\treturn months[val.m - 1][1];\n\t\t\t\tcase 5:\n\t\t\t\t\treturn months[val.m - 1][0];\n\t\t\t\tdefault:\n\t\t\t\t\treturn months[val.m - 1][2];\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 100 /* 'd' day */:\n\t\t\tswitch (fmt.length) {\n\t\t\t\tcase 1:\n\t\t\t\tcase 2:\n\t\t\t\t\tout = val.d;\n\t\t\t\t\toutl = fmt.length;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\treturn days[val.q][0];\n\t\t\t\tdefault:\n\t\t\t\t\treturn days[val.q][1];\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 104 /* 'h' 12-hour */:\n\t\t\tswitch (fmt.length) {\n\t\t\t\tcase 1:\n\t\t\t\tcase 2:\n\t\t\t\t\tout = 1 + ((val.H + 11) % 12);\n\t\t\t\t\toutl = fmt.length;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow \"bad hour format: \" + fmt;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 72 /* 'H' 24-hour */:\n\t\t\tswitch (fmt.length) {\n\t\t\t\tcase 1:\n\t\t\t\tcase 2:\n\t\t\t\t\tout = val.H;\n\t\t\t\t\toutl = fmt.length;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow \"bad hour format: \" + fmt;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 77 /* 'M' minutes */:\n\t\t\tswitch (fmt.length) {\n\t\t\t\tcase 1:\n\t\t\t\tcase 2:\n\t\t\t\t\tout = val.M;\n\t\t\t\t\toutl = fmt.length;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow \"bad minute format: \" + fmt;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 115 /* 's' seconds */:\n\t\t\tif (fmt !== \"s\" && fmt !== \"ss\" && fmt !== \".0\" && fmt !== \".00\" && fmt !== \".000\")\n\t\t\t\tthrow \"bad second format: \" + fmt;\n\t\t\tif (val.u === 0 && (fmt === \"s\" || fmt === \"ss\")) return pad0(val.S, fmt.length);\n\t\t\tif (ss0! >= 2) tt = ss0 === 3 ? 1000 : 100;\n\t\t\telse tt = ss0 === 1 ? 10 : 1;\n\t\t\tss = Math.round(tt * (val.S + val.u));\n\t\t\tif (ss >= 60 * tt) ss = 0;\n\t\t\tif (fmt === \"s\") return ss === 0 ? \"0\" : \"\" + ss / tt;\n\t\t\to = pad0(ss, 2 + ss0!);\n\t\t\tif (fmt === \"ss\") return o.substr(0, 2);\n\t\t\treturn \".\" + o.substr(2, fmt.length - 1);\n\t\tcase 90 /* 'Z' absolute time */:\n\t\t\tswitch (fmt) {\n\t\t\t\tcase \"[h]\":\n\t\t\t\tcase \"[hh]\":\n\t\t\t\t\tout = val.D * 24 + val.H;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"[m]\":\n\t\t\t\tcase \"[mm]\":\n\t\t\t\t\tout = (val.D * 24 + val.H) * 60 + val.M;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"[s]\":\n\t\t\t\tcase \"[ss]\":\n\t\t\t\t\tout =\n\t\t\t\t\t\t((val.D * 24 + val.H) * 60 + val.M) * 60 +\n\t\t\t\t\t\t(ss0 === 0 ? Math.round(val.S + val.u) : val.S);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow \"bad abstime format: \" + fmt;\n\t\t\t}\n\t\t\toutl = fmt.length === 3 ? 1 : 2;\n\t\t\tbreak;\n\t\tcase 101 /* 'e' era */:\n\t\t\tout = y;\n\t\t\toutl = 1;\n\t\t\tbreak;\n\t}\n\treturn outl > 0 ? pad0(out, outl) : \"\";\n}\n\nfunction commaify(s: string): string {\n\tconst w = 3;\n\tif (s.length <= w) return s;\n\tconst j = s.length % w;\n\tlet o = s.substr(0, j);\n\tfor (let i = j; i !== s.length; i += w) o += (o.length > 0 ? \",\" : \"\") + s.substr(i, w);\n\treturn o;\n}\n\nconst pct1 = /%/g;\nfunction write_num_pct(type: string, fmt: string, val: number): string {\n\tconst sfmt = fmt.replace(pct1, \"\");\n\tconst mul = fmt.length - sfmt.length;\n\treturn write_num(type, sfmt, val * Math.pow(10, 2 * mul)) + fill(\"%\", mul);\n}\nfunction write_num_cm(type: string, fmt: string, val: number): string {\n\tlet idx = fmt.length - 1;\n\twhile (fmt.charCodeAt(idx - 1) === 44) --idx;\n\treturn write_num(type, fmt.substr(0, idx), val / Math.pow(10, 3 * (fmt.length - idx)));\n}\nfunction write_num_exp(fmt: string, val: number): string {\n\tlet o: string;\n\tconst idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\n\tif (fmt.match(/^#+0.0E\\+0$/)) {\n\t\tif (val === 0) return \"0.0E+0\";\n\t\tif (val < 0) return \"-\" + write_num_exp(fmt, -val);\n\t\tconst period = fmt.indexOf(\".\");\n\t\tconst ee = Math.floor(Math.log(val) * Math.LOG10E) % period < 0\n\t\t\t? Math.floor(Math.log(val) * Math.LOG10E) % period + period\n\t\t\t: Math.floor(Math.log(val) * Math.LOG10E) % period;\n\t\to = (val / Math.pow(10, ee)).toPrecision(idx + 1 + ((period + ee) % period));\n\t\tif (o.indexOf(\"e\") === -1) {\n\t\t\tconst fakee = Math.floor(Math.log(val) * Math.LOG10E);\n\t\t\tif (o.indexOf(\".\") === -1)\n\t\t\t\to = o.charAt(0) + \".\" + o.substr(1) + \"E+\" + (fakee - o.length + ee);\n\t\t\telse o += \"E+\" + (fakee - ee);\n\t\t\twhile (o.substr(0, 2) === \"0.\") {\n\t\t\t\to = o.charAt(0) + o.substr(2, period) + \".\" + o.substr(2 + period);\n\t\t\t\to = o.replace(/^0+([1-9])/, \"$1\").replace(/^0+\\./, \"0.\");\n\t\t\t}\n\t\t\to = o.replace(/\\+-/, \"-\");\n\t\t}\n\t\to = o.replace(\n\t\t\t/^([+-]?)(\\d*)\\.(\\d*)[Ee]/,\n\t\t\t($$, $1, $2, $3) => $1 + $2 + $3.substr(0, (period + ee) % period) + \".\" + $3.substr(ee) + \"E\",\n\t\t);\n\t} else o = val.toExponential(idx);\n\tif (fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/))\n\t\to = o.substr(0, o.length - 1) + \"0\" + o.charAt(o.length - 1);\n\tif (fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/, \"e\");\n\treturn o.replace(\"e\", \"E\");\n}\n\nfunction SSF_frac(x: number, D: number, mixed?: boolean): number[] {\n\tconst sgn = x < 0 ? -1 : 1;\n\tlet B = x * sgn;\n\tlet P_2 = 0,\n\t\tP_1 = 1,\n\t\tP = 0;\n\tlet Q_2 = 1,\n\t\tQ_1 = 0,\n\t\tQ = 0;\n\tlet A = Math.floor(B);\n\twhile (Q_1 < D) {\n\t\tA = Math.floor(B);\n\t\tP = A * P_1 + P_2;\n\t\tQ = A * Q_1 + Q_2;\n\t\tif (B - A < 0.00000005) break;\n\t\tB = 1 / (B - A);\n\t\tP_2 = P_1;\n\t\tP_1 = P;\n\t\tQ_2 = Q_1;\n\t\tQ_1 = Q;\n\t}\n\tif (Q > D) {\n\t\tif (Q_1 > D) {\n\t\t\tQ = Q_2;\n\t\t\tP = P_2;\n\t\t} else {\n\t\t\tQ = Q_1;\n\t\t\tP = P_1;\n\t\t}\n\t}\n\tif (!mixed) return [0, sgn * P, Q];\n\tconst q = Math.floor((sgn * P) / Q);\n\treturn [q, sgn * P - q * Q, Q];\n}\n\nconst frac1 = /# (\\?+)( ?)\\/( ?)(\\d+)/;\nfunction write_num_f1(r: string[], aval: number, sign: string): string {\n\tconst den = parseInt(r[4], 10);\n\tconst rr = Math.round(aval * den);\n\tconst base = Math.floor(rr / den);\n\tconst myn = rr - base * den;\n\tconst myd = den;\n\treturn (\n\t\tsign +\n\t\t(base === 0 ? \"\" : \"\" + base) +\n\t\t\" \" +\n\t\t(myn === 0\n\t\t\t? fill(\" \", r[1].length + 1 + r[4].length)\n\t\t\t: pad_(myn, r[1].length) + r[2] + \"/\" + r[3] + pad0(myd, r[4].length))\n\t);\n}\nfunction write_num_f2(r: string[], aval: number, sign: string): string {\n\treturn sign + (aval === 0 ? \"\" : \"\" + aval) + fill(\" \", r[1].length + 2 + r[4].length);\n}\n\nconst dec1 = /^#*0*\\.([0#]+)/;\nconst closeparen = /\\)[^)]*[0#]/;\nconst phone = /\\(###\\) ###\\\\?-####/;\n\nfunction hashq(str: string): string {\n\tlet o = \"\";\n\tfor (let i = 0; i !== str.length; ++i) {\n\t\tconst cc = str.charCodeAt(i);\n\t\tswitch (cc) {\n\t\t\tcase 35:\n\t\t\t\tbreak;\n\t\t\tcase 63:\n\t\t\t\to += \" \";\n\t\t\t\tbreak;\n\t\t\tcase 48:\n\t\t\t\to += \"0\";\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\to += String.fromCharCode(cc);\n\t\t}\n\t}\n\treturn o;\n}\n\nfunction rnd(val: number, d: number): string {\n\tconst sgn = val < 0 ? -1 : 1;\n\tconst dd = Math.pow(10, d);\n\treturn \"\" + (sgn * (Math.round(sgn * val * dd) / dd));\n}\nfunction dec(val: number, d: number): number {\n\tconst _frac = val - Math.floor(val);\n\tconst dd = Math.pow(10, d);\n\tif (d < (\"\" + Math.round(_frac * dd)).length) return 0;\n\treturn Math.round(_frac * dd);\n}\nfunction carry(val: number, d: number): number {\n\tif (d < (\"\" + Math.round((val - Math.floor(val)) * Math.pow(10, d))).length) return 1;\n\treturn 0;\n}\nfunction flr(val: number): string {\n\tif (val < 2147483647 && val > -2147483648) return \"\" + (val >= 0 ? val | 0 : (val - 1) | 0);\n\treturn \"\" + Math.floor(val);\n}\n\nfunction write_num_flt(type: string, fmt: string, val: number): string {\n\tif (type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n\t\tconst ffmt = fmt.replace(/\\( */, \"\").replace(/ \\)/, \"\").replace(/\\)/, \"\");\n\t\tif (val >= 0) return write_num_flt(\"n\", ffmt, val);\n\t\treturn \"(\" + write_num_flt(\"n\", ffmt, -val) + \")\";\n\t}\n\tif (fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm(type, fmt, val);\n\tif (fmt.indexOf(\"%\") !== -1) return write_num_pct(type, fmt, val);\n\tif (fmt.indexOf(\"E\") !== -1) return write_num_exp(fmt, val);\n\tif (fmt.charCodeAt(0) === 36)\n\t\treturn \"$\" + write_num_flt(type, fmt.substr(fmt.charAt(1) === \" \" ? 2 : 1), val);\n\tlet o: string;\n\tlet r: RegExpMatchArray | null;\n\tlet ri: number;\n\tlet ff: number[];\n\tconst aval = Math.abs(val);\n\tconst sign = val < 0 ? \"-\" : \"\";\n\tif (fmt.match(/^00+$/)) return sign + pad0r(aval, fmt.length);\n\tif (fmt.match(/^[#?]+$/)) {\n\t\to = pad0r(val, 0);\n\t\tif (o === \"0\") o = \"\";\n\t\treturn o.length > fmt.length ? o : hashq(fmt.substr(0, fmt.length - o.length)) + o;\n\t}\n\tif ((r = fmt.match(frac1))) return write_num_f1(r, aval, sign);\n\tif (fmt.match(/^#+0+$/)) return sign + pad0r(aval, fmt.length - fmt.indexOf(\"0\"));\n\tif ((r = fmt.match(dec1))) {\n\t\to = rnd(val, r[1].length)\n\t\t\t.replace(/^([^\\.]+)$/, \"$1.\" + hashq(r[1]))\n\t\t\t.replace(/\\.$/, \".\" + hashq(r[1]))\n\t\t\t.replace(/\\.(\\d*)$/, ($$, $1) => \".\" + $1 + fill(\"0\", hashq(r![1]).length - $1.length));\n\t\treturn fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./, \".\");\n\t}\n\tfmt = fmt.replace(/^#+([0.])/, \"$1\");\n\tif ((r = fmt.match(/^(0*)\\.(#*)$/))) {\n\t\treturn (\n\t\t\tsign +\n\t\t\trnd(aval, r[2].length)\n\t\t\t\t.replace(/\\.(\\d*[1-9])0*$/, \".$1\")\n\t\t\t\t.replace(/^(-?\\d*)$/, \"$1.\")\n\t\t\t\t.replace(/^0\\./, r[1].length ? \"0.\" : \".\")\n\t\t);\n\t}\n\tif (fmt.match(/^#{1,3},##0(\\.?)$/)) return sign + commaify(pad0r(aval, 0));\n\tif ((r = fmt.match(/^#,##0\\.([#0]*0)$/))) {\n\t\treturn val < 0\n\t\t\t? \"-\" + write_num_flt(type, fmt, -val)\n\t\t\t: commaify(\"\" + (Math.floor(val) + carry(val, r[1].length))) +\n\t\t\t\t\t\".\" +\n\t\t\t\t\tpad0(dec(val, r[1].length), r[1].length);\n\t}\n\tif ((r = fmt.match(/^#,#*,#0/))) return write_num_flt(type, fmt.replace(/^#,#*,/, \"\"), val);\n\tif ((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/))) {\n\t\to = _strrev(write_num_flt(type, fmt.replace(/[\\\\-]/g, \"\"), val));\n\t\tri = 0;\n\t\treturn _strrev(\n\t\t\t_strrev(fmt.replace(/\\\\/g, \"\")).replace(/[0#]/g, (x) => {\n\t\t\t\treturn ri < o.length ? o.charAt(ri++) : x === \"0\" ? \"0\" : \"\";\n\t\t\t}),\n\t\t);\n\t}\n\tif (fmt.match(phone)) {\n\t\to = write_num_flt(type, \"##########\", val);\n\t\treturn \"(\" + o.substr(0, 3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n\t}\n\tlet oa = \"\";\n\tif ((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/))) {\n\t\tri = Math.min(r[4].length, 7);\n\t\tff = SSF_frac(aval, Math.pow(10, ri) - 1, false);\n\t\to = \"\" + sign;\n\t\toa = write_num(\"n\", r[1], ff[1]);\n\t\tif (oa.charAt(oa.length - 1) === \" \") oa = oa.substr(0, oa.length - 1) + \"0\";\n\t\to += oa + r[2] + \"/\" + r[3];\n\t\toa = rpad_(ff[2], ri);\n\t\tif (oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length - oa.length)) + oa;\n\t\to += oa;\n\t\treturn o;\n\t}\n\tif ((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/))) {\n\t\tri = Math.min(Math.max(r[1].length, r[4].length), 7);\n\t\tff = SSF_frac(aval, Math.pow(10, ri) - 1, true);\n\t\treturn (\n\t\t\tsign +\n\t\t\t(ff[0] || (ff[1] ? \"\" : \"0\")) +\n\t\t\t\" \" +\n\t\t\t(ff[1]\n\t\t\t\t? pad_(ff[1], ri) + r[2] + \"/\" + r[3] + rpad_(ff[2], ri)\n\t\t\t\t: fill(\" \", 2 * ri + 1 + r[2].length + r[3].length))\n\t\t);\n\t}\n\tif ((r = fmt.match(/^[#0?]+$/))) {\n\t\to = pad0r(val, 0);\n\t\tif (fmt.length <= o.length) return o;\n\t\treturn hashq(fmt.substr(0, fmt.length - o.length)) + o;\n\t}\n\tif ((r = fmt.match(/^([#0?]+)\\.([#0]+)$/))) {\n\t\to = \"\" + val.toFixed(Math.min(r[2].length, 10)).replace(/([^0])0+$/, \"$1\");\n\t\tri = o.indexOf(\".\");\n\t\tconst lres = fmt.indexOf(\".\") - ri;\n\t\tconst rres = fmt.length - o.length - lres;\n\t\treturn hashq(fmt.substr(0, lres) + o + fmt.substr(fmt.length - rres));\n\t}\n\tif ((r = fmt.match(/^00,000\\.([#0]*0)$/))) {\n\t\tri = dec(val, r[1].length);\n\t\treturn val < 0\n\t\t\t? \"-\" + write_num_flt(type, fmt, -val)\n\t\t\t: commaify(flr(val))\n\t\t\t\t\t.replace(/^\\d,\\d{3}$/, \"0$&\")\n\t\t\t\t\t.replace(/^\\d*$/, ($$) => \"00,\" + ($$.length < 3 ? pad0(0, 3 - $$.length) : \"\") + $$) +\n\t\t\t\t\t\".\" +\n\t\t\t\t\tpad0(ri, r[1].length);\n\t}\n\tswitch (fmt) {\n\t\tcase \"###,##0.00\":\n\t\t\treturn write_num_flt(type, \"#,##0.00\", val);\n\t\tcase \"###,###\":\n\t\tcase \"##,###\":\n\t\tcase \"#,###\": {\n\t\t\tconst x = commaify(pad0r(aval, 0));\n\t\t\treturn x !== \"0\" ? sign + x : \"\";\n\t\t}\n\t\tcase \"###,###.00\":\n\t\t\treturn write_num_flt(type, \"###,##0.00\", val).replace(/^0\\./, \".\");\n\t\tcase \"#,###.00\":\n\t\t\treturn write_num_flt(type, \"#,##0.00\", val).replace(/^0\\./, \".\");\n\t}\n\tthrow new Error(\"unsupported format |\" + fmt + \"|\");\n}\n\nfunction write_num_int(type: string, fmt: string, val: number): string {\n\tif (type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n\t\tconst ffmt = fmt.replace(/\\( */, \"\").replace(/ \\)/, \"\").replace(/\\)/, \"\");\n\t\tif (val >= 0) return write_num_int(\"n\", ffmt, val);\n\t\treturn \"(\" + write_num_int(\"n\", ffmt, -val) + \")\";\n\t}\n\tif (fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm(type, fmt, val);\n\tif (fmt.indexOf(\"%\") !== -1) return write_num_pct(type, fmt, val);\n\tif (fmt.indexOf(\"E\") !== -1) return write_num_exp(fmt, val);\n\tif (fmt.charCodeAt(0) === 36)\n\t\treturn \"$\" + write_num_int(type, fmt.substr(fmt.charAt(1) === \" \" ? 2 : 1), val);\n\tlet o: string;\n\tlet r: RegExpMatchArray | null;\n\tlet ri: number;\n\tlet ff: number[];\n\tconst aval = Math.abs(val);\n\tconst sign = val < 0 ? \"-\" : \"\";\n\tif (fmt.match(/^00+$/)) return sign + pad0(aval, fmt.length);\n\tif (fmt.match(/^[#?]+$/)) {\n\t\to = \"\" + val;\n\t\tif (val === 0) o = \"\";\n\t\treturn o.length > fmt.length ? o : hashq(fmt.substr(0, fmt.length - o.length)) + o;\n\t}\n\tif ((r = fmt.match(frac1))) return write_num_f2(r, aval, sign);\n\tif (fmt.match(/^#+0+$/)) return sign + pad0(aval, fmt.length - fmt.indexOf(\"0\"));\n\tif ((r = fmt.match(dec1))) {\n\t\to = (\"\" + val)\n\t\t\t.replace(/^([^\\.]+)$/, \"$1.\" + hashq(r[1]))\n\t\t\t.replace(/\\.$/, \".\" + hashq(r[1]));\n\t\to = o.replace(/\\.(\\d*)$/, ($$, $1) => \".\" + $1 + fill(\"0\", hashq(r![1]).length - $1.length));\n\t\treturn fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./, \".\");\n\t}\n\tfmt = fmt.replace(/^#+([0.])/, \"$1\");\n\tif ((r = fmt.match(/^(0*)\\.(#*)$/))) {\n\t\treturn (\n\t\t\tsign +\n\t\t\t(\"\" + aval)\n\t\t\t\t.replace(/\\.(\\d*[1-9])0*$/, \".$1\")\n\t\t\t\t.replace(/^(-?\\d*)$/, \"$1.\")\n\t\t\t\t.replace(/^0\\./, r[1].length ? \"0.\" : \".\")\n\t\t);\n\t}\n\tif (fmt.match(/^#{1,3},##0(\\.?)$/)) return sign + commaify(\"\" + aval);\n\tif ((r = fmt.match(/^#,##0\\.([#0]*0)$/))) {\n\t\treturn val < 0\n\t\t\t? \"-\" + write_num_int(type, fmt, -val)\n\t\t\t: commaify(\"\" + val) + \".\" + fill(\"0\", r[1].length);\n\t}\n\tif ((r = fmt.match(/^#,#*,#0/))) return write_num_int(type, fmt.replace(/^#,#*,/, \"\"), val);\n\tif ((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/))) {\n\t\to = _strrev(write_num_int(type, fmt.replace(/[\\\\-]/g, \"\"), val));\n\t\tri = 0;\n\t\treturn _strrev(\n\t\t\t_strrev(fmt.replace(/\\\\/g, \"\")).replace(/[0#]/g, (x) => {\n\t\t\t\treturn ri < o.length ? o.charAt(ri++) : x === \"0\" ? \"0\" : \"\";\n\t\t\t}),\n\t\t);\n\t}\n\tif (fmt.match(phone)) {\n\t\to = write_num_int(type, \"##########\", val);\n\t\treturn \"(\" + o.substr(0, 3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n\t}\n\tlet oa = \"\";\n\tif ((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/))) {\n\t\tri = Math.min(r[4].length, 7);\n\t\tff = SSF_frac(aval, Math.pow(10, ri) - 1, false);\n\t\to = \"\" + sign;\n\t\toa = write_num(\"n\", r[1], ff[1]);\n\t\tif (oa.charAt(oa.length - 1) === \" \") oa = oa.substr(0, oa.length - 1) + \"0\";\n\t\to += oa + r[2] + \"/\" + r[3];\n\t\toa = rpad_(ff[2], ri);\n\t\tif (oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length - oa.length)) + oa;\n\t\to += oa;\n\t\treturn o;\n\t}\n\tif ((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/))) {\n\t\tri = Math.min(Math.max(r[1].length, r[4].length), 7);\n\t\tff = SSF_frac(aval, Math.pow(10, ri) - 1, true);\n\t\treturn (\n\t\t\tsign +\n\t\t\t(ff[0] || (ff[1] ? \"\" : \"0\")) +\n\t\t\t\" \" +\n\t\t\t(ff[1]\n\t\t\t\t? pad_(ff[1], ri) + r[2] + \"/\" + r[3] + rpad_(ff[2], ri)\n\t\t\t\t: fill(\" \", 2 * ri + 1 + r[2].length + r[3].length))\n\t\t);\n\t}\n\tif ((r = fmt.match(/^[#0?]+$/))) {\n\t\to = \"\" + val;\n\t\tif (fmt.length <= o.length) return o;\n\t\treturn hashq(fmt.substr(0, fmt.length - o.length)) + o;\n\t}\n\tif ((r = fmt.match(/^([#0]+)\\.([#0]+)$/))) {\n\t\to = \"\" + val.toFixed(Math.min(r[2].length, 10)).replace(/([^0])0+$/, \"$1\");\n\t\tri = o.indexOf(\".\");\n\t\tconst lres = fmt.indexOf(\".\") - ri;\n\t\tconst rres = fmt.length - o.length - lres;\n\t\treturn hashq(fmt.substr(0, lres) + o + fmt.substr(fmt.length - rres));\n\t}\n\tif ((r = fmt.match(/^00,000\\.([#0]*0)$/))) {\n\t\treturn val < 0\n\t\t\t? \"-\" + write_num_int(type, fmt, -val)\n\t\t\t: commaify(\"\" + val)\n\t\t\t\t\t.replace(/^\\d,\\d{3}$/, \"0$&\")\n\t\t\t\t\t.replace(/^\\d*$/, ($$) => \"00,\" + ($$.length < 3 ? pad0(0, 3 - $$.length) : \"\") + $$) +\n\t\t\t\t\t\".\" +\n\t\t\t\t\tpad0(0, r[1].length);\n\t}\n\tswitch (fmt) {\n\t\tcase \"###,###\":\n\t\tcase \"##,###\":\n\t\tcase \"#,###\": {\n\t\t\tconst x = commaify(\"\" + aval);\n\t\t\treturn x !== \"0\" ? sign + x : \"\";\n\t\t}\n\t\tdefault:\n\t\t\tif (fmt.match(/\\.[0#?]*$/))\n\t\t\t\treturn (\n\t\t\t\t\twrite_num_int(type, fmt.slice(0, fmt.lastIndexOf(\".\")), val) +\n\t\t\t\t\thashq(fmt.slice(fmt.lastIndexOf(\".\")))\n\t\t\t\t);\n\t}\n\tthrow new Error(\"unsupported format |\" + fmt + \"|\");\n}\n\nfunction write_num(type: string, fmt: string, val: number): string {\n\treturn (val | 0) === val ? write_num_int(type, fmt, val) : write_num_flt(type, fmt, val);\n}\n\nfunction SSF_split_fmt(fmt: string): string[] {\n\tconst out: string[] = [];\n\tlet in_str = false;\n\tlet j = 0;\n\tfor (let i = 0; i < fmt.length; ++i) {\n\t\tswitch (fmt.charCodeAt(i)) {\n\t\t\tcase 34 /* '\"' */:\n\t\t\t\tin_str = !in_str;\n\t\t\t\tbreak;\n\t\t\tcase 95:\n\t\t\tcase 42:\n\t\t\tcase 92 /* '_' '*' '\\\\' */:\n\t\t\t\t++i;\n\t\t\t\tbreak;\n\t\t\tcase 59 /* ';' */:\n\t\t\t\tout[out.length] = fmt.substr(j, i - j);\n\t\t\t\tj = i + 1;\n\t\t}\n\t}\n\tout[out.length] = fmt.substr(j);\n\tif (in_str === true) throw new Error(\"Format |\" + fmt + \"| unterminated string \");\n\treturn out;\n}\n\nconst SSF_abstime = /\\[[HhMmSs\\u0E0A\\u0E19\\u0E17]*\\]/;\n\nexport function fmt_is_date(fmt: string): boolean {\n\tlet i = 0;\n\tlet c = \"\";\n\tlet o = \"\";\n\twhile (i < fmt.length) {\n\t\tswitch ((c = fmt.charAt(i))) {\n\t\t\tcase \"G\":\n\t\t\t\tif (SSF_isgeneral(fmt, i)) i += 6;\n\t\t\t\ti++;\n\t\t\t\tbreak;\n\t\t\tcase '\"':\n\t\t\t\tfor (; fmt.charCodeAt(++i) !== 34 && i < fmt.length; ) {\n\t\t\t\t\t/* empty */\n\t\t\t\t}\n\t\t\t\t++i;\n\t\t\t\tbreak;\n\t\t\tcase \"\\\\\":\n\t\t\t\ti += 2;\n\t\t\t\tbreak;\n\t\t\tcase \"_\":\n\t\t\t\ti += 2;\n\t\t\t\tbreak;\n\t\t\tcase \"@\":\n\t\t\t\t++i;\n\t\t\t\tbreak;\n\t\t\tcase \"B\":\n\t\t\tcase \"b\":\n\t\t\t\tif (fmt.charAt(i + 1) === \"1\" || fmt.charAt(i + 1) === \"2\") return true;\n\t\t\t/* falls through */\n\t\t\tcase \"M\":\n\t\t\tcase \"D\":\n\t\t\tcase \"Y\":\n\t\t\tcase \"H\":\n\t\t\tcase \"S\":\n\t\t\tcase \"E\":\n\t\t\tcase \"m\":\n\t\t\tcase \"d\":\n\t\t\tcase \"y\":\n\t\t\tcase \"h\":\n\t\t\tcase \"s\":\n\t\t\tcase \"e\":\n\t\t\tcase \"g\":\n\t\t\t\treturn true;\n\t\t\tcase \"A\":\n\t\t\tcase \"a\":\n\t\t\tcase \"\\u4E0A\":\n\t\t\t\tif (fmt.substr(i, 3).toUpperCase() === \"A/P\") return true;\n\t\t\t\tif (fmt.substr(i, 5).toUpperCase() === \"AM/PM\") return true;\n\t\t\t\tif (fmt.substr(i, 5).toUpperCase() === \"\\u4E0A\\u5348/\\u4E0B\\u5348\") return true;\n\t\t\t\t++i;\n\t\t\t\tbreak;\n\t\t\tcase \"[\":\n\t\t\t\to = c;\n\t\t\t\twhile (fmt.charAt(i++) !== \"]\" && i < fmt.length) o += fmt.charAt(i);\n\t\t\t\tif (o.match(SSF_abstime)) return true;\n\t\t\t\tbreak;\n\t\t\tcase \".\":\n\t\t\tcase \"0\":\n\t\t\tcase \"#\":\n\t\t\t\twhile (\n\t\t\t\t\ti < fmt.length &&\n\t\t\t\t\t(\"0#?.,E+-%\".indexOf((c = fmt.charAt(++i))) > -1 ||\n\t\t\t\t\t\t(c === \"\\\\\" && fmt.charAt(i + 1) === \"-\" && \"0#\".indexOf(fmt.charAt(i + 2)) > -1))\n\t\t\t\t) {\n\t\t\t\t\t/* empty */\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"?\":\n\t\t\t\twhile (fmt.charAt(++i) === c) {\n\t\t\t\t\t/* empty */\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"*\":\n\t\t\t\t++i;\n\t\t\t\tif (fmt.charAt(i) === \" \" || fmt.charAt(i) === \"*\") ++i;\n\t\t\t\tbreak;\n\t\t\tcase \"(\":\n\t\t\tcase \")\":\n\t\t\t\t++i;\n\t\t\t\tbreak;\n\t\t\tcase \"1\":\n\t\t\tcase \"2\":\n\t\t\tcase \"3\":\n\t\t\tcase \"4\":\n\t\t\tcase \"5\":\n\t\t\tcase \"6\":\n\t\t\tcase \"7\":\n\t\t\tcase \"8\":\n\t\t\tcase \"9\":\n\t\t\t\twhile (i < fmt.length && \"0123456789\".indexOf(fmt.charAt(++i)) > -1) {\n\t\t\t\t\t/* empty */\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \" \":\n\t\t\t\t++i;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\t++i;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\treturn false;\n}\n\ninterface FmtToken {\n\tt: string;\n\tv: string;\n}\n\nfunction eval_fmt(fmt: string, v: any, opts: any, flen: number): string {\n\tconst out: (FmtToken | null)[] = [];\n\tlet o = \"\";\n\tlet i = 0;\n\tlet c = \"\";\n\tlet lst = \"t\";\n\tlet dt: SSFDateVal | null = null;\n\tlet j: number;\n\tlet cc: number;\n\tlet hr = \"H\";\n\n\t/* Tokenize */\n\twhile (i < fmt.length) {\n\t\tswitch ((c = fmt.charAt(i))) {\n\t\t\tcase \"G\":\n\t\t\t\tif (!SSF_isgeneral(fmt, i)) throw new Error(\"unrecognized character \" + c + \" in \" + fmt);\n\t\t\t\tout[out.length] = { t: \"G\", v: \"General\" };\n\t\t\t\ti += 7;\n\t\t\t\tbreak;\n\t\t\tcase '\"':\n\t\t\t\tfor (o = \"\"; (cc = fmt.charCodeAt(++i)) !== 34 && i < fmt.length; )\n\t\t\t\t\to += String.fromCharCode(cc);\n\t\t\t\tout[out.length] = { t: \"t\", v: o };\n\t\t\t\t++i;\n\t\t\t\tbreak;\n\t\t\tcase \"\\\\\": {\n\t\t\t\tconst w = fmt.charAt(++i);\n\t\t\t\tconst t2 = w === \"(\" || w === \")\" ? w : \"t\";\n\t\t\t\tout[out.length] = { t: t2, v: w };\n\t\t\t\t++i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase \"_\":\n\t\t\t\tout[out.length] = { t: \"t\", v: \" \" };\n\t\t\t\ti += 2;\n\t\t\t\tbreak;\n\t\t\tcase \"@\":\n\t\t\t\tout[out.length] = { t: \"T\", v: v };\n\t\t\t\t++i;\n\t\t\t\tbreak;\n\t\t\tcase \"B\":\n\t\t\tcase \"b\":\n\t\t\t\tif (fmt.charAt(i + 1) === \"1\" || fmt.charAt(i + 1) === \"2\") {\n\t\t\t\t\tif (dt == null) {\n\t\t\t\t\t\tdt = SSF_parse_date_code(v, opts, fmt.charAt(i + 1) === \"2\");\n\t\t\t\t\t\tif (dt == null) return \"\";\n\t\t\t\t\t}\n\t\t\t\t\tout[out.length] = { t: \"X\", v: fmt.substr(i, 2) };\n\t\t\t\t\tlst = c;\n\t\t\t\t\ti += 2;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t/* falls through */\n\t\t\tcase \"M\":\n\t\t\tcase \"D\":\n\t\t\tcase \"Y\":\n\t\t\tcase \"H\":\n\t\t\tcase \"S\":\n\t\t\tcase \"E\":\n\t\t\t\tc = c.toLowerCase();\n\t\t\t/* falls through */\n\t\t\tcase \"m\":\n\t\t\tcase \"d\":\n\t\t\tcase \"y\":\n\t\t\tcase \"h\":\n\t\t\tcase \"s\":\n\t\t\tcase \"e\":\n\t\t\tcase \"g\":\n\t\t\t\tif (v < 0) return \"\";\n\t\t\t\tif (dt == null) {\n\t\t\t\t\tdt = SSF_parse_date_code(v, opts);\n\t\t\t\t\tif (dt == null) return \"\";\n\t\t\t\t}\n\t\t\t\to = c;\n\t\t\t\twhile (++i < fmt.length && fmt.charAt(i).toLowerCase() === c) o += c;\n\t\t\t\tif (c === \"m\" && lst.toLowerCase() === \"h\") c = \"M\";\n\t\t\t\tif (c === \"h\") c = hr;\n\t\t\t\tout[out.length] = { t: c, v: o };\n\t\t\t\tlst = c;\n\t\t\t\tbreak;\n\t\t\tcase \"A\":\n\t\t\tcase \"a\":\n\t\t\tcase \"\\u4E0A\": {\n\t\t\t\tconst q: FmtToken = { t: c, v: c };\n\t\t\t\tif (dt == null) dt = SSF_parse_date_code(v, opts);\n\t\t\t\tif (fmt.substr(i, 3).toUpperCase() === \"A/P\") {\n\t\t\t\t\tif (dt != null) q.v = dt.H >= 12 ? fmt.charAt(i + 2) : c;\n\t\t\t\t\tq.t = \"T\";\n\t\t\t\t\thr = \"h\";\n\t\t\t\t\ti += 3;\n\t\t\t\t} else if (fmt.substr(i, 5).toUpperCase() === \"AM/PM\") {\n\t\t\t\t\tif (dt != null) q.v = dt.H >= 12 ? \"PM\" : \"AM\";\n\t\t\t\t\tq.t = \"T\";\n\t\t\t\t\ti += 5;\n\t\t\t\t\thr = \"h\";\n\t\t\t\t} else if (fmt.substr(i, 5).toUpperCase() === \"\\u4E0A\\u5348/\\u4E0B\\u5348\") {\n\t\t\t\t\tif (dt != null) q.v = dt.H >= 12 ? \"\\u4E0B\\u5348\" : \"\\u4E0A\\u5348\";\n\t\t\t\t\tq.t = \"T\";\n\t\t\t\t\ti += 5;\n\t\t\t\t\thr = \"h\";\n\t\t\t\t} else {\n\t\t\t\t\tq.t = \"t\";\n\t\t\t\t\t++i;\n\t\t\t\t}\n\t\t\t\tif (dt == null && q.t === \"T\") return \"\";\n\t\t\t\tout[out.length] = q;\n\t\t\t\tlst = c;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase \"[\":\n\t\t\t\to = c;\n\t\t\t\twhile (fmt.charAt(i++) !== \"]\" && i < fmt.length) o += fmt.charAt(i);\n\t\t\t\tif (o.slice(-1) !== \"]\") throw 'unterminated \"[\" block: |' + o + \"|\";\n\t\t\t\tif (o.match(SSF_abstime)) {\n\t\t\t\t\tif (dt == null) {\n\t\t\t\t\t\tdt = SSF_parse_date_code(v, opts);\n\t\t\t\t\t\tif (dt == null) return \"\";\n\t\t\t\t\t}\n\t\t\t\t\tout[out.length] = { t: \"Z\", v: o.toLowerCase() };\n\t\t\t\t\tlst = o.charAt(1);\n\t\t\t\t} else if (o.indexOf(\"$\") > -1) {\n\t\t\t\t\to = (o.match(/\\$([^-\\[\\]]*)/!) || [])[1] || \"$\";\n\t\t\t\t\tif (!fmt_is_date(fmt)) out[out.length] = { t: \"t\", v: o };\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \".\":\n\t\t\t\tif (dt != null) {\n\t\t\t\t\to = c;\n\t\t\t\t\twhile (++i < fmt.length && (c = fmt.charAt(i)) === \"0\") o += c;\n\t\t\t\t\tout[out.length] = { t: \"s\", v: o };\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t/* falls through */\n\t\t\tcase \"0\":\n\t\t\tcase \"#\":\n\t\t\t\to = c;\n\t\t\t\twhile (++i < fmt.length && \"0#?.,E+-%\".indexOf((c = fmt.charAt(i))) > -1) o += c;\n\t\t\t\tout[out.length] = { t: \"n\", v: o };\n\t\t\t\tbreak;\n\t\t\tcase \"?\":\n\t\t\t\to = c;\n\t\t\t\twhile (fmt.charAt(++i) === c) o += c;\n\t\t\t\tout[out.length] = { t: c, v: o };\n\t\t\t\tlst = c;\n\t\t\t\tbreak;\n\t\t\tcase \"*\":\n\t\t\t\t++i;\n\t\t\t\tif (fmt.charAt(i) === \" \" || fmt.charAt(i) === \"*\") ++i;\n\t\t\t\tbreak;\n\t\t\tcase \"(\":\n\t\t\tcase \")\":\n\t\t\t\tout[out.length] = { t: flen === 1 ? \"t\" : c, v: c };\n\t\t\t\t++i;\n\t\t\t\tbreak;\n\t\t\tcase \"1\":\n\t\t\tcase \"2\":\n\t\t\tcase \"3\":\n\t\t\tcase \"4\":\n\t\t\tcase \"5\":\n\t\t\tcase \"6\":\n\t\t\tcase \"7\":\n\t\t\tcase \"8\":\n\t\t\tcase \"9\":\n\t\t\t\to = c;\n\t\t\t\twhile (i < fmt.length && \"0123456789\".indexOf(fmt.charAt(++i)) > -1) o += fmt.charAt(i);\n\t\t\t\tout[out.length] = { t: \"D\", v: o };\n\t\t\t\tbreak;\n\t\t\tcase \" \":\n\t\t\t\tout[out.length] = { t: c, v: c };\n\t\t\t\t++i;\n\t\t\t\tbreak;\n\t\t\tcase \"$\":\n\t\t\t\tout[out.length] = { t: \"t\", v: \"$\" };\n\t\t\t\t++i;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tif (\",$-+/():!^&'~{}<>=\\u20ACacfijklopqrtuvwxzP\".indexOf(c) === -1)\n\t\t\t\t\tthrow new Error(\"unrecognized character \" + c + \" in \" + fmt);\n\t\t\t\tout[out.length] = { t: \"t\", v: c };\n\t\t\t\t++i;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* Scan for date/time parts */\n\tlet bt = 0;\n\tlet ss0 = 0;\n\tlet ssm: RegExpMatchArray | null;\n\tfor (i = out.length - 1, lst = \"t\"; i >= 0; --i) {\n\t\tif (!out[i]) continue;\n\t\tswitch (out[i]!.t) {\n\t\t\tcase \"h\":\n\t\t\tcase \"H\":\n\t\t\t\tout[i]!.t = hr;\n\t\t\t\tlst = \"h\";\n\t\t\t\tif (bt < 1) bt = 1;\n\t\t\t\tbreak;\n\t\t\tcase \"s\":\n\t\t\t\tif ((ssm = out[i]!.v.match(/\\.0+$/))) {\n\t\t\t\t\tss0 = Math.max(ss0, ssm[0].length - 1);\n\t\t\t\t\tbt = 4;\n\t\t\t\t}\n\t\t\t\tif (bt < 3) bt = 3;\n\t\t\t/* falls through */\n\t\t\tcase \"d\":\n\t\t\tcase \"y\":\n\t\t\tcase \"e\":\n\t\t\t\tlst = out[i]!.t;\n\t\t\t\tbreak;\n\t\t\tcase \"M\":\n\t\t\t\tlst = out[i]!.t;\n\t\t\t\tif (bt < 2) bt = 2;\n\t\t\t\tbreak;\n\t\t\tcase \"m\":\n\t\t\t\tif (lst === \"s\") {\n\t\t\t\t\tout[i]!.t = \"M\";\n\t\t\t\t\tif (bt < 2) bt = 2;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"X\":\n\t\t\t\tbreak;\n\t\t\tcase \"Z\":\n\t\t\t\tif (bt < 1 && out[i]!.v.match(/[Hh]/)) bt = 1;\n\t\t\t\tif (bt < 2 && out[i]!.v.match(/[Mm]/)) bt = 2;\n\t\t\t\tif (bt < 3 && out[i]!.v.match(/[Ss]/)) bt = 3;\n\t\t}\n\t}\n\n\t/* time rounding */\n\tif (dt) {\n\t\tlet _dt: SSFDateVal | null;\n\t\tswitch (bt) {\n\t\t\tcase 0:\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\tcase 2:\n\t\t\tcase 3:\n\t\t\t\tif (dt.u >= 0.5) {\n\t\t\t\t\tdt.u = 0;\n\t\t\t\t\t++dt.S;\n\t\t\t\t}\n\t\t\t\tif (dt.S >= 60) {\n\t\t\t\t\tdt.S = 0;\n\t\t\t\t\t++dt.M;\n\t\t\t\t}\n\t\t\t\tif (dt.M >= 60) {\n\t\t\t\t\tdt.M = 0;\n\t\t\t\t\t++dt.H;\n\t\t\t\t}\n\t\t\t\tif (dt.H >= 24) {\n\t\t\t\t\tdt.H = 0;\n\t\t\t\t\t++dt.D;\n\t\t\t\t\t_dt = SSF_parse_date_code(dt.D);\n\t\t\t\t\tif (_dt) {\n\t\t\t\t\t\t_dt.u = dt.u;\n\t\t\t\t\t\t_dt.S = dt.S;\n\t\t\t\t\t\t_dt.M = dt.M;\n\t\t\t\t\t\t_dt.H = dt.H;\n\t\t\t\t\t\tdt = _dt;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 4:\n\t\t\t\tswitch (ss0) {\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tdt.u = Math.round(dt.u * 10) / 10;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tdt.u = Math.round(dt.u * 100) / 100;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tdt.u = Math.round(dt.u * 1000) / 1000;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (dt.u >= 1) {\n\t\t\t\t\tdt.u = 0;\n\t\t\t\t\t++dt.S;\n\t\t\t\t}\n\t\t\t\tif (dt.S >= 60) {\n\t\t\t\t\tdt.S = 0;\n\t\t\t\t\t++dt.M;\n\t\t\t\t}\n\t\t\t\tif (dt.M >= 60) {\n\t\t\t\t\tdt.M = 0;\n\t\t\t\t\t++dt.H;\n\t\t\t\t}\n\t\t\t\tif (dt.H >= 24) {\n\t\t\t\t\tdt.H = 0;\n\t\t\t\t\t++dt.D;\n\t\t\t\t\t_dt = SSF_parse_date_code(dt.D);\n\t\t\t\t\tif (_dt) {\n\t\t\t\t\t\t_dt.u = dt.u;\n\t\t\t\t\t\t_dt.S = dt.S;\n\t\t\t\t\t\t_dt.M = dt.M;\n\t\t\t\t\t\t_dt.H = dt.H;\n\t\t\t\t\t\tdt = _dt;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* replace fields */\n\tlet nstr = \"\";\n\tlet jj: number;\n\tfor (i = 0; i < out.length; ++i) {\n\t\tif (!out[i]) continue;\n\t\tswitch (out[i]!.t) {\n\t\t\tcase \"t\":\n\t\t\tcase \"T\":\n\t\t\tcase \" \":\n\t\t\tcase \"D\":\n\t\t\t\tbreak;\n\t\t\tcase \"X\":\n\t\t\t\tout[i]!.v = \"\";\n\t\t\t\tout[i]!.t = \";\";\n\t\t\t\tbreak;\n\t\t\tcase \"d\":\n\t\t\tcase \"m\":\n\t\t\tcase \"y\":\n\t\t\tcase \"h\":\n\t\t\tcase \"H\":\n\t\t\tcase \"M\":\n\t\t\tcase \"s\":\n\t\t\tcase \"e\":\n\t\t\tcase \"b\":\n\t\t\tcase \"Z\":\n\t\t\t\tout[i]!.v = SSF_write_date(out[i]!.t.charCodeAt(0), out[i]!.v, dt!, ss0);\n\t\t\t\tout[i]!.t = \"t\";\n\t\t\t\tbreak;\n\t\t\tcase \"n\":\n\t\t\tcase \"?\":\n\t\t\t\tjj = i + 1;\n\t\t\t\twhile (\n\t\t\t\t\tout[jj] != null &&\n\t\t\t\t\t(((c = out[jj]!.t) === \"?\" || c === \"D\" ||\n\t\t\t\t\t\t((c === \" \" || c === \"t\") &&\n\t\t\t\t\t\t\tout[jj + 1] != null &&\n\t\t\t\t\t\t\t(out[jj + 1]!.t === \"?\" || (out[jj + 1]!.t === \"t\" && out[jj + 1]!.v === \"/\"))) ||\n\t\t\t\t\t\t(out[i]!.t === \"(\" && (c === \" \" || c === \"n\" || c === \")\")) ||\n\t\t\t\t\t\t(c === \"t\" &&\n\t\t\t\t\t\t\t(out[jj]!.v === \"/\" ||\n\t\t\t\t\t\t\t\t(out[jj]!.v === \" \" && out[jj + 1] != null && out[jj + 1]!.t === \"?\")))))\n\t\t\t\t) {\n\t\t\t\t\tout[i]!.v += out[jj]!.v;\n\t\t\t\t\tout[jj] = { v: \"\", t: \";\" };\n\t\t\t\t\t++jj;\n\t\t\t\t}\n\t\t\t\tnstr += out[i]!.v;\n\t\t\t\ti = jj - 1;\n\t\t\t\tbreak;\n\t\t\tcase \"G\":\n\t\t\t\tout[i]!.t = \"t\";\n\t\t\t\tout[i]!.v = SSF_general(v, opts);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tlet vv = \"\";\n\tlet myv: number;\n\tlet ostr: string;\n\tif (nstr.length > 0) {\n\t\tif (nstr.charCodeAt(0) === 40) {\n\t\t\tmyv = v < 0 && nstr.charCodeAt(0) === 45 ? -v : v;\n\t\t\tostr = write_num(\"n\", nstr, myv);\n\t\t} else {\n\t\t\tmyv = v < 0 && flen > 1 ? -v : v;\n\t\t\tostr = write_num(\"n\", nstr, myv);\n\t\t\tif (myv < 0 && out[0] && out[0].t === \"t\") {\n\t\t\t\tostr = ostr.substr(1);\n\t\t\t\tout[0].v = \"-\" + out[0].v;\n\t\t\t}\n\t\t}\n\t\tjj = ostr.length - 1;\n\t\tlet decpt = out.length;\n\t\tfor (i = 0; i < out.length; ++i)\n\t\t\tif (out[i] != null && out[i]!.t !== \"t\" && out[i]!.v.indexOf(\".\") > -1) {\n\t\t\t\tdecpt = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\tlet lasti = out.length;\n\t\tif (decpt === out.length && ostr.indexOf(\"E\") === -1) {\n\t\t\tfor (i = out.length - 1; i >= 0; --i) {\n\t\t\t\tif (out[i] == null || \"n?\".indexOf(out[i]!.t) === -1) continue;\n\t\t\t\tif (jj >= out[i]!.v.length - 1) {\n\t\t\t\t\tjj -= out[i]!.v.length;\n\t\t\t\t\tout[i]!.v = ostr.substr(jj + 1, out[i]!.v.length);\n\t\t\t\t} else if (jj < 0) out[i]!.v = \"\";\n\t\t\t\telse {\n\t\t\t\t\tout[i]!.v = ostr.substr(0, jj + 1);\n\t\t\t\t\tjj = -1;\n\t\t\t\t}\n\t\t\t\tout[i]!.t = \"t\";\n\t\t\t\tlasti = i;\n\t\t\t}\n\t\t\tif (jj >= 0 && lasti < out.length) out[lasti]!.v = ostr.substr(0, jj + 1) + out[lasti]!.v;\n\t\t} else if (decpt !== out.length && ostr.indexOf(\"E\") === -1) {\n\t\t\tjj = ostr.indexOf(\".\") - 1;\n\t\t\tfor (i = decpt; i >= 0; --i) {\n\t\t\t\tif (out[i] == null || \"n?\".indexOf(out[i]!.t) === -1) continue;\n\t\t\t\tj =\n\t\t\t\t\tout[i]!.v.indexOf(\".\") > -1 && i === decpt\n\t\t\t\t\t\t? out[i]!.v.indexOf(\".\") - 1\n\t\t\t\t\t\t: out[i]!.v.length - 1;\n\t\t\t\tvv = out[i]!.v.substr(j + 1);\n\t\t\t\tfor (; j >= 0; --j) {\n\t\t\t\t\tif (jj >= 0 && (out[i]!.v.charAt(j) === \"0\" || out[i]!.v.charAt(j) === \"#\"))\n\t\t\t\t\t\tvv = ostr.charAt(jj--) + vv;\n\t\t\t\t}\n\t\t\t\tout[i]!.v = vv;\n\t\t\t\tout[i]!.t = \"t\";\n\t\t\t\tlasti = i;\n\t\t\t}\n\t\t\tif (jj >= 0 && lasti < out.length) out[lasti]!.v = ostr.substr(0, jj + 1) + out[lasti]!.v;\n\t\t\tjj = ostr.indexOf(\".\") + 1;\n\t\t\tfor (i = decpt; i < out.length; ++i) {\n\t\t\t\tif (out[i] == null || (\"n?(\".indexOf(out[i]!.t) === -1 && i !== decpt)) continue;\n\t\t\t\tj =\n\t\t\t\t\tout[i]!.v.indexOf(\".\") > -1 && i === decpt ? out[i]!.v.indexOf(\".\") + 1 : 0;\n\t\t\t\tvv = out[i]!.v.substr(0, j);\n\t\t\t\tfor (; j < out[i]!.v.length; ++j) {\n\t\t\t\t\tif (jj < ostr.length) vv += ostr.charAt(jj++);\n\t\t\t\t}\n\t\t\t\tout[i]!.v = vv;\n\t\t\t\tout[i]!.t = \"t\";\n\t\t\t\tlasti = i;\n\t\t\t}\n\t\t}\n\t}\n\tfor (i = 0; i < out.length; ++i) {\n\t\tif (out[i] != null && \"n?\".indexOf(out[i]!.t) > -1) {\n\t\t\tmyv = flen > 1 && v < 0 && i > 0 && out[i - 1]!.v === \"-\" ? -v : v;\n\t\t\tout[i]!.v = write_num(out[i]!.t, out[i]!.v, myv);\n\t\t\tout[i]!.t = \"t\";\n\t\t}\n\t}\n\tlet retval = \"\";\n\tfor (i = 0; i !== out.length; ++i) if (out[i] != null) retval += out[i]!.v;\n\treturn retval;\n}\n\nconst cfregex2 = /\\[(=|>[=]?|<[>=]?)(-?\\d+(?:\\.\\d*)?)\\]/;\nfunction chkcond(v: number, rr: RegExpMatchArray | null): boolean {\n\tif (rr == null) return false;\n\tconst thresh = parseFloat(rr[2]);\n\tswitch (rr[1]) {\n\t\tcase \"=\":\n\t\t\tif (v == thresh) return true;\n\t\t\tbreak;\n\t\tcase \">\":\n\t\t\tif (v > thresh) return true;\n\t\t\tbreak;\n\t\tcase \"<\":\n\t\t\tif (v < thresh) return true;\n\t\t\tbreak;\n\t\tcase \"<>\":\n\t\t\tif (v != thresh) return true;\n\t\t\tbreak;\n\t\tcase \">=\":\n\t\t\tif (v >= thresh) return true;\n\t\t\tbreak;\n\t\tcase \"<=\":\n\t\t\tif (v <= thresh) return true;\n\t\t\tbreak;\n\t}\n\treturn false;\n}\n\nfunction choose_fmt(f: string, v: any): [number, string] {\n\tlet fmt = SSF_split_fmt(f);\n\tconst l = fmt.length;\n\tconst lat = fmt[l - 1].indexOf(\"@\");\n\tlet ll = l;\n\tif (l < 4 && lat > -1) --ll;\n\tif (fmt.length > 4) throw new Error(\"cannot find right format for |\" + fmt.join(\"|\") + \"|\");\n\tif (typeof v !== \"number\")\n\t\treturn [4, fmt.length === 4 || lat > -1 ? fmt[fmt.length - 1] : \"@\"];\n\tif (typeof v === \"number\" && !isFinite(v)) v = 0;\n\tswitch (fmt.length) {\n\t\tcase 1:\n\t\t\tfmt =\n\t\t\t\tlat > -1\n\t\t\t\t\t? [\"General\", \"General\", \"General\", fmt[0]]\n\t\t\t\t\t: [fmt[0], fmt[0], fmt[0], \"@\"];\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tfmt =\n\t\t\t\tlat > -1\n\t\t\t\t\t? [fmt[0], fmt[0], fmt[0], fmt[1]]\n\t\t\t\t\t: [fmt[0], fmt[1], fmt[0], \"@\"];\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tfmt =\n\t\t\t\tlat > -1\n\t\t\t\t\t? [fmt[0], fmt[1], fmt[0], fmt[2]]\n\t\t\t\t\t: [fmt[0], fmt[1], fmt[2], \"@\"];\n\t\t\tbreak;\n\t\tcase 4:\n\t\t\tbreak;\n\t}\n\tconst ff = v > 0 ? fmt[0] : v < 0 ? fmt[1] : fmt[2];\n\tif (fmt[0].indexOf(\"[\") === -1 && fmt[1].indexOf(\"[\") === -1) return [ll, ff];\n\tif (fmt[0].match(/\\[[=<>]/) != null || fmt[1].match(/\\[[=<>]/) != null) {\n\t\tconst m1 = fmt[0].match(cfregex2);\n\t\tconst m2 = fmt[1].match(cfregex2);\n\t\treturn chkcond(v, m1)\n\t\t\t? [ll, fmt[0]]\n\t\t\t: chkcond(v, m2)\n\t\t\t\t? [ll, fmt[1]]\n\t\t\t\t: [ll, fmt[m1 != null && m2 != null ? 2 : 1]];\n\t}\n\treturn [ll, ff];\n}\n\n/** Format a value using an Excel number format string */\nexport function SSF_format(fmt: string | number, v: any, o?: any): string {\n\tif (o == null) o = {};\n\tlet sfmt = \"\";\n\tswitch (typeof fmt) {\n\t\tcase \"string\":\n\t\t\tif (fmt === \"m/d/yy\" && o.dateNF) sfmt = o.dateNF;\n\t\t\telse sfmt = fmt;\n\t\t\tbreak;\n\t\tcase \"number\":\n\t\t\tif (fmt === 14 && o.dateNF) sfmt = o.dateNF;\n\t\t\telse sfmt = (o.table != null ? o.table : table_fmt)[fmt];\n\t\t\tif (sfmt == null) sfmt = (o.table && o.table[SSF_default_map[fmt]]) || table_fmt[SSF_default_map[fmt]];\n\t\t\tif (sfmt == null) sfmt = SSF_default_str[fmt] || \"General\";\n\t\t\tbreak;\n\t}\n\tif (SSF_isgeneral(sfmt, 0)) return SSF_general(v, o);\n\tif (v instanceof Date) v = datenum(v, o.date1904);\n\tconst f = choose_fmt(sfmt, v);\n\tif (SSF_isgeneral(f[1])) return SSF_general(v, o);\n\tif (v === true) v = \"TRUE\";\n\telse if (v === false) v = \"FALSE\";\n\telse if (v === \"\" || v == null) return \"\";\n\telse if (isNaN(v) && f[1].indexOf(\"0\") > -1) return \"#NUM!\";\n\telse if (!isFinite(v) && f[1].indexOf(\"0\") > -1) return \"#DIV/0!\";\n\treturn eval_fmt(f[1], v, o, f[0]);\n}\n","import type { WorkSheet, CellObject, Range, ColInfo, RowInfo, MarginInfo } from \"../types.js\";\nimport { BErr } from \"../types.js\";\nimport { parsexmltag, tagregex, XML_HEADER, parsexmlbool } from \"../xml/parser.js\";\nimport { unescapexml, escapexml } from \"../xml/escape.js\";\nimport { writextag } from \"../xml/writer.js\";\nimport { XMLNS_main } from \"../xml/namespaces.js\";\nimport { safe_decode_range, encode_range, encode_cell, encode_col } from \"../utils/cell.js\";\nimport { utf8read } from \"../utils/buffer.js\";\nimport { SSF_format, fmt_is_date } from \"../ssf/format.js\";\nimport { table_fmt } from \"../ssf/table.js\";\nimport { datenum, numdate } from \"../utils/date.js\";\nimport type { SST } from \"./shared-strings.js\";\nimport type { StylesData } from \"./styles.js\";\nimport type { Relationships } from \"../opc/relationships.js\";\n\nconst mergecregex = /<(?:\\w+:)?mergeCell ref=[\"'][A-Z0-9:]+['\"]\\s*[\\/]?>/g;\nconst hlinkregex = /<(?:\\w+:)?hyperlink [^<>]*>/gm;\nconst dimregex = /\"(\\w*:\\w*)\"/;\nconst colregex = /<(?:\\w+:)?col\\b[^<>]*[\\/]?>/g;\nconst afregex = /<(?:\\w:)?autoFilter[^>]*([\\/]|>([\\s\\S]*)<\\/(?:\\w:)?autoFilter)>/g;\nconst marginregex = /<(?:\\w+:)?pageMargins[^<>]*\\/>/g;\n\nfunction parse_ws_xml_dim(ws: WorkSheet, s: string): void {\n\tconst d = safe_decode_range(s);\n\tif (d.s.r <= d.e.r && d.s.c <= d.e.c && d.s.r >= 0 && d.s.c >= 0)\n\t\tws[\"!ref\"] = encode_range(d);\n}\n\nfunction parse_ws_xml_margins(tag: Record<string, any>): MarginInfo {\n\treturn {\n\t\tleft: parseFloat(tag.left) || 0.7,\n\t\tright: parseFloat(tag.right) || 0.7,\n\t\ttop: parseFloat(tag.top) || 0.75,\n\t\tbottom: parseFloat(tag.bottom) || 0.75,\n\t\theader: parseFloat(tag.header) || 0.3,\n\t\tfooter: parseFloat(tag.footer) || 0.3,\n\t};\n}\n\nfunction parse_ws_xml_autofilter(data: string): { ref: string } {\n\tconst tag = parsexmltag(data.match(/<[^>]*>/)?.[0] || \"\");\n\treturn { ref: tag.ref || \"\" };\n}\n\nfunction parse_ws_xml_cols(columns: ColInfo[], cols: string[]): void {\n\tfor (let i = 0; i < cols.length; ++i) {\n\t\tconst tag = parsexmltag(cols[i]);\n\t\tif (!tag.min || !tag.max) continue;\n\t\tconst min = parseInt(tag.min, 10) - 1;\n\t\tconst max = parseInt(tag.max, 10) - 1;\n\t\tconst width = tag.width ? parseFloat(tag.width) : undefined;\n\t\tconst hidden = tag.hidden === \"1\";\n\t\tfor (let j = min; j <= max; ++j) {\n\t\t\tif (!columns[j]) columns[j] = {} as ColInfo;\n\t\t\tif (width !== undefined) columns[j].width = width;\n\t\t\tif (hidden) columns[j].hidden = true;\n\t\t}\n\t}\n}\n\nfunction parse_ws_xml_hlinks(\n\ts: WorkSheet,\n\thlinks: string[],\n\trels: Relationships,\n): void {\n\tfor (let i = 0; i < hlinks.length; ++i) {\n\t\tconst tag = parsexmltag(hlinks[i]);\n\t\tif (!tag.ref) continue;\n\t\tconst rng = safe_decode_range(tag.ref);\n\t\tfor (let R = rng.s.r; R <= rng.e.r; ++R) {\n\t\t\tfor (let C = rng.s.c; C <= rng.e.c; ++C) {\n\t\t\t\tconst addr = encode_cell({ r: R, c: C });\n\t\t\t\tconst dense = s[\"!data\"] != null;\n\t\t\t\tlet cell: CellObject | undefined;\n\t\t\t\tif (dense) {\n\t\t\t\t\tif (!s[\"!data\"]![R]) s[\"!data\"]![R] = [];\n\t\t\t\t\tcell = s[\"!data\"]![R]![C];\n\t\t\t\t} else {\n\t\t\t\t\tcell = s[addr] as CellObject | undefined;\n\t\t\t\t}\n\t\t\t\tif (!cell) {\n\t\t\t\t\tcell = { t: \"z\", v: undefined } as any;\n\t\t\t\t\tif (dense) s[\"!data\"]![R]![C] = cell;\n\t\t\t\t\telse s[addr] = cell;\n\t\t\t\t}\n\t\t\t\tlet target = \"\";\n\t\t\t\tif (tag.id) {\n\t\t\t\t\tconst rel = rels[\"!id\"]?.[tag.id];\n\t\t\t\t\tif (rel) target = rel.Target;\n\t\t\t\t}\n\t\t\t\tif (tag.location) target += \"#\" + tag.location;\n\t\t\t\tcell!.l = { Target: target };\n\t\t\t\tif (tag.tooltip) cell!.l!.Tooltip = tag.tooltip;\n\t\t\t}\n\t\t}\n\t}\n}\n\n// Row tag regex\nconst rowregex = /<(?:\\w+:)?row\\b[^>]*>/g;\nconst cellregex = /<(?:\\w+:)?c\\b[^>]*(?:\\/>|>([\\s\\S]*?)<\\/(?:\\w+:)?c>)/g;\n\n/** Parse sheetData XML into worksheet */\nfunction parse_ws_xml_data(\n\tsdata: string,\n\ts: WorkSheet,\n\topts: any,\n\trefguess: Range,\n\t_themes: any,\n\tstyles: StylesData | undefined,\n\twb: any,\n): void {\n\tconst dense = s[\"!data\"] != null;\n\tconst date1904 = wb?.WBProps?.date1904;\n\n\t// Parse row by row\n\tconst rowMatches = sdata.match(rowregex) || [];\n\t// Split by row boundaries\n\tconst rows = sdata.split(/<\\/(?:\\w+:)?row>/);\n\n\tfor (let ri = 0; ri < rows.length; ++ri) {\n\t\tconst rowStr = rows[ri];\n\t\tif (!rowStr) continue;\n\n\t\t// Find row tag\n\t\tconst rowTagMatch = rowStr.match(/<(?:\\w+:)?row\\b[^>]*>/);\n\t\tif (!rowTagMatch) continue;\n\t\tconst rowTag = parsexmltag(rowTagMatch[0]);\n\t\tconst R = parseInt(rowTag.r, 10) - 1;\n\t\tif (isNaN(R)) continue;\n\n\t\t// Row properties\n\t\tif (rowTag.ht || rowTag.hidden) {\n\t\t\tif (!s[\"!rows\"]) s[\"!rows\"] = [];\n\t\t\tif (!s[\"!rows\"][R]) s[\"!rows\"][R] = {} as RowInfo;\n\t\t\tif (rowTag.ht) s[\"!rows\"][R].hpt = parseFloat(rowTag.ht);\n\t\t\tif (rowTag.hidden === \"1\") s[\"!rows\"][R].hidden = true;\n\t\t}\n\n\t\tif (opts.sheetRows && R >= opts.sheetRows) continue;\n\n\t\t// Parse cells in this row\n\t\tcellregex.lastIndex = 0;\n\t\tlet cellMatch;\n\t\twhile ((cellMatch = cellregex.exec(rowStr))) {\n\t\t\tconst cellTag = parsexmltag(cellMatch[0].match(/<(?:\\w+:)?c\\b[^>]*/)?.[0] + \">\" || \"\");\n\t\t\tconst ref = cellTag.r;\n\t\t\tif (!ref) continue;\n\n\t\t\t// Decode cell address\n\t\t\tlet C = 0;\n\t\t\tfor (let ci = 0; ci < ref.length; ++ci) {\n\t\t\t\tconst cc = ref.charCodeAt(ci);\n\t\t\t\tif (cc >= 65 && cc <= 90) C = 26 * C + (cc - 64);\n\t\t\t\telse break;\n\t\t\t}\n\t\t\tC -= 1;\n\n\t\t\t// Update refguess\n\t\t\tif (R < refguess.s.r) refguess.s.r = R;\n\t\t\tif (R > refguess.e.r) refguess.e.r = R;\n\t\t\tif (C < refguess.s.c) refguess.s.c = C;\n\t\t\tif (C > refguess.e.c) refguess.e.c = C;\n\n\t\t\tconst cellType = cellTag.t || \"n\";\n\t\t\tconst cellStyle = cellTag.s ? parseInt(cellTag.s, 10) : 0;\n\t\t\tconst cellValue = cellMatch[1] || \"\";\n\n\t\t\tlet cell: CellObject;\n\n\t\t\t// Extract value from <v> tag\n\t\t\tconst vMatch = cellValue.match(/<(?:\\w+:)?v>([\\s\\S]*?)<\\/(?:\\w+:)?v>/);\n\t\t\tconst fMatch = cellValue.match(/<(?:\\w+:)?f[^>]*>([\\s\\S]*?)<\\/(?:\\w+:)?f>/);\n\t\t\tconst isMatch = cellValue.match(/<(?:\\w+:)?is>([\\s\\S]*?)<\\/(?:\\w+:)?is>/);\n\n\t\t\tconst v = vMatch ? vMatch[1] : null;\n\n\t\t\tswitch (cellType) {\n\t\t\t\tcase \"s\": // shared string\n\t\t\t\t\tif (v !== null) {\n\t\t\t\t\t\tconst idx = parseInt(v, 10);\n\t\t\t\t\t\tcell = { t: \"s\", v: \"\" } as CellObject;\n\t\t\t\t\t\t// Will be resolved later with SST\n\t\t\t\t\t\t(cell as any)._sstIdx = idx;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell = { t: \"z\" } as CellObject;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"str\": // formula string\n\t\t\t\t\tcell = { t: \"s\", v: v ? unescapexml(v) : \"\" } as CellObject;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"inlineStr\":\n\t\t\t\t\tif (isMatch) {\n\t\t\t\t\t\tconst tMatch = isMatch[1].match(/<(?:\\w+:)?t[^>]*>([\\s\\S]*?)<\\/(?:\\w+:)?t>/);\n\t\t\t\t\t\tcell = { t: \"s\", v: tMatch ? unescapexml(tMatch[1]) : \"\" } as CellObject;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell = { t: \"s\", v: \"\" } as CellObject;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"b\": // boolean\n\t\t\t\t\tcell = { t: \"b\", v: v === \"1\" } as CellObject;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"e\": // error\n\t\t\t\t\tcell = { t: \"e\", v: v ? parseInt(v, 10) || 0 : 0 } as CellObject;\n\t\t\t\t\t(cell as any).w = v || \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"d\": // date\n\t\t\t\t\tif (v) {\n\t\t\t\t\t\tcell = { t: \"d\", v: new Date(v) } as CellObject;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell = { t: \"z\" } as CellObject;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault: // 'n' number\n\t\t\t\t\tif (v !== null) {\n\t\t\t\t\t\tcell = { t: \"n\", v: parseFloat(v) } as CellObject;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!opts.sheetStubs) continue;\n\t\t\t\t\t\tcell = { t: \"z\" } as CellObject;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// Style reference\n\t\t\tif (cellStyle > 0 && styles) {\n\t\t\t\tconst xf = styles.CellXf[cellStyle];\n\t\t\t\tif (xf) {\n\t\t\t\t\tcell.XF = { numFmtId: xf.numFmtId };\n\t\t\t\t\tif (opts.cellNF) {\n\t\t\t\t\t\tconst nf = styles.NumberFmt[xf.numFmtId] || table_fmt[xf.numFmtId];\n\t\t\t\t\t\tif (nf) cell.z = nf;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Formula\n\t\t\tif (fMatch && opts.cellFormula !== false) {\n\t\t\t\tcell.f = unescapexml(fMatch[1]);\n\t\t\t\tconst fTag = parsexmltag(cellValue.match(/<(?:\\w+:)?f[^>]*/)?.[0] + \">\" || \"\");\n\t\t\t\tif (fTag.t === \"shared\" && fTag.si != null) {\n\t\t\t\t\t// Shared formula\n\t\t\t\t}\n\t\t\t\tif (fTag.t === \"array\" && fTag.ref) {\n\t\t\t\t\tcell.F = fTag.ref;\n\t\t\t\t\tcell.D = fTag.dt === \"1\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Number formatting / cell text\n\t\t\tif (opts.cellText !== false) {\n\t\t\t\tif (cell.t === \"n\") {\n\t\t\t\t\tconst nfmt = cell.z || (cell.XF && cell.XF.numFmtId != null && styles?.NumberFmt[cell.XF.numFmtId]) || table_fmt[(cell.XF && cell.XF.numFmtId) || 0];\n\t\t\t\t\tif (nfmt) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tcell.w = SSF_format(nfmt, cell.v as number, { date1904 });\n\t\t\t\t\t\t} catch {}\n\t\t\t\t\t}\n\t\t\t\t\t// Handle dates\n\t\t\t\t\tif (opts.cellDates && cell.XF) {\n\t\t\t\t\t\tconst fmtStr = nfmt || table_fmt[cell.XF.numFmtId || 0] || \"\";\n\t\t\t\t\t\tif (typeof fmtStr === \"string\" && fmt_is_date(fmtStr) && typeof cell.v === \"number\") {\n\t\t\t\t\t\t\tcell.t = \"d\";\n\t\t\t\t\t\t\tcell.v = numdate(cell.v, date1904);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (dense) {\n\t\t\t\tif (!s[\"!data\"]![R]) s[\"!data\"]![R] = [];\n\t\t\t\ts[\"!data\"]![R]![C] = cell;\n\t\t\t} else {\n\t\t\t\ts[ref] = cell;\n\t\t\t}\n\t\t}\n\t}\n}\n\n/** Resolve SST references in a worksheet */\nexport function resolve_sst(\n\ts: WorkSheet,\n\tsst: SST,\n\topts: any,\n): void {\n\tconst dense = s[\"!data\"] != null;\n\tif (dense) {\n\t\tconst data = s[\"!data\"]!;\n\t\tfor (let R = 0; R < data.length; ++R) {\n\t\t\tif (!data[R]) continue;\n\t\t\tfor (let C = 0; C < data[R]!.length; ++C) {\n\t\t\t\tconst cell = data[R]![C];\n\t\t\t\tif (!cell || (cell as any)._sstIdx === undefined) continue;\n\t\t\t\tconst idx = (cell as any)._sstIdx;\n\t\t\t\tdelete (cell as any)._sstIdx;\n\t\t\t\tif (sst[idx]) {\n\t\t\t\t\tcell.v = sst[idx].t;\n\t\t\t\t\tif (opts.cellHTML !== false && sst[idx].h) cell.h = sst[idx].h;\n\t\t\t\t\tif (sst[idx].r) cell.r = sst[idx].r;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} else {\n\t\tfor (const ref of Object.keys(s)) {\n\t\t\tif (ref.charAt(0) === \"!\") continue;\n\t\t\tconst cell = s[ref] as CellObject;\n\t\t\tif (!cell || (cell as any)._sstIdx === undefined) continue;\n\t\t\tconst idx = (cell as any)._sstIdx;\n\t\t\tdelete (cell as any)._sstIdx;\n\t\t\tif (sst[idx]) {\n\t\t\t\tcell.v = sst[idx].t;\n\t\t\t\tif (opts.cellHTML !== false && sst[idx].h) cell.h = sst[idx].h;\n\t\t\t\tif (sst[idx].r) cell.r = sst[idx].r;\n\t\t\t}\n\t\t}\n\t}\n}\n\n/** Parse a worksheet XML */\nexport function parse_ws_xml(\n\tdata: string,\n\topts?: any,\n\t_idx?: number,\n\trels?: Relationships,\n\twb?: any,\n\t_themes?: any,\n\tstyles?: StylesData,\n): WorkSheet {\n\tif (!data) return {} as WorkSheet;\n\tif (!opts) opts = {};\n\tif (!rels) rels = { \"!id\": {} } as any;\n\n\tconst s: WorkSheet = opts.dense ? { \"!data\": [] } : ({} as any);\n\tconst refguess: Range = { s: { r: 2000000, c: 2000000 }, e: { r: 0, c: 0 } };\n\n\t// Split at sheetData\n\tlet data1 = \"\";\n\tlet data2 = \"\";\n\tconst sdMatch = data.match(/<(?:\\w+:)?sheetData[^>]*>([\\s\\S]*?)<\\/(?:\\w+:)?sheetData>/);\n\tif (sdMatch) {\n\t\tdata1 = data.slice(0, sdMatch.index!);\n\t\tdata2 = data.slice(sdMatch.index! + sdMatch[0].length);\n\t} else {\n\t\tdata1 = data2 = data;\n\t}\n\n\t// Dimension\n\tconst ridx = (data1.match(/<(?:\\w*:)?dimension/) || ({ index: -1 } as any)).index;\n\tif (ridx > 0) {\n\t\tconst ref = data1.slice(ridx, ridx + 50).match(dimregex);\n\t\tif (ref && !opts.nodim) parse_ws_xml_dim(s, ref[1]);\n\t}\n\n\t// Columns\n\tconst columns: ColInfo[] = [];\n\tif (opts.cellStyles) {\n\t\tconst cols = data1.match(colregex);\n\t\tif (cols) parse_ws_xml_cols(columns, cols);\n\t}\n\n\t// SheetData\n\tif (sdMatch) parse_ws_xml_data(sdMatch[1], s, opts, refguess, _themes, styles, wb);\n\n\t// AutoFilter\n\tconst afilter = data2.match(afregex);\n\tif (afilter) s[\"!autofilter\"] = parse_ws_xml_autofilter(afilter[0]);\n\n\t// Merges\n\tconst merges: Range[] = [];\n\tconst _merge = data2.match(mergecregex);\n\tif (_merge) {\n\t\tfor (let i = 0; i < _merge.length; ++i)\n\t\t\tmerges[i] = safe_decode_range(_merge[i].slice(_merge[i].indexOf(\"=\") + 2));\n\t}\n\n\t// Hyperlinks\n\tconst hlink = data2.match(hlinkregex);\n\tif (hlink) parse_ws_xml_hlinks(s, hlink, rels!);\n\n\t// Margins\n\tconst margins = data2.match(marginregex);\n\tif (margins) s[\"!margins\"] = parse_ws_xml_margins(parsexmltag(margins[0]));\n\n\t// Legacy drawing\n\tconst legm = data2.match(/legacyDrawing r:id=\"(.*?)\"/);\n\tif (legm) (s as any)[\"!legrel\"] = legm[1];\n\n\tif (opts.nodim) {\n\t\trefguess.s.c = refguess.s.r = 0;\n\t}\n\tif (!s[\"!ref\"] && refguess.e.c >= refguess.s.c && refguess.e.r >= refguess.s.r) {\n\t\ts[\"!ref\"] = encode_range(refguess);\n\t}\n\tif (opts.sheetRows > 0 && s[\"!ref\"]) {\n\t\tconst tmpref = safe_decode_range(s[\"!ref\"]);\n\t\tif (opts.sheetRows <= tmpref.e.r) {\n\t\t\ttmpref.e.r = opts.sheetRows - 1;\n\t\t\tif (tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\n\t\t\tif (tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\n\t\t\tif (tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\n\t\t\tif (tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\n\t\t\t(s as any)[\"!fullref\"] = s[\"!ref\"];\n\t\t\ts[\"!ref\"] = encode_range(tmpref);\n\t\t}\n\t}\n\tif (columns.length > 0) s[\"!cols\"] = columns;\n\tif (merges.length > 0) s[\"!merges\"] = merges;\n\n\treturn s;\n}\n\n/** Write merges XML */\nfunction write_ws_xml_merges(merges: Range[]): string {\n\tif (merges.length === 0) return \"\";\n\tconst o = ['<mergeCells count=\"' + merges.length + '\">'];\n\tfor (let i = 0; i < merges.length; ++i)\n\t\to.push('<mergeCell ref=\"' + encode_range(merges[i]) + '\"/>');\n\to.push(\"</mergeCells>\");\n\treturn o.join(\"\");\n}\n\n/** Write a worksheet XML */\nexport function write_ws_xml(\n\tws: WorkSheet,\n\topts: any,\n\t_idx: number,\n\t_rels: Relationships,\n\t_wb: any,\n): string {\n\tconst o: string[] = [XML_HEADER];\n\to.push(\n\t\twritextag(\"worksheet\", null, {\n\t\t\txmlns: XMLNS_main[0],\n\t\t\t\"xmlns:r\": \"http://schemas.openxmlformats.org/officeDocument/2006/relationships\",\n\t\t}),\n\t);\n\n\tconst ref = ws[\"!ref\"] || \"A1\";\n\to.push('<dimension ref=\"' + ref + '\"/>');\n\n\to.push(\"<sheetViews><sheetView workbookViewId=\\\"0\\\"\");\n\t// Only add tabSelected for first sheet\n\tif (_idx === 0) o.push(' tabSelected=\"1\"');\n\to.push(\"/></sheetViews>\");\n\n\to.push('<sheetFormatPr defaultRowHeight=\"15\"/>');\n\n\t// Columns\n\tif (ws[\"!cols\"]) {\n\t\to.push(\"<cols>\");\n\t\tfor (let i = 0; i < ws[\"!cols\"].length; ++i) {\n\t\t\tif (!ws[\"!cols\"][i]) continue;\n\t\t\tconst col = ws[\"!cols\"][i];\n\t\t\tconst attrs: Record<string, string> = {\n\t\t\t\tmin: String(i + 1),\n\t\t\t\tmax: String(i + 1),\n\t\t\t};\n\t\t\tif (col.width) attrs.width = String(col.width);\n\t\t\telse attrs.width = \"9.140625\";\n\t\t\tif (col.hidden) attrs.hidden = \"1\";\n\t\t\tattrs.customWidth = \"1\";\n\t\t\to.push(writextag(\"col\", null, attrs));\n\t\t}\n\t\to.push(\"</cols>\");\n\t}\n\n\to.push(\"<sheetData>\");\n\n\tconst dense = ws[\"!data\"] != null;\n\tconst range = safe_decode_range(ref);\n\n\tfor (let R = range.s.r; R <= range.e.r; ++R) {\n\t\tconst row_cells: string[] = [];\n\t\tfor (let C = range.s.c; C <= range.e.c; ++C) {\n\t\t\tlet cell: CellObject | undefined;\n\t\t\tif (dense) {\n\t\t\t\tcell = ws[\"!data\"]?.[R]?.[C];\n\t\t\t} else {\n\t\t\t\tconst addr = encode_cell({ r: R, c: C });\n\t\t\t\tcell = ws[addr] as CellObject | undefined;\n\t\t\t}\n\t\t\tif (!cell || cell.t === \"z\") continue;\n\n\t\t\tconst addr = encode_cell({ r: R, c: C });\n\t\t\tlet v = \"\";\n\t\t\tlet t = \"\";\n\n\t\t\tswitch (cell.t) {\n\t\t\t\tcase \"b\":\n\t\t\t\t\tv = cell.v ? \"1\" : \"0\";\n\t\t\t\t\tt = \"b\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"n\":\n\t\t\t\t\tv = String(cell.v);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"e\":\n\t\t\t\t\tv = String(cell.v);\n\t\t\t\t\tt = \"e\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"d\":\n\t\t\t\t\tif (opts.cellDates) {\n\t\t\t\t\t\tv = (cell.v as Date).toISOString();\n\t\t\t\t\t\tt = \"d\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tv = String(datenum(cell.v as Date));\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"s\":\n\t\t\t\t\tv = escapexml(String(cell.v));\n\t\t\t\t\tt = \"str\";\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tlet cellXml = '<c r=\"' + addr + '\"';\n\t\t\tif (t) cellXml += ' t=\"' + t + '\"';\n\t\t\tcellXml += \">\";\n\t\t\tif (cell.f) {\n\t\t\t\tcellXml += \"<f\";\n\t\t\t\tif (cell.F) cellXml += ' ref=\"' + cell.F + '\" t=\"array\"';\n\t\t\t\tcellXml += \">\" + escapexml(cell.f) + \"</f>\";\n\t\t\t}\n\t\t\tif (v !== \"\") cellXml += \"<v>\" + v + \"</v>\";\n\t\t\tcellXml += \"</c>\";\n\t\t\trow_cells.push(cellXml);\n\t\t}\n\t\tif (row_cells.length > 0) {\n\t\t\tlet rowTag = '<row r=\"' + (R + 1) + '\"';\n\t\t\tif (ws[\"!rows\"]?.[R]) {\n\t\t\t\tif (ws[\"!rows\"][R].hpt) rowTag += ' ht=\"' + ws[\"!rows\"][R].hpt + '\" customHeight=\"1\"';\n\t\t\t\tif (ws[\"!rows\"][R].hidden) rowTag += ' hidden=\"1\"';\n\t\t\t}\n\t\t\trowTag += \">\";\n\t\t\to.push(rowTag);\n\t\t\to.push(row_cells.join(\"\"));\n\t\t\to.push(\"</row>\");\n\t\t}\n\t}\n\n\to.push(\"</sheetData>\");\n\n\t// Merges\n\tif (ws[\"!merges\"] && ws[\"!merges\"].length > 0) {\n\t\to.push(write_ws_xml_merges(ws[\"!merges\"]));\n\t}\n\n\t// AutoFilter\n\tif (ws[\"!autofilter\"]) {\n\t\to.push('<autoFilter ref=\"' + ws[\"!autofilter\"].ref + '\"/>');\n\t}\n\n\t// Margins\n\tif (ws[\"!margins\"]) {\n\t\tconst m = ws[\"!margins\"];\n\t\to.push(\n\t\t\twritextag(\"pageMargins\", null, {\n\t\t\t\tleft: String(m.left || 0.7),\n\t\t\t\tright: String(m.right || 0.7),\n\t\t\t\ttop: String(m.top || 0.75),\n\t\t\t\tbottom: String(m.bottom || 0.75),\n\t\t\t\theader: String(m.header || 0.3),\n\t\t\t\tfooter: String(m.footer || 0.3),\n\t\t\t}),\n\t\t);\n\t}\n\n\to.push(\"</worksheet>\");\n\to[1] = o[1].replace(\"/>\", \">\");\n\treturn o.join(\"\");\n}\n","import { parsexmltag, tagregex, XML_HEADER, strip_ns } from \"../xml/parser.js\";\nimport { unescapexml, escapexml } from \"../xml/escape.js\";\nimport { writetag, writextag } from \"../xml/writer.js\";\nimport { XMLNS_main, XMLNS } from \"../xml/namespaces.js\";\nimport { decode_cell, encode_cell, encode_range, safe_decode_range } from \"../utils/cell.js\";\nimport { str_match_xml_ns } from \"../utils/helpers.js\";\nimport type { WorkSheet } from \"../types.js\";\n\nexport interface RawComment {\n\tref: string;\n\tauthor: string;\n\tt: string;\n\tr?: string;\n\th?: string;\n\tguid?: string;\n\tT?: number;\n}\n\n/** Insert parsed comments into a worksheet */\nexport function sheet_insert_comments(\n\tsheet: WorkSheet,\n\tcomments: RawComment[],\n\tthreaded: boolean,\n\tpeople?: { name: string; id: string }[],\n): void {\n\tconst dense = (sheet as any)[\"!data\"] != null;\n\tfor (const comment of comments) {\n\t\tconst r = decode_cell(comment.ref);\n\t\tif (r.r < 0 || r.c < 0) continue;\n\t\tlet cell: any;\n\t\tif (dense) {\n\t\t\tif (!(sheet as any)[\"!data\"][r.r]) (sheet as any)[\"!data\"][r.r] = [];\n\t\t\tcell = (sheet as any)[\"!data\"][r.r][r.c];\n\t\t} else {\n\t\t\tcell = (sheet as any)[comment.ref];\n\t\t}\n\n\t\tif (!cell) {\n\t\t\tcell = { t: \"z\" };\n\t\t\tif (dense) (sheet as any)[\"!data\"][r.r][r.c] = cell;\n\t\t\telse (sheet as any)[comment.ref] = cell;\n\t\t\tconst range = safe_decode_range(sheet[\"!ref\"] || \"BDWGO1000001:A1\");\n\t\t\tif (range.s.r > r.r) range.s.r = r.r;\n\t\t\tif (range.e.r < r.r) range.e.r = r.r;\n\t\t\tif (range.s.c > r.c) range.s.c = r.c;\n\t\t\tif (range.e.c < r.c) range.e.c = r.c;\n\t\t\tsheet[\"!ref\"] = encode_range(range);\n\t\t}\n\n\t\tif (!cell.c) cell.c = [];\n\t\tconst o: any = { a: comment.author, t: comment.t, r: comment.r, T: threaded };\n\t\tif (comment.h) o.h = comment.h;\n\n\t\t/* threaded comments always override */\n\t\tfor (let i = cell.c.length - 1; i >= 0; --i) {\n\t\t\tif (!threaded && cell.c[i].T) return;\n\t\t\tif (threaded && !cell.c[i].T) cell.c.splice(i, 1);\n\t\t}\n\t\tif (threaded && people) {\n\t\t\tfor (let i = 0; i < people.length; ++i) {\n\t\t\t\tif (o.a === people[i].id) {\n\t\t\t\t\to.a = people[i].name || o.a;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcell.c.push(o);\n\t}\n}\n\n/** Parse the si (string item) for comment text - simplified inline version */\nfunction parse_si_simple(x: string): { t: string; r: string; h: string } {\n\tif (!x) return { t: \"\", r: \"\", h: \"\" };\n\tconst tMatch = x.match(/<(?:\\w+:)?t[^>]*>([^<]*)<\\/(?:\\w+:)?t>/);\n\tconst t = tMatch ? unescapexml(tMatch[1]) : \"\";\n\treturn { t, r: x, h: t };\n}\n\n/** Parse comments XML (18.7) */\nexport function parse_comments_xml(data: string, opts?: any): RawComment[] {\n\tif (data.match(/<(?:\\w+:)?comments\\s*\\/>/)) return [];\n\tconst authors: string[] = [];\n\tconst commentList: RawComment[] = [];\n\n\tconst authtag = str_match_xml_ns(data, \"authors\");\n\tif (authtag) {\n\t\tauthtag\n\t\t\t.split(/<\\/\\w*:?author>/)\n\t\t\t.forEach((x) => {\n\t\t\t\tif (x === \"\" || x.trim() === \"\") return;\n\t\t\t\tconst a = x.match(/<(?:\\w+:)?author[^<>]*>(.*)/);\n\t\t\t\tif (a) authors.push(a[1]);\n\t\t\t});\n\t}\n\n\tconst cmnttag = str_match_xml_ns(data, \"commentList\");\n\tif (cmnttag) {\n\t\tcmnttag\n\t\t\t.split(/<\\/\\w*:?comment>/)\n\t\t\t.forEach((x) => {\n\t\t\t\tif (x === \"\" || x.trim() === \"\") return;\n\t\t\t\tconst cm = x.match(/<(?:\\w+:)?comment[^<>]*>/);\n\t\t\t\tif (!cm) return;\n\t\t\t\tconst y = parsexmltag(cm[0]);\n\t\t\t\tconst comment: RawComment = {\n\t\t\t\t\tauthor: (y.authorId && authors[y.authorId]) || \"sheetjsghost\",\n\t\t\t\t\tref: y.ref,\n\t\t\t\t\tguid: y.guid,\n\t\t\t\t\tt: \"\",\n\t\t\t\t};\n\t\t\t\tconst cell = decode_cell(y.ref);\n\t\t\t\tif (opts && opts.sheetRows && opts.sheetRows <= cell.r) return;\n\t\t\t\tconst textMatch = str_match_xml_ns(x, \"text\");\n\t\t\t\tconst rt = textMatch ? parse_si_simple(textMatch) : { r: \"\", t: \"\", h: \"\" };\n\t\t\t\tcomment.r = rt.r;\n\t\t\t\tif (rt.r === \"<t></t>\") {\n\t\t\t\t\trt.t = \"\";\n\t\t\t\t\trt.h = \"\";\n\t\t\t\t}\n\t\t\t\tcomment.t = (rt.t || \"\").replace(/\\r\\n/g, \"\\n\").replace(/\\r/g, \"\\n\");\n\t\t\t\tif (opts && opts.cellHTML) comment.h = rt.h;\n\t\t\t\tcommentList.push(comment);\n\t\t\t});\n\t}\n\treturn commentList;\n}\n\n/** Write comments XML */\nexport function write_comments_xml(data: [string, any[]][]): string {\n\tconst o: string[] = [XML_HEADER, writextag(\"comments\", null, { xmlns: XMLNS_main[0] })];\n\n\tconst iauthor: string[] = [];\n\to.push(\"<authors>\");\n\tdata.forEach((x) => {\n\t\tx[1].forEach((w: any) => {\n\t\t\tconst a = escapexml(w.a);\n\t\t\tif (iauthor.indexOf(a) === -1) {\n\t\t\t\tiauthor.push(a);\n\t\t\t\to.push(\"<author>\" + a + \"</author>\");\n\t\t\t}\n\t\t\tif (w.T && w.ID && iauthor.indexOf(\"tc=\" + w.ID) === -1) {\n\t\t\t\tiauthor.push(\"tc=\" + w.ID);\n\t\t\t\to.push(\"<author>\" + \"tc=\" + w.ID + \"</author>\");\n\t\t\t}\n\t\t});\n\t});\n\tif (iauthor.length === 0) {\n\t\tiauthor.push(\"SheetJ5\");\n\t\to.push(\"<author>SheetJ5</author>\");\n\t}\n\to.push(\"</authors>\");\n\to.push(\"<commentList>\");\n\n\tdata.forEach((d) => {\n\t\tlet lastauthor = 0;\n\t\tconst ts: string[] = [];\n\t\tlet tcnt = 0;\n\t\tif (d[1][0] && d[1][0].T && d[1][0].ID) lastauthor = iauthor.indexOf(\"tc=\" + d[1][0].ID);\n\t\td[1].forEach((c: any) => {\n\t\t\tif (c.a) lastauthor = iauthor.indexOf(escapexml(c.a));\n\t\t\tif (c.T) ++tcnt;\n\t\t\tts.push(c.t == null ? \"\" : escapexml(c.t));\n\t\t});\n\t\tif (tcnt === 0) {\n\t\t\td[1].forEach((c: any) => {\n\t\t\t\to.push(\n\t\t\t\t\t'<comment ref=\"' +\n\t\t\t\t\t\td[0] +\n\t\t\t\t\t\t'\" authorId=\"' +\n\t\t\t\t\t\tiauthor.indexOf(escapexml(c.a)) +\n\t\t\t\t\t\t'\"><text>',\n\t\t\t\t);\n\t\t\t\to.push(writetag(\"t\", c.t == null ? \"\" : escapexml(c.t)));\n\t\t\t\to.push(\"</text></comment>\");\n\t\t\t});\n\t\t} else {\n\t\t\tif (d[1][0] && d[1][0].T && d[1][0].ID)\n\t\t\t\tlastauthor = iauthor.indexOf(\"tc=\" + d[1][0].ID);\n\t\t\to.push('<comment ref=\"' + d[0] + '\" authorId=\"' + lastauthor + '\"><text>');\n\t\t\tlet t = \"Comment:\\n    \" + ts[0] + \"\\n\";\n\t\t\tfor (let i = 1; i < ts.length; ++i) t += \"Reply:\\n    \" + ts[i] + \"\\n\";\n\t\t\to.push(writetag(\"t\", escapexml(t)));\n\t\t\to.push(\"</text></comment>\");\n\t\t}\n\t});\n\to.push(\"</commentList>\");\n\tif (o.length > 2) {\n\t\to.push(\"</comments>\");\n\t\to[1] = o[1].replace(\"/>\", \">\");\n\t}\n\treturn o.join(\"\");\n}\n\n/** Parse threaded comments XML [MS-XLSX] 2.1.17 */\nexport function parse_tcmnt_xml(data: string, opts?: any): RawComment[] {\n\tconst out: RawComment[] = [];\n\tlet pass = false;\n\tlet comment: any = {};\n\tlet tidx = 0;\n\n\tdata.replace(tagregex, function xml_tcmnt(x: string, idx: number): string {\n\t\tconst y: any = parsexmltag(x);\n\t\tswitch (strip_ns(y[0])) {\n\t\t\tcase \"<?xml\":\n\t\t\t\tbreak;\n\t\t\tcase \"<ThreadedComments\":\n\t\t\tcase \"</ThreadedComments>\":\n\t\t\t\tbreak;\n\t\t\tcase \"<threadedComment\":\n\t\t\t\tcomment = { author: y.personId, guid: y.id, ref: y.ref, T: 1 };\n\t\t\t\tbreak;\n\t\t\tcase \"</threadedComment>\":\n\t\t\t\tif (comment.t != null) out.push(comment);\n\t\t\t\tbreak;\n\t\t\tcase \"<text>\":\n\t\t\tcase \"<text\":\n\t\t\t\ttidx = idx + x.length;\n\t\t\t\tbreak;\n\t\t\tcase \"</text>\":\n\t\t\t\tcomment.t = data\n\t\t\t\t\t.slice(tidx, idx)\n\t\t\t\t\t.replace(/\\r\\n/g, \"\\n\")\n\t\t\t\t\t.replace(/\\r/g, \"\\n\");\n\t\t\t\tbreak;\n\t\t\tcase \"<mentions\":\n\t\t\tcase \"<mentions>\":\n\t\t\t\tpass = true;\n\t\t\t\tbreak;\n\t\t\tcase \"</mentions>\":\n\t\t\t\tpass = false;\n\t\t\t\tbreak;\n\t\t\tcase \"<extLst\":\n\t\t\tcase \"<extLst>\":\n\t\t\tcase \"</extLst>\":\n\t\t\tcase \"<extLst/>\":\n\t\t\t\tbreak;\n\t\t\tcase \"<ext\":\n\t\t\t\tpass = true;\n\t\t\t\tbreak;\n\t\t\tcase \"</ext>\":\n\t\t\t\tpass = false;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\treturn x;\n\t});\n\treturn out;\n}\n\n/** Write threaded comments XML */\nexport function write_tcmnt_xml(\n\tcomments: [string, any[]][],\n\tpeople: string[],\n\topts: { tcid: number },\n): string {\n\tconst o: string[] = [\n\t\tXML_HEADER,\n\t\twritextag(\"ThreadedComments\", null, { xmlns: XMLNS.TCMNT }).replace(/[/]>/, \">\"),\n\t];\n\tcomments.forEach((carr) => {\n\t\tlet rootid = \"\";\n\t\t(carr[1] || []).forEach((c: any, idx: number) => {\n\t\t\tif (!c.T) {\n\t\t\t\tdelete c.ID;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (c.a && people.indexOf(c.a) === -1) people.push(c.a);\n\t\t\tconst tcopts: any = {\n\t\t\t\tref: carr[0],\n\t\t\t\tid:\n\t\t\t\t\t\"{54EE7951-7262-4200-6969-\" +\n\t\t\t\t\t(\"000000000000\" + opts.tcid++).slice(-12) +\n\t\t\t\t\t\"}\",\n\t\t\t};\n\t\t\tif (idx === 0) rootid = tcopts.id;\n\t\t\telse tcopts.parentId = rootid;\n\t\t\tc.ID = tcopts.id;\n\t\t\tif (c.a)\n\t\t\t\ttcopts.personId =\n\t\t\t\t\t\"{54EE7950-7262-4200-6969-\" +\n\t\t\t\t\t(\"000000000000\" + people.indexOf(c.a)).slice(-12) +\n\t\t\t\t\t\"}\";\n\t\t\to.push(writextag(\"threadedComment\", writetag(\"text\", c.t || \"\"), tcopts));\n\t\t});\n\t});\n\to.push(\"</ThreadedComments>\");\n\treturn o.join(\"\");\n}\n\n/** Parse people XML [MS-XLSX] 2.1.18 */\nexport function parse_people_xml(data: string): { name: string; id: string }[] {\n\tconst out: { name: string; id: string }[] = [];\n\tlet pass = false;\n\tdata.replace(tagregex, function xml_people(x: string): string {\n\t\tconst y: any = parsexmltag(x);\n\t\tswitch (strip_ns(y[0])) {\n\t\t\tcase \"<?xml\":\n\t\t\t\tbreak;\n\t\t\tcase \"<personList\":\n\t\t\tcase \"</personList>\":\n\t\t\t\tbreak;\n\t\t\tcase \"<person\":\n\t\t\t\tout.push({ name: y.displayname, id: y.id });\n\t\t\t\tbreak;\n\t\t\tcase \"</person>\":\n\t\t\t\tbreak;\n\t\t\tcase \"<extLst\":\n\t\t\tcase \"<extLst>\":\n\t\t\tcase \"</extLst>\":\n\t\t\tcase \"<extLst/>\":\n\t\t\t\tbreak;\n\t\t\tcase \"<ext\":\n\t\t\t\tpass = true;\n\t\t\t\tbreak;\n\t\t\tcase \"</ext>\":\n\t\t\t\tpass = false;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\treturn x;\n\t});\n\treturn out;\n}\n\n/** Write people XML */\nexport function write_people_xml(people: string[]): string {\n\tconst o: string[] = [\n\t\tXML_HEADER,\n\t\twritextag(\"personList\", null, {\n\t\t\txmlns: XMLNS.TCMNT,\n\t\t\t\"xmlns:x\": XMLNS_main[0],\n\t\t}).replace(/[/]>/, \">\"),\n\t];\n\tpeople.forEach((person, idx) => {\n\t\to.push(\n\t\t\twritextag(\"person\", null, {\n\t\t\t\tdisplayName: person,\n\t\t\t\tid:\n\t\t\t\t\t\"{54EE7950-7262-4200-6969-\" +\n\t\t\t\t\t(\"000000000000\" + idx).slice(-12) +\n\t\t\t\t\t\"}\",\n\t\t\t\tuserId: person,\n\t\t\t\tproviderId: \"None\",\n\t\t\t}),\n\t\t);\n\t});\n\to.push(\"</personList>\");\n\treturn o.join(\"\");\n}\n","import { parsexmltag, tagregex, strip_ns } from \"../xml/parser.js\";\nimport { writetag, writextag } from \"../xml/writer.js\";\nimport { decode_cell, encode_cell } from \"../utils/cell.js\";\nimport { str_match_xml_ns_g } from \"../utils/helpers.js\";\nimport { keys } from \"../utils/helpers.js\";\nimport type { WorkSheet } from \"../types.js\";\n\nconst XLMLNS: Record<string, string> = {\n\tv: \"urn:schemas-microsoft-com:vml\",\n\to: \"urn:schemas-microsoft-com:office:office\",\n\tx: \"urn:schemas-microsoft-com:office:excel\",\n\tmv: \"http://macVmlSchemaUri\",\n};\n\n/** Parse VML drawings (comment shapes) */\nexport function parse_vml(data: string, sheet: WorkSheet, comments: any[]): void {\n\tlet cidx = 0;\n\t(str_match_xml_ns_g(data, \"(?:shape|rect)\") || []).forEach((m) => {\n\t\tlet type = \"\";\n\t\tlet hidden = true;\n\t\tlet aidx = -1;\n\t\tlet R = -1,\n\t\t\tC = -1;\n\n\t\tm.replace(tagregex, function (x: string, idx: number): string {\n\t\t\tconst y = parsexmltag(x);\n\t\t\tswitch (strip_ns(y[0])) {\n\t\t\t\tcase \"<ClientData\":\n\t\t\t\t\tif (y.ObjectType) type = y.ObjectType;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"<Visible\":\n\t\t\t\tcase \"<Visible/>\":\n\t\t\t\t\thidden = false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"<Row\":\n\t\t\t\tcase \"<Row>\":\n\t\t\t\t\taidx = idx + x.length;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"</Row>\":\n\t\t\t\t\tR = +m.slice(aidx, idx).trim();\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"<Column\":\n\t\t\t\tcase \"<Column>\":\n\t\t\t\t\taidx = idx + x.length;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"</Column>\":\n\t\t\t\t\tC = +m.slice(aidx, idx).trim();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn \"\";\n\t\t});\n\n\t\tswitch (type) {\n\t\t\tcase \"Note\": {\n\t\t\t\tconst ref = R >= 0 && C >= 0 ? encode_cell({ r: R, c: C }) : comments[cidx]?.ref;\n\t\t\t\tconst dense = (sheet as any)[\"!data\"] != null;\n\t\t\t\tlet cell: any;\n\t\t\t\tif (dense) {\n\t\t\t\t\tconst rows = (sheet as any)[\"!data\"];\n\t\t\t\t\tcell = rows?.[R]?.[C];\n\t\t\t\t} else {\n\t\t\t\t\tcell = (sheet as any)[ref];\n\t\t\t\t}\n\t\t\t\tif (cell && cell.c) {\n\t\t\t\t\tcell.c.hidden = hidden;\n\t\t\t\t}\n\t\t\t\t++cidx;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction wxt_helper(h: Record<string, string>): string {\n\treturn keys(h)\n\t\t.map((k) => \" \" + k + '=\"' + h[k] + '\"')\n\t\t.join(\"\");\n}\n\nfunction write_vml_comment(x: [string, any], _shapeid: number): string {\n\tconst c = decode_cell(x[0]);\n\tconst fillopts: any = { color2: \"#BEFF82\", type: \"gradient\" };\n\tif (fillopts.type === \"gradient\") fillopts.angle = \"-180\";\n\tconst fillparm =\n\t\tfillopts.type === \"gradient\"\n\t\t\t? writextag(\"o:fill\", null, { type: \"gradientUnscaled\", \"v:ext\": \"view\" })\n\t\t\t: null;\n\tconst fillxml = writextag(\"v:fill\", fillparm, fillopts);\n\tconst shadata: any = { on: \"t\", obscured: \"t\" };\n\n\treturn [\n\t\t\"<v:shape\" +\n\t\t\twxt_helper({\n\t\t\t\tid: \"_x0000_s\" + _shapeid,\n\t\t\t\ttype: \"#_x0000_t202\",\n\t\t\t\tstyle:\n\t\t\t\t\t\"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10\" +\n\t\t\t\t\t(x[1].hidden ? \";visibility:hidden\" : \"\"),\n\t\t\t\tfillcolor: \"#ECFAD4\",\n\t\t\t\tstrokecolor: \"#edeaa1\",\n\t\t\t}) +\n\t\t\t\">\",\n\t\tfillxml,\n\t\twritextag(\"v:shadow\", null, shadata),\n\t\twritextag(\"v:path\", null, { \"o:connecttype\": \"none\" }),\n\t\t'<v:textbox><div style=\"text-align:left\"></div></v:textbox>',\n\t\t'<x:ClientData ObjectType=\"Note\">',\n\t\t\"<x:MoveWithCells/>\",\n\t\t\"<x:SizeWithCells/>\",\n\t\twritetag(\n\t\t\t\"x:Anchor\",\n\t\t\t[c.c + 1, 0, c.r + 1, 0, c.c + 3, 20, c.r + 5, 20].join(\",\"),\n\t\t),\n\t\twritetag(\"x:AutoFill\", \"False\"),\n\t\twritetag(\"x:Row\", String(c.r)),\n\t\twritetag(\"x:Column\", String(c.c)),\n\t\tx[1].hidden ? \"\" : \"<x:Visible/>\",\n\t\t\"</x:ClientData>\",\n\t\t\"</v:shape>\",\n\t].join(\"\");\n}\n\n/** Write VML for comment boxes */\nexport function write_vml(rId: number, comments: [string, any][]): string {\n\tconst csize = [21600, 21600];\n\tconst bbox = [\"m0,0l0\", csize[1], csize[0], csize[1], csize[0], \"0xe\"].join(\",\");\n\tconst o: string[] = [\n\t\twritextag(\"xml\", null, {\n\t\t\t\"xmlns:v\": XLMLNS.v,\n\t\t\t\"xmlns:o\": XLMLNS.o,\n\t\t\t\"xmlns:x\": XLMLNS.x,\n\t\t\t\"xmlns:mv\": XLMLNS.mv,\n\t\t}).replace(/\\/>/, \">\"),\n\t\twritextag(\n\t\t\t\"o:shapelayout\",\n\t\t\twritextag(\"o:idmap\", null, { \"v:ext\": \"edit\", data: String(rId) }),\n\t\t\t{ \"v:ext\": \"edit\" },\n\t\t),\n\t];\n\n\tlet _shapeid = 65536 * rId;\n\tconst _comments = comments || [];\n\n\tif (_comments.length > 0)\n\t\to.push(\n\t\t\twritextag(\n\t\t\t\t\"v:shapetype\",\n\t\t\t\t[\n\t\t\t\t\twritextag(\"v:stroke\", null, { joinstyle: \"miter\" }),\n\t\t\t\t\twritextag(\"v:path\", null, { gradientshapeok: \"t\", \"o:connecttype\": \"rect\" }),\n\t\t\t\t].join(\"\"),\n\t\t\t\t{\n\t\t\t\t\tid: \"_x0000_t202\",\n\t\t\t\t\tcoordsize: csize.join(\",\"),\n\t\t\t\t\t\"o:spt\": \"202\",\n\t\t\t\t\tpath: bbox,\n\t\t\t\t},\n\t\t\t),\n\t\t);\n\n\t_comments.forEach((x) => {\n\t\t++_shapeid;\n\t\to.push(write_vml_comment(x, _shapeid));\n\t});\n\to.push(\"</xml>\");\n\treturn o.join(\"\");\n}\n","import { parsexmltag, tagregex, XML_HEADER, strip_ns } from \"../xml/parser.js\";\n\nexport interface XLMeta {\n\tTypes: { name: string; offsets?: number[] }[];\n\tCell: { type: string; index: number }[];\n\tValue: { type: string; index: number }[];\n}\n\n/** Parse metadata XML */\nexport function parse_xlmeta_xml(data: string, opts?: any): XLMeta {\n\tconst out: XLMeta = { Types: [], Cell: [], Value: [] };\n\tif (!data) return out;\n\n\tlet pass = false;\n\tlet metatype = 2;\n\tlet lastmeta: any;\n\n\tdata.replace(tagregex, function (x: string): string {\n\t\tconst y: any = parsexmltag(x);\n\t\tswitch (strip_ns(y[0])) {\n\t\t\tcase \"<?xml\":\n\t\t\t\tbreak;\n\t\t\tcase \"<metadata\":\n\t\t\tcase \"</metadata>\":\n\t\t\t\tbreak;\n\t\t\tcase \"<metadataTypes\":\n\t\t\tcase \"</metadataTypes>\":\n\t\t\t\tbreak;\n\t\t\tcase \"<metadataType\":\n\t\t\t\tout.Types.push({ name: y.name });\n\t\t\t\tbreak;\n\t\t\tcase \"</metadataType>\":\n\t\t\t\tbreak;\n\t\t\tcase \"<futureMetadata\":\n\t\t\t\tfor (let j = 0; j < out.Types.length; ++j)\n\t\t\t\t\tif (out.Types[j].name === y.name) lastmeta = out.Types[j];\n\t\t\t\tbreak;\n\t\t\tcase \"</futureMetadata>\":\n\t\t\t\tbreak;\n\t\t\tcase \"<bk>\":\n\t\t\tcase \"</bk>\":\n\t\t\t\tbreak;\n\t\t\tcase \"<rc\":\n\t\t\t\tif (metatype === 1)\n\t\t\t\t\tout.Cell.push({ type: out.Types[y.t - 1].name, index: +y.v });\n\t\t\t\telse if (metatype === 0)\n\t\t\t\t\tout.Value.push({ type: out.Types[y.t - 1].name, index: +y.v });\n\t\t\t\tbreak;\n\t\t\tcase \"</rc>\":\n\t\t\t\tbreak;\n\t\t\tcase \"<cellMetadata\":\n\t\t\t\tmetatype = 1;\n\t\t\t\tbreak;\n\t\t\tcase \"</cellMetadata>\":\n\t\t\t\tmetatype = 2;\n\t\t\t\tbreak;\n\t\t\tcase \"<valueMetadata\":\n\t\t\t\tmetatype = 0;\n\t\t\t\tbreak;\n\t\t\tcase \"</valueMetadata>\":\n\t\t\t\tmetatype = 2;\n\t\t\t\tbreak;\n\t\t\tcase \"<extLst\":\n\t\t\tcase \"<extLst>\":\n\t\t\tcase \"</extLst>\":\n\t\t\tcase \"<extLst/>\":\n\t\t\t\tbreak;\n\t\t\tcase \"<ext\":\n\t\t\t\tpass = true;\n\t\t\t\tbreak;\n\t\t\tcase \"</ext>\":\n\t\t\t\tpass = false;\n\t\t\t\tbreak;\n\t\t\tcase \"<rvb\":\n\t\t\t\tif (!lastmeta) break;\n\t\t\t\tif (!lastmeta.offsets) lastmeta.offsets = [];\n\t\t\t\tlastmeta.offsets.push(+y.i);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\treturn x;\n\t});\n\treturn out;\n}\n\n/** Write minimal metadata XML for dynamic arrays */\nexport function write_xlmeta_xml(): string {\n\tconst o: string[] = [XML_HEADER];\n\to.push(\n\t\t'<metadata xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:xlrd=\"http://schemas.microsoft.com/office/spreadsheetml/2017/richdata\" xmlns:xda=\"http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray\">\\n' +\n\t\t\t\"  <metadataTypes count=\\\"1\\\">\\n\" +\n\t\t\t'    <metadataType name=\"XLDAPR\" minSupportedVersion=\"120000\" copy=\"1\" pasteAll=\"1\" pasteValues=\"1\" merge=\"1\" splitFirst=\"1\" rowColShift=\"1\" clearFormats=\"1\" clearComments=\"1\" assign=\"1\" coerce=\"1\" cellMeta=\"1\"/>\\n' +\n\t\t\t\"  </metadataTypes>\\n\" +\n\t\t\t'  <futureMetadata name=\"XLDAPR\" count=\"1\">\\n' +\n\t\t\t\"    <bk>\\n\" +\n\t\t\t\"      <extLst>\\n\" +\n\t\t\t'        <ext uri=\"{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}\">\\n' +\n\t\t\t'          <xda:dynamicArrayProperties fDynamic=\"1\" fCollapsed=\"0\"/>\\n' +\n\t\t\t\"        </ext>\\n\" +\n\t\t\t\"      </extLst>\\n\" +\n\t\t\t\"    </bk>\\n\" +\n\t\t\t\"  </futureMetadata>\\n\" +\n\t\t\t'  <cellMetadata count=\"1\">\\n' +\n\t\t\t\"    <bk>\\n\" +\n\t\t\t'      <rc t=\"1\" v=\"0\"/>\\n' +\n\t\t\t\"    </bk>\\n\" +\n\t\t\t\"  </cellMetadata>\\n\" +\n\t\t\t\"</metadata>\",\n\t);\n\treturn o.join(\"\");\n}\n","import { parsexmltag, tagregex } from \"../xml/parser.js\";\n\nexport interface CalcChainEntry {\n\tr?: string;\n\ti?: any;\n\tl?: string;\n\ta?: string;\n\t[key: string]: any;\n}\n\n/** Parse calculation chain XML (18.6) */\nexport function parse_cc_xml(data: string): CalcChainEntry[] {\n\tconst d: CalcChainEntry[] = [];\n\tif (!data) return d;\n\tlet i: any = 1;\n\t(data.match(tagregex) || []).forEach((x) => {\n\t\tconst y: any = parsexmltag(x);\n\t\tswitch (y[0]) {\n\t\t\tcase \"<?xml\":\n\t\t\t\tbreak;\n\t\t\tcase \"<calcChain\":\n\t\t\tcase \"<calcChain>\":\n\t\t\tcase \"</calcChain>\":\n\t\t\t\tbreak;\n\t\t\tcase \"<c\":\n\t\t\t\tdelete y[0];\n\t\t\t\tif (y.i) i = y.i;\n\t\t\t\telse y.i = i;\n\t\t\t\td.push(y);\n\t\t\t\tbreak;\n\t\t}\n\t});\n\treturn d;\n}\n","import type { WorkBook, WorkSheet, ReadOptions, FullProperties } from \"../types.js\";\nimport type { ZipArchive } from \"../zip/index.js\";\nimport type { ContentTypes } from \"../opc/content-types.js\";\nimport type { Relationships } from \"../opc/relationships.js\";\nimport type { SST } from \"./shared-strings.js\";\nimport type { StylesData } from \"./styles.js\";\nimport type { ThemeData } from \"./theme.js\";\nimport type { WorkbookFile, SheetEntry } from \"./workbook.js\";\nimport { zip_read_str, zip_read_bin, zip_has } from \"../zip/index.js\";\nimport { parse_ct } from \"../opc/content-types.js\";\nimport { parse_rels, get_rels_path } from \"../opc/relationships.js\";\nimport { parse_core_props } from \"../opc/core-properties.js\";\nimport { parse_ext_props } from \"../opc/extended-properties.js\";\nimport { parse_cust_props } from \"../opc/custom-properties.js\";\nimport { parse_sst_xml } from \"./shared-strings.js\";\nimport { parse_sty_xml } from \"./styles.js\";\nimport { parse_theme_xml } from \"./theme.js\";\nimport { parse_wb_xml } from \"./workbook.js\";\nimport { parse_ws_xml, resolve_sst } from \"./worksheet.js\";\nimport { parse_comments_xml, parse_tcmnt_xml, parse_people_xml, sheet_insert_comments } from \"./comments.js\";\nimport { parse_vml } from \"./vml.js\";\nimport { parse_xlmeta_xml } from \"./metadata.js\";\nimport { parse_cc_xml } from \"./calc-chain.js\";\nimport { make_ssf, table_fmt } from \"../ssf/table.js\";\nimport { dup, keys } from \"../utils/helpers.js\";\nimport { utf8read } from \"../utils/buffer.js\";\nimport { RELS as RELTYPE } from \"../xml/namespaces.js\";\n\nfunction strip_front_slash(x: string): string {\n\treturn x.charAt(0) === \"/\" ? x.slice(1) : x;\n}\n\nfunction resolve_path(target: string, basePath: string): string {\n\tif (target.charAt(0) === \"/\") return target;\n\tconst base = basePath.slice(0, basePath.lastIndexOf(\"/\") + 1);\n\tconst parts = (base + target).split(\"/\");\n\tconst resolved: string[] = [];\n\tfor (const p of parts) {\n\t\tif (p === \"..\") resolved.pop();\n\t\telse if (p !== \".\") resolved.push(p);\n\t}\n\treturn resolved.join(\"/\");\n}\n\nfunction getzipstr(zip: ZipArchive, path: string, safe?: boolean): string | null {\n\tconst p = zip_read_str(zip, path);\n\tif (p == null && !safe) throw new Error(\"Could not find \" + path);\n\treturn p;\n}\n\nfunction getzipdata(zip: ZipArchive, path: string, safe?: boolean): string | null {\n\t// For XML-based files we just read as string\n\treturn getzipstr(zip, path, safe);\n}\n\nconst RELS_WS = [\n\t\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\",\n\t\"http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet\",\n];\n\nfunction get_sheet_type(n: string): string {\n\tif (RELS_WS.indexOf(n) > -1) return \"sheet\";\n\treturn n && n.length ? n : \"sheet\";\n}\n\nfunction safe_parse_wbrels(\n\twbrels: Relationships,\n\tsheets: SheetEntry[],\n): [string, string, string][] | null {\n\tif (!wbrels) return null;\n\ttry {\n\t\tconst result: [string, string, string][] = sheets.map((w) => {\n\t\t\tconst id = (w as any).id || (w as any).strRelID;\n\t\t\treturn [w.name, wbrels[\"!id\"][id].Target, get_sheet_type(wbrels[\"!id\"][id].Type)];\n\t\t});\n\t\treturn result.length === 0 ? null : result;\n\t} catch {\n\t\treturn null;\n\t}\n}\n\nfunction safe_parse_sheet(\n\tzip: ZipArchive,\n\tpath: string,\n\trelsPath: string,\n\tsheetName: string,\n\tidx: number,\n\tsheetRels: Record<string, Relationships>,\n\tsheets: Record<string, WorkSheet>,\n\tstype: string,\n\topts: any,\n\twb: WorkbookFile,\n\tthemes: ThemeData,\n\tstyles: StylesData,\n\tstrs: SST,\n): void {\n\ttry {\n\t\tsheetRels[sheetName] = parse_rels(getzipstr(zip, relsPath, true), path);\n\t\tconst data = getzipdata(zip, path);\n\t\tif (!data) return;\n\n\t\tlet _ws: WorkSheet | undefined;\n\t\tswitch (stype) {\n\t\t\tcase \"sheet\":\n\t\t\t\t_ws = parse_ws_xml(data, opts);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn;\n\t\t}\n\t\tif (!_ws) return;\n\n\t\t// Resolve shared string references\n\t\tresolve_sst(_ws, strs, opts);\n\n\t\tsheets[sheetName] = _ws;\n\n\t\t// Scan rels for comments and threaded comments\n\t\tconst comments: any[] = [];\n\t\tlet tcomments: any[] = [];\n\t\tif (sheetRels[sheetName]) {\n\t\t\tfor (const n of keys(sheetRels[sheetName])) {\n\t\t\t\tif (n === \"!id\" || n === \"!idx\") continue;\n\t\t\t\tconst rel = sheetRels[sheetName][n];\n\t\t\t\tif (!rel || !rel.Type) continue;\n\n\t\t\t\tif (rel.Type === RELTYPE.CMNT) {\n\t\t\t\t\tconst dfile = resolve_path(rel.Target, path);\n\t\t\t\t\tconst cmntData = getzipdata(zip, dfile, true);\n\t\t\t\t\tif (cmntData) {\n\t\t\t\t\t\tconst parsedComments = parse_comments_xml(cmntData, opts);\n\t\t\t\t\t\tif (parsedComments && parsedComments.length > 0) {\n\t\t\t\t\t\t\tsheet_insert_comments(_ws, parsedComments, false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (rel.Type === RELTYPE.TCMNT) {\n\t\t\t\t\tconst dfile = resolve_path(rel.Target, path);\n\t\t\t\t\tconst tcData = getzipdata(zip, dfile, true);\n\t\t\t\t\tif (tcData) {\n\t\t\t\t\t\ttcomments = tcomments.concat(parse_tcmnt_xml(tcData, opts));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (tcomments.length > 0) {\n\t\t\tsheet_insert_comments(_ws, tcomments, true, opts.people || []);\n\t\t}\n\n\t\t// Parse legacy drawings (VML for comment boxes)\n\t\tif ((_ws as any)[\"!legdrawel\"] && sheetRels[sheetName]) {\n\t\t\tconst dfile = resolve_path((_ws as any)[\"!legdrawel\"].Target, path);\n\t\t\tconst draw = getzipstr(zip, dfile, true);\n\t\t\tif (draw) parse_vml(utf8read(draw), _ws, comments);\n\t\t}\n\t} catch (e) {\n\t\tif (opts.WTF) throw e;\n\t}\n}\n\n/** Parse an XLSX ZIP archive into a WorkBook */\nexport function parse_zip(zip: ZipArchive, opts?: ReadOptions): WorkBook {\n\tmake_ssf();\n\tconst o: any = opts || {};\n\n\tif (!zip_has(zip, \"[Content_Types].xml\")) {\n\t\tthrow new Error(\"Unsupported ZIP file\");\n\t}\n\n\tconst dir: ContentTypes = parse_ct(getzipstr(zip, \"[Content_Types].xml\"));\n\n\tif (dir.workbooks.length === 0) {\n\t\tconst binname = \"xl/workbook.xml\";\n\t\tif (getzipdata(zip, binname, true)) dir.workbooks.push(binname);\n\t}\n\tif (dir.workbooks.length === 0) {\n\t\tthrow new Error(\"Could not find workbook\");\n\t}\n\n\tconst themes: ThemeData = { themeElements: { clrScheme: [] } };\n\tlet styles: StylesData = { NumberFmt: {}, CellXf: [], Fonts: [], Fills: [], Borders: [] };\n\tlet strs: SST = [] as any;\n\n\tif (!o.bookSheets && !o.bookProps) {\n\t\tif (dir.sst) {\n\t\t\ttry {\n\t\t\t\tconst sstData = getzipdata(zip, strip_front_slash(dir.sst));\n\t\t\t\tif (sstData) strs = parse_sst_xml(sstData, o);\n\t\t\t} catch (e) {\n\t\t\t\tif (o.WTF) throw e;\n\t\t\t}\n\t\t}\n\n\t\tif (dir.themes.length) {\n\t\t\tconst themeData = getzipstr(zip, dir.themes[0].replace(/^\\//, \"\"), true);\n\t\t\tif (themeData) {\n\t\t\t\tconst parsed = parse_theme_xml(themeData);\n\t\t\t\tObject.assign(themes, parsed);\n\t\t\t}\n\t\t}\n\n\t\tif (dir.style) {\n\t\t\tconst styData = getzipdata(zip, strip_front_slash(dir.style));\n\t\t\tif (styData) styles = parse_sty_xml(styData, themes, o);\n\t\t}\n\t}\n\n\tconst wb: WorkbookFile = parse_wb_xml(\n\t\tgetzipdata(zip, strip_front_slash(dir.workbooks[0]))!,\n\t\to,\n\t);\n\n\tconst props: any = {};\n\tif (dir.coreprops.length) {\n\t\tconst propdata = getzipdata(zip, strip_front_slash(dir.coreprops[0]), true);\n\t\tif (propdata) Object.assign(props, parse_core_props(propdata));\n\t\tif (dir.extprops.length) {\n\t\t\tconst extdata = getzipdata(zip, strip_front_slash(dir.extprops[0]), true);\n\t\t\tif (extdata) parse_ext_props(extdata, props);\n\t\t}\n\t}\n\n\tlet custprops: Record<string, any> = {};\n\tif (!o.bookSheets || o.bookProps) {\n\t\tif (dir.custprops.length) {\n\t\t\tconst custdata = getzipstr(zip, strip_front_slash(dir.custprops[0]), true);\n\t\t\tif (custdata) custprops = parse_cust_props(custdata, o);\n\t\t}\n\t}\n\n\tconst out: any = {};\n\tif (o.bookSheets || o.bookProps) {\n\t\tlet sheets: string[] | undefined;\n\t\tif (wb.Sheets) sheets = wb.Sheets.map((x: SheetEntry) => x.name);\n\t\telse if (props.Worksheets && props.SheetNames?.length > 0) sheets = props.SheetNames;\n\t\tif (o.bookProps) {\n\t\t\tout.Props = props;\n\t\t\tout.Custprops = custprops;\n\t\t}\n\t\tif (o.bookSheets && sheets) out.SheetNames = sheets;\n\t\tif (o.bookSheets ? out.SheetNames : o.bookProps) return out as WorkBook;\n\t}\n\n\tconst sheets: Record<string, WorkSheet> = {};\n\n\tif (o.bookDeps && dir.calcchain) {\n\t\tparse_cc_xml(getzipdata(zip, strip_front_slash(dir.calcchain), true) || \"\");\n\t}\n\n\tconst sheetRels: Record<string, Relationships> = {};\n\tconst wbsheets = wb.Sheets;\n\tprops.Worksheets = wbsheets.length;\n\tprops.SheetNames = [];\n\tfor (let j = 0; j < wbsheets.length; ++j) {\n\t\tprops.SheetNames[j] = wbsheets[j].name;\n\t}\n\n\tconst wbrelsi = dir.workbooks[0].lastIndexOf(\"/\");\n\tlet wbrelsfile = (\n\t\tdir.workbooks[0].slice(0, wbrelsi + 1) +\n\t\t\"_rels/\" +\n\t\tdir.workbooks[0].slice(wbrelsi + 1) +\n\t\t\".rels\"\n\t).replace(/^\\//, \"\");\n\tif (!zip_has(zip, wbrelsfile)) wbrelsfile = \"xl/_rels/workbook.xml.rels\";\n\tlet wbrels = parse_rels(\n\t\tgetzipstr(zip, wbrelsfile, true),\n\t\twbrelsfile.replace(/_rels.*/, \"s5s\"),\n\t);\n\n\t// Parse metadata\n\tif ((dir.metadata || []).length >= 1) {\n\t\to.xlmeta = parse_xlmeta_xml(\n\t\t\tgetzipdata(zip, strip_front_slash(dir.metadata[0]), true) || \"\",\n\t\t\to,\n\t\t);\n\t}\n\n\t// Parse people (for threaded comments)\n\tif ((dir.people || []).length >= 1) {\n\t\to.people = parse_people_xml(\n\t\t\tgetzipdata(zip, strip_front_slash(dir.people[0]), true) || \"\",\n\t\t);\n\t}\n\n\tconst wbrelsArr = wbrels ? safe_parse_wbrels(wbrels, wb.Sheets) : null;\n\n\tconst nmode = getzipdata(zip, \"xl/worksheets/sheet.xml\", true) ? 1 : 0;\n\n\tfor (let i = 0; i < props.Worksheets; ++i) {\n\t\tlet stype = \"sheet\";\n\t\tlet path: string;\n\t\tif (wbrelsArr && wbrelsArr[i]) {\n\t\t\tpath = \"xl/\" + wbrelsArr[i][1].replace(/[/]?xl\\//, \"\");\n\t\t\tif (!zip_has(zip, path)) path = wbrelsArr[i][1];\n\t\t\tif (!zip_has(zip, path))\n\t\t\t\tpath = wbrelsfile.replace(/_rels\\/[\\S\\s]*$/, \"\") + wbrelsArr[i][1];\n\t\t\tstype = wbrelsArr[i][2];\n\t\t} else {\n\t\t\tpath = \"xl/worksheets/sheet\" + (i + 1 - nmode) + \".xml\";\n\t\t\tpath = path.replace(/sheet0\\./, \"sheet.\");\n\t\t}\n\n\t\t// Check sheet filter\n\t\tif (o.sheets != null) {\n\t\t\tif (typeof o.sheets === \"number\" && i !== o.sheets) continue;\n\t\t\tif (typeof o.sheets === \"string\" && props.SheetNames[i].toLowerCase() !== o.sheets.toLowerCase()) continue;\n\t\t\tif (Array.isArray(o.sheets)) {\n\t\t\t\tlet seen = false;\n\t\t\t\tfor (const s of o.sheets) {\n\t\t\t\t\tif (typeof s === \"number\" && s === i) seen = true;\n\t\t\t\t\tif (typeof s === \"string\" && s.toLowerCase() === props.SheetNames[i].toLowerCase()) seen = true;\n\t\t\t\t}\n\t\t\t\tif (!seen) continue;\n\t\t\t}\n\t\t}\n\n\t\tconst relsPath = path.replace(/^(.*)(\\/)([^/]*)$/, \"$1/_rels/$3.rels\");\n\t\tsafe_parse_sheet(zip, path, relsPath, props.SheetNames[i], i, sheetRels, sheets, stype, o, wb, themes, styles, strs);\n\t}\n\n\tconst result: WorkBook = {\n\t\tSheets: sheets,\n\t\tSheetNames: props.SheetNames,\n\t\tProps: props,\n\t\tCustprops: custprops,\n\t\tbookType: \"xlsx\",\n\t};\n\n\tif (wb.WBProps) {\n\t\tresult.Workbook = {\n\t\t\tWBProps: wb.WBProps,\n\t\t\tSheets: wb.Sheets as any,\n\t\t\tNames: wb.Names as any,\n\t\t};\n\t}\n\n\treturn result;\n}\n","/** Decode a base64 string to Uint8Array */\nexport function base64decode(input: string): Uint8Array {\n\tlet str = input;\n\tif (str.slice(0, 5) === \"data:\") {\n\t\tconst i = str.slice(0, 1024).indexOf(\";base64,\");\n\t\tif (i > -1) str = str.slice(i + 8);\n\t}\n\tconst binaryStr = atob(str);\n\tconst len = binaryStr.length;\n\tconst bytes = new Uint8Array(len);\n\tfor (let i = 0; i < len; i++) {\n\t\tbytes[i] = binaryStr.charCodeAt(i);\n\t}\n\treturn bytes;\n}\n\n/** Encode a Uint8Array to base64 string */\nexport function base64encode(data: Uint8Array): string {\n\tlet binaryStr = \"\";\n\tfor (let i = 0; i < data.length; i++) {\n\t\tbinaryStr += String.fromCharCode(data[i]);\n\t}\n\treturn btoa(binaryStr);\n}\n","import type { WorkBook, ReadOptions } from \"./types.js\";\nimport { zip_read } from \"./zip/index.js\";\nimport { parse_zip } from \"./xlsx/parse-zip.js\";\nimport { base64decode } from \"./utils/base64.js\";\nimport { make_ssf } from \"./ssf/table.js\";\nimport { dup } from \"./utils/helpers.js\";\nimport * as fs from \"node:fs\";\n\nfunction to_uint8array(data: any, opts: ReadOptions): Uint8Array {\n\tif (data instanceof Uint8Array) return data;\n\tif (data instanceof ArrayBuffer) return new Uint8Array(data);\n\tif (typeof Buffer !== \"undefined\" && Buffer.isBuffer(data)) return new Uint8Array(data.buffer, data.byteOffset, data.length);\n\tif (typeof data === \"string\") {\n\t\tif (opts.type === \"base64\") {\n\t\t\treturn base64decode(data);\n\t\t}\n\t\t// binary string\n\t\tconst u8 = new Uint8Array(data.length);\n\t\tfor (let i = 0; i < data.length; ++i) u8[i] = data.charCodeAt(i);\n\t\treturn u8;\n\t}\n\tif (Array.isArray(data)) return new Uint8Array(data);\n\tthrow new Error(\"Unsupported data type for read()\");\n}\n\nfunction detect_type(data: any): ReadOptions[\"type\"] {\n\tif (data instanceof Uint8Array || data instanceof ArrayBuffer) return \"array\";\n\tif (typeof Buffer !== \"undefined\" && Buffer.isBuffer(data)) return \"buffer\";\n\tif (typeof data === \"string\") return \"base64\";\n\treturn \"array\";\n}\n\n/**\n * Read an XLSX file from a data source.\n *\n * @param data - File contents as Uint8Array, ArrayBuffer, Buffer, base64 string, or binary string\n * @param opts - Read options\n * @returns Parsed WorkBook object\n */\nexport function read(data: any, opts?: ReadOptions): WorkBook {\n\tmake_ssf();\n\tconst o: any = opts ? dup(opts) : {};\n\tif (!o.type) o.type = detect_type(data);\n\n\tconst u8 = to_uint8array(data, o);\n\n\t// Check first bytes - must be PK (ZIP)\n\tif (u8[0] === 0x50 && u8[1] === 0x4b) {\n\t\tconst zip = zip_read(u8);\n\t\treturn parse_zip(zip, o);\n\t}\n\n\t// Check for PDF\n\tif (u8[0] === 0x25 && u8[1] === 0x50 && u8[2] === 0x44 && u8[3] === 0x46) {\n\t\tthrow new Error(\"PDF File is not a spreadsheet\");\n\t}\n\n\t// Check for PNG\n\tif (u8[0] === 0x89 && u8[1] === 0x50 && u8[2] === 0x4e && u8[3] === 0x47) {\n\t\tthrow new Error(\"PNG Image File is not a spreadsheet\");\n\t}\n\n\tthrow new Error(\"Unsupported file format. xlsx-format only supports XLSX files.\");\n}\n\n/**\n * Read an XLSX file from the filesystem.\n *\n * @param filename - Path to the XLSX file\n * @param opts - Read options\n * @returns Parsed WorkBook object\n */\nexport function readFile(filename: string, opts?: ReadOptions): WorkBook {\n\tconst data = fs.readFileSync(filename);\n\treturn read(new Uint8Array(data), opts);\n}\n","import type { WorkBook, WriteOptions } from \"../types.js\";\nimport type { ZipArchive } from \"../zip/index.js\";\nimport type { Relationships } from \"../opc/relationships.js\";\nimport type { SST } from \"./shared-strings.js\";\nimport { zip_new, zip_add_str } from \"../zip/index.js\";\nimport { new_ct, write_ct } from \"../opc/content-types.js\";\nimport { write_rels, add_rels, get_rels_path } from \"../opc/relationships.js\";\nimport { write_core_props } from \"../opc/core-properties.js\";\nimport { write_ext_props } from \"../opc/extended-properties.js\";\nimport { write_cust_props } from \"../opc/custom-properties.js\";\nimport { write_sst_xml } from \"./shared-strings.js\";\nimport { write_sty_xml } from \"./styles.js\";\nimport { write_theme_xml } from \"./theme.js\";\nimport { write_wb_xml, check_wb } from \"./workbook.js\";\nimport { write_ws_xml } from \"./worksheet.js\";\nimport { write_comments_xml, write_tcmnt_xml, write_people_xml } from \"./comments.js\";\nimport { write_vml } from \"./vml.js\";\nimport { write_xlmeta_xml } from \"./metadata.js\";\nimport { make_ssf, table_fmt, SSF_load_table } from \"../ssf/table.js\";\nimport { dup, keys, evert } from \"../utils/helpers.js\";\nimport { RELS as RELTYPE } from \"../xml/namespaces.js\";\n\n/** Write a WorkBook to a ZIP archive (XLSX format) */\nexport function write_zip_xlsx(wb: WorkBook, opts: any): ZipArchive {\n\tif (wb && !(wb as any).SSF) {\n\t\t(wb as any).SSF = dup(table_fmt);\n\t}\n\tif (wb && (wb as any).SSF) {\n\t\tmake_ssf();\n\t\tSSF_load_table((wb as any).SSF);\n\t}\n\n\topts.rels = { \"!id\": {} } as any;\n\topts.wbrels = { \"!id\": {} } as any;\n\topts.Strings = [] as any;\n\topts.Strings.Count = 0;\n\topts.Strings.Unique = 0;\n\topts.revStrings = new Map();\n\n\tconst ct = new_ct();\n\tconst zip = zip_new();\n\tlet f = \"\";\n\n\topts.cellXfs = [];\n\n\tif (!wb.Props) wb.Props = {};\n\n\t// Core properties\n\tf = \"docProps/core.xml\";\n\tzip_add_str(zip, f, write_core_props(wb.Props, opts));\n\tct.coreprops.push(f);\n\tadd_rels(opts.rels, 2, f, RELTYPE.CORE_PROPS);\n\n\t// Extended properties\n\tf = \"docProps/app.xml\";\n\tif (wb.Props && (wb.Props as any).SheetNames) {\n\t\t/* already set */\n\t} else if (!wb.Workbook || !wb.Workbook.Sheets) {\n\t\t(wb.Props as any).SheetNames = wb.SheetNames;\n\t} else {\n\t\tconst _sn: string[] = [];\n\t\tfor (let _i = 0; _i < wb.SheetNames.length; ++_i) {\n\t\t\tif ((wb.Workbook.Sheets[_i] || ({} as any)).Hidden !== 2) _sn.push(wb.SheetNames[_i]);\n\t\t}\n\t\t(wb.Props as any).SheetNames = _sn;\n\t}\n\t(wb.Props as any).Worksheets = (wb.Props as any).SheetNames.length;\n\tzip_add_str(zip, f, write_ext_props(wb.Props));\n\tct.extprops.push(f);\n\tadd_rels(opts.rels, 3, f, RELTYPE.EXT_PROPS);\n\n\t// Custom properties\n\tif (wb.Custprops !== wb.Props && keys(wb.Custprops || {}).length > 0) {\n\t\tf = \"docProps/custom.xml\";\n\t\tzip_add_str(zip, f, write_cust_props(wb.Custprops));\n\t\tct.custprops.push(f);\n\t\tadd_rels(opts.rels, 4, f, RELTYPE.CUST_PROPS);\n\t}\n\n\tconst people: string[] = [\"SheetJ5\"];\n\topts.tcid = 0;\n\n\t// Sheets\n\tfor (let rId = 1; rId <= wb.SheetNames.length; ++rId) {\n\t\tconst wsrels: Relationships = { \"!id\": {} } as any;\n\t\tconst ws = wb.Sheets[wb.SheetNames[rId - 1]];\n\n\t\tf = \"xl/worksheets/sheet\" + rId + \".xml\";\n\t\tzip_add_str(zip, f, write_ws_xml(ws || ({} as any), opts, rId - 1, wsrels, wb));\n\t\tct.sheets.push(f);\n\t\tadd_rels(opts.wbrels, -1, \"worksheets/sheet\" + rId + \".xml\", RELTYPE.SHEET);\n\n\t\tif (ws) {\n\t\t\tconst comments = (ws as any)[\"!comments\"];\n\t\t\tlet need_vml = false;\n\n\t\t\tif (comments && comments.length > 0) {\n\t\t\t\tlet needtc = false;\n\t\t\t\tcomments.forEach((carr: any) => {\n\t\t\t\t\tcarr[1].forEach((c: any) => {\n\t\t\t\t\t\tif (c.T === true) needtc = true;\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\tif (needtc) {\n\t\t\t\t\tconst cf = \"xl/threadedComments/threadedComment\" + rId + \".xml\";\n\t\t\t\t\tzip_add_str(zip, cf, write_tcmnt_xml(comments, people, opts));\n\t\t\t\t\tct.threadedcomments.push(cf);\n\t\t\t\t\tadd_rels(wsrels, -1, \"../threadedComments/threadedComment\" + rId + \".xml\", RELTYPE.TCMNT);\n\t\t\t\t}\n\n\t\t\t\tconst cf2 = \"xl/comments\" + rId + \".xml\";\n\t\t\t\tzip_add_str(zip, cf2, write_comments_xml(comments));\n\t\t\t\tct.comments.push(cf2);\n\t\t\t\tadd_rels(wsrels, -1, \"../comments\" + rId + \".xml\", RELTYPE.CMNT);\n\t\t\t\tneed_vml = true;\n\t\t\t}\n\n\t\t\tif ((ws as any)[\"!legacy\"]) {\n\t\t\t\tif (need_vml) {\n\t\t\t\t\tzip_add_str(\n\t\t\t\t\t\tzip,\n\t\t\t\t\t\t\"xl/drawings/vmlDrawing\" + rId + \".vml\",\n\t\t\t\t\t\twrite_vml(rId, (ws as any)[\"!comments\"]),\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdelete (ws as any)[\"!comments\"];\n\t\t\tdelete (ws as any)[\"!legacy\"];\n\t\t}\n\n\t\tif ((wsrels[\"!id\"] as any).rId1) {\n\t\t\tzip_add_str(zip, get_rels_path(f), write_rels(wsrels));\n\t\t}\n\t}\n\n\t// Shared strings\n\tif (opts.Strings != null && opts.Strings.length > 0) {\n\t\tf = \"xl/sharedStrings.xml\";\n\t\tzip_add_str(zip, f, write_sst_xml(opts.Strings, opts));\n\t\tct.strs.push(f);\n\t\tadd_rels(opts.wbrels, -1, \"sharedStrings.xml\", RELTYPE.SST);\n\t}\n\n\t// Workbook\n\tf = \"xl/workbook.xml\";\n\tzip_add_str(zip, f, write_wb_xml(wb));\n\tct.workbooks.push(f);\n\tadd_rels(opts.rels, 1, f, RELTYPE.WB);\n\n\t// Theme\n\tf = \"xl/theme/theme1.xml\";\n\tzip_add_str(zip, f, write_theme_xml());\n\tct.themes.push(f);\n\tadd_rels(opts.wbrels, -1, \"theme/theme1.xml\", RELTYPE.THEME);\n\n\t// Styles\n\tf = \"xl/styles.xml\";\n\tzip_add_str(zip, f, write_sty_xml(wb, opts));\n\tct.styles.push(f);\n\tadd_rels(opts.wbrels, -1, \"styles.xml\", RELTYPE.STY);\n\n\t// Metadata\n\tf = \"xl/metadata.xml\";\n\tzip_add_str(zip, f, write_xlmeta_xml());\n\tct.metadata.push(f);\n\tadd_rels(opts.wbrels, -1, \"metadata.xml\", RELTYPE.META);\n\n\t// People (threaded comments)\n\tif (people.length > 1) {\n\t\tf = \"xl/persons/person.xml\";\n\t\tzip_add_str(zip, f, write_people_xml(people));\n\t\tct.people.push(f);\n\t\tadd_rels(opts.wbrels, -1, \"persons/person.xml\", RELTYPE.PEOPLE);\n\t}\n\n\t// Content types and relationships\n\tzip_add_str(zip, \"[Content_Types].xml\", write_ct(ct, opts));\n\tzip_add_str(zip, \"_rels/.rels\", write_rels(opts.rels));\n\tzip_add_str(zip, \"xl/_rels/workbook.xml.rels\", write_rels(opts.wbrels));\n\n\treturn zip;\n}\n","import type { WorkBook, WriteOptions } from \"./types.js\";\nimport { zip_write } from \"./zip/index.js\";\nimport { write_zip_xlsx } from \"./xlsx/write-zip.js\";\nimport { check_wb } from \"./xlsx/workbook.js\";\nimport { base64encode } from \"./utils/base64.js\";\nimport { make_ssf } from \"./ssf/table.js\";\nimport { dup } from \"./utils/helpers.js\";\nimport * as fs from \"node:fs\";\n\n/**\n * Write a WorkBook to a Uint8Array (XLSX format).\n *\n * @param wb - WorkBook object to write\n * @param opts - Write options\n * @returns File contents as Uint8Array, base64 string, or Buffer depending on opts.type\n */\nexport function write(wb: WorkBook, opts?: WriteOptions): any {\n\tmake_ssf();\n\tif (!opts || !(opts as any).unsafe) check_wb(wb);\n\tconst o: any = dup(opts || {});\n\tif (o.cellStyles) {\n\t\to.cellNF = true;\n\t\to.sheetStubs = true;\n\t}\n\n\tconst zip = write_zip_xlsx(wb, o);\n\tconst compressed = zip_write(zip, !!o.compression);\n\n\tswitch (o.type) {\n\t\tcase \"base64\":\n\t\t\treturn base64encode_u8(compressed);\n\t\tcase \"buffer\":\n\t\t\tif (typeof Buffer !== \"undefined\") return Buffer.from(compressed.buffer, compressed.byteOffset, compressed.byteLength);\n\t\t\treturn compressed;\n\t\tcase \"array\":\n\t\t\treturn compressed;\n\t\tdefault:\n\t\t\treturn compressed;\n\t}\n}\n\nfunction base64encode_u8(data: Uint8Array): string {\n\treturn base64encode(data);\n}\n\n/**\n * Write a WorkBook to a file (XLSX format).\n *\n * @param wb - WorkBook object to write\n * @param filename - Output file path\n * @param opts - Write options\n */\nexport function writeFile(wb: WorkBook, filename: string, opts?: WriteOptions): void {\n\tconst o: any = opts ? dup(opts) : {};\n\to.type = \"buffer\";\n\tconst data = write(wb, o);\n\tfs.writeFileSync(filename, data instanceof Uint8Array ? Buffer.from(data) : data);\n}\n","import type { WorkBook, WorkSheet, CellObject, Hyperlink } from \"../types.js\";\nimport { check_ws_name } from \"../xlsx/workbook.js\";\nimport { decode_cell, encode_col, encode_row, encode_range, decode_range, safe_decode_range } from \"../utils/cell.js\";\n\n/** Create a new blank workbook, optionally with a first sheet */\nexport function book_new(ws?: WorkSheet, wsname?: string): WorkBook {\n\tconst wb: WorkBook = { SheetNames: [], Sheets: {} };\n\tif (ws) book_append_sheet(wb, ws, wsname || \"Sheet1\");\n\treturn wb;\n}\n\n/** Add a worksheet to the end of a workbook */\nexport function book_append_sheet(\n\twb: WorkBook,\n\tws: WorkSheet,\n\tname?: string,\n\troll?: boolean,\n): string {\n\tlet i = 1;\n\tif (!name) {\n\t\tfor (; i <= 0xffff; ++i, name = undefined) {\n\t\t\tif (wb.SheetNames.indexOf((name = \"Sheet\" + i)) === -1) break;\n\t\t}\n\t}\n\tif (!name || wb.SheetNames.length >= 0xffff) throw new Error(\"Too many worksheets\");\n\tif (roll && wb.SheetNames.indexOf(name) >= 0 && name.length < 32) {\n\t\tconst m = name.match(/\\d+$/);\n\t\ti = (m && +m[0]) || 0;\n\t\tconst root = (m && name.slice(0, m.index)) || name;\n\t\tfor (++i; i <= 0xffff; ++i) {\n\t\t\tif (wb.SheetNames.indexOf((name = root + i)) === -1) break;\n\t\t}\n\t}\n\tcheck_ws_name(name!);\n\tif (wb.SheetNames.indexOf(name!) >= 0) throw new Error(\"Worksheet with name |\" + name + \"| already exists!\");\n\n\twb.SheetNames.push(name!);\n\twb.Sheets[name!] = ws;\n\treturn name!;\n}\n\n/** Create a new empty worksheet */\nexport function sheet_new(opts?: { dense?: boolean }): WorkSheet {\n\tconst out: any = {};\n\tif (opts?.dense) out[\"!data\"] = [];\n\treturn out as WorkSheet;\n}\n\n/** Find sheet index for given name or validate index */\nexport function wb_sheet_idx(wb: WorkBook, sh: number | string): number {\n\tif (typeof sh === \"number\") {\n\t\tif (sh >= 0 && wb.SheetNames.length > sh) return sh;\n\t\tthrow new Error(\"Cannot find sheet # \" + sh);\n\t} else if (typeof sh === \"string\") {\n\t\tconst idx = wb.SheetNames.indexOf(sh);\n\t\tif (idx > -1) return idx;\n\t\tthrow new Error(\"Cannot find sheet name |\" + sh + \"|\");\n\t}\n\tthrow new Error(\"Cannot find sheet |\" + sh + \"|\");\n}\n\n/** Set sheet visibility (0=visible, 1=hidden, 2=veryHidden) */\nexport function book_set_sheet_visibility(\n\twb: WorkBook,\n\tsh: number | string,\n\tvis: 0 | 1 | 2,\n): void {\n\tif (!wb.Workbook) wb.Workbook = {};\n\tif (!wb.Workbook.Sheets) wb.Workbook.Sheets = [];\n\n\tconst idx = wb_sheet_idx(wb, sh);\n\tif (!wb.Workbook.Sheets[idx]) wb.Workbook.Sheets[idx] = {};\n\n\tswitch (vis) {\n\t\tcase 0:\n\t\tcase 1:\n\t\tcase 2:\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tthrow new Error(\"Bad sheet visibility setting \" + vis);\n\t}\n\twb.Workbook.Sheets[idx].Hidden = vis;\n}\n\n/** Set a cell's number format */\nexport function cell_set_number_format(cell: CellObject, fmt: string | number): CellObject {\n\tcell.z = fmt;\n\treturn cell;\n}\n\n/** Set a cell's hyperlink */\nexport function cell_set_hyperlink(\n\tcell: CellObject,\n\ttarget?: string,\n\ttooltip?: string,\n): CellObject {\n\tif (!target) {\n\t\tdelete cell.l;\n\t} else {\n\t\tcell.l = { Target: target } as Hyperlink;\n\t\tif (tooltip) cell.l.Tooltip = tooltip;\n\t}\n\treturn cell;\n}\n\n/** Set an internal link (starts with #) on a cell */\nexport function cell_set_internal_link(\n\tcell: CellObject,\n\trange: string,\n\ttooltip?: string,\n): CellObject {\n\treturn cell_set_hyperlink(cell, \"#\" + range, tooltip);\n}\n\n/** Add a comment to a cell */\nexport function cell_add_comment(cell: CellObject, text: string, author?: string): void {\n\tif (!cell.c) cell.c = [] as any;\n\tcell.c!.push({ t: text, a: author || \"SheetJS\" });\n}\n\n/** Set an array formula on a range of cells */\nexport function sheet_set_array_formula(\n\tws: WorkSheet,\n\trange: string | { s: { r: number; c: number }; e: { r: number; c: number } },\n\tformula: string,\n\tdynamic?: boolean,\n): WorkSheet {\n\tconst rng = typeof range !== \"string\" ? range : safe_decode_range(range as string);\n\tconst rngstr = typeof range === \"string\" ? range : encode_range(range);\n\n\tfor (let R = rng.s.r; R <= rng.e.r; ++R) {\n\t\tfor (let C = rng.s.c; C <= rng.e.c; ++C) {\n\t\t\tconst ref = encode_col(C) + encode_row(R);\n\t\t\tconst dense = (ws as any)[\"!data\"] != null;\n\t\t\tlet cell: any;\n\t\t\tif (dense) {\n\t\t\t\tif (!(ws as any)[\"!data\"][R]) (ws as any)[\"!data\"][R] = [];\n\t\t\t\tcell = (ws as any)[\"!data\"][R][C] || ((ws as any)[\"!data\"][R][C] = { t: \"z\" });\n\t\t\t} else {\n\t\t\t\tcell = (ws as any)[ref] || ((ws as any)[ref] = { t: \"z\" });\n\t\t\t}\n\t\t\tcell.t = \"n\";\n\t\t\tcell.F = rngstr;\n\t\t\tdelete cell.v;\n\t\t\tif (R === rng.s.r && C === rng.s.c) {\n\t\t\t\tcell.f = formula;\n\t\t\t\tif (dynamic) cell.D = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (ws[\"!ref\"]) {\n\t\tconst wsr = decode_range(ws[\"!ref\"]);\n\t\tif (wsr.s.r > rng.s.r) wsr.s.r = rng.s.r;\n\t\tif (wsr.s.c > rng.s.c) wsr.s.c = rng.s.c;\n\t\tif (wsr.e.r < rng.e.r) wsr.e.r = rng.e.r;\n\t\tif (wsr.e.c < rng.e.c) wsr.e.c = rng.e.c;\n\t\tws[\"!ref\"] = encode_range(wsr);\n\t}\n\treturn ws;\n}\n\n/** Convert a worksheet to an array of formula strings */\nexport function sheet_to_formulae(ws: WorkSheet): string[] {\n\tif (ws == null || ws[\"!ref\"] == null) return [];\n\tconst r = safe_decode_range(ws[\"!ref\"]);\n\tconst cols: string[] = [];\n\tconst cmds: string[] = [];\n\tconst dense = (ws as any)[\"!data\"] != null;\n\n\tfor (let C = r.s.c; C <= r.e.c; ++C) cols[C] = encode_col(C);\n\n\tfor (let R = r.s.r; R <= r.e.r; ++R) {\n\t\tconst rr = encode_row(R);\n\t\tfor (let C = r.s.c; C <= r.e.c; ++C) {\n\t\t\tconst y = cols[C] + rr;\n\t\t\tconst x: any = dense ? ((ws as any)[\"!data\"][R] || [])[C] : (ws as any)[y];\n\t\t\tif (x === undefined) continue;\n\t\t\tlet val = \"\";\n\t\t\tlet ref = y;\n\t\t\tif (x.F != null) {\n\t\t\t\tref = x.F;\n\t\t\t\tif (!x.f) continue;\n\t\t\t\tval = x.f;\n\t\t\t\tif (ref.indexOf(\":\") === -1) ref = ref + \":\" + ref;\n\t\t\t}\n\t\t\tif (x.f != null) val = x.f;\n\t\t\telse if (x.t === \"z\") continue;\n\t\t\telse if (x.t === \"n\" && x.v != null) val = \"\" + x.v;\n\t\t\telse if (x.t === \"b\") val = x.v ? \"TRUE\" : \"FALSE\";\n\t\t\telse if (x.w !== undefined) val = \"'\" + x.w;\n\t\t\telse if (x.v === undefined) continue;\n\t\t\telse if (x.t === \"s\") val = \"'\" + x.v;\n\t\t\telse val = \"\" + x.v;\n\t\t\tcmds.push(ref + \"=\" + val);\n\t\t}\n\t}\n\treturn cmds;\n}\n","import type { WorkSheet, CellObject, AOA2SheetOpts, Range } from \"../types.js\";\nimport { decode_cell, encode_col, encode_range, encode_row, safe_decode_range } from \"../utils/cell.js\";\nimport { datenum, local_to_utc } from \"../utils/date.js\";\nimport { SSF_format } from \"../ssf/format.js\";\nimport { table_fmt } from \"../ssf/table.js\";\nimport { keys } from \"../utils/helpers.js\";\n\n/** Add an array of arrays to an existing (or new) worksheet */\nexport function sheet_add_aoa(\n\t_ws: WorkSheet | null,\n\tdata: any[][],\n\topts?: AOA2SheetOpts,\n): WorkSheet {\n\tconst o = opts || ({} as any);\n\tconst dense = _ws ? (_ws as any)[\"!data\"] != null : !!o.dense;\n\tconst ws: any = _ws || (dense ? { \"!data\": [] } : {});\n\tif (dense && !ws[\"!data\"]) ws[\"!data\"] = [];\n\n\tlet _R = 0,\n\t\t_C = 0;\n\tif (ws && o.origin != null) {\n\t\tif (typeof o.origin === \"number\") _R = o.origin;\n\t\telse {\n\t\t\tconst _origin = typeof o.origin === \"string\" ? decode_cell(o.origin) : o.origin;\n\t\t\t_R = _origin.r;\n\t\t\t_C = _origin.c;\n\t\t}\n\t}\n\n\tconst range: Range = { s: { c: 10000000, r: 10000000 }, e: { c: 0, r: 0 } };\n\tif (ws[\"!ref\"]) {\n\t\tconst _range = safe_decode_range(ws[\"!ref\"]);\n\t\trange.s.c = _range.s.c;\n\t\trange.s.r = _range.s.r;\n\t\trange.e.c = Math.max(range.e.c, _range.e.c);\n\t\trange.e.r = Math.max(range.e.r, _range.e.r);\n\t\tif (_R === -1) range.e.r = _R = ws[\"!ref\"] ? _range.e.r + 1 : 0;\n\t} else {\n\t\trange.s.c = range.e.c = range.s.r = range.e.r = 0;\n\t}\n\n\tlet row: any[] = [];\n\tlet seen = false;\n\tfor (let R = 0; R < data.length; ++R) {\n\t\tif (!data[R]) continue;\n\t\tif (!Array.isArray(data[R])) throw new Error(\"aoa_to_sheet expects an array of arrays\");\n\t\tconst __R = _R + R;\n\t\tif (dense) {\n\t\t\tif (!ws[\"!data\"][__R]) ws[\"!data\"][__R] = [];\n\t\t\trow = ws[\"!data\"][__R];\n\t\t}\n\t\tconst data_R = data[R];\n\t\tfor (let C = 0; C < data_R.length; ++C) {\n\t\t\tif (typeof data_R[C] === \"undefined\") continue;\n\t\t\tlet cell: any = { v: data_R[C], t: \"\" };\n\t\t\tconst __C = _C + C;\n\t\t\tif (range.s.r > __R) range.s.r = __R;\n\t\t\tif (range.s.c > __C) range.s.c = __C;\n\t\t\tif (range.e.r < __R) range.e.r = __R;\n\t\t\tif (range.e.c < __C) range.e.c = __C;\n\t\t\tseen = true;\n\n\t\t\tif (\n\t\t\t\tdata_R[C] &&\n\t\t\t\ttypeof data_R[C] === \"object\" &&\n\t\t\t\t!Array.isArray(data_R[C]) &&\n\t\t\t\t!(data_R[C] instanceof Date)\n\t\t\t) {\n\t\t\t\tcell = data_R[C];\n\t\t\t} else {\n\t\t\t\tif (Array.isArray(cell.v)) {\n\t\t\t\t\tcell.f = data_R[C][1];\n\t\t\t\t\tcell.v = cell.v[0];\n\t\t\t\t}\n\t\t\t\tif (cell.v === null) {\n\t\t\t\t\tif (cell.f) cell.t = \"n\";\n\t\t\t\t\telse if (o.nullError) {\n\t\t\t\t\t\tcell.t = \"e\";\n\t\t\t\t\t\tcell.v = 0;\n\t\t\t\t\t} else if (!o.sheetStubs) continue;\n\t\t\t\t\telse cell.t = \"z\";\n\t\t\t\t} else if (typeof cell.v === \"number\") {\n\t\t\t\t\tif (isFinite(cell.v)) cell.t = \"n\";\n\t\t\t\t\telse if (isNaN(cell.v)) {\n\t\t\t\t\t\tcell.t = \"e\";\n\t\t\t\t\t\tcell.v = 0x0f;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.t = \"e\";\n\t\t\t\t\t\tcell.v = 0x07;\n\t\t\t\t\t}\n\t\t\t\t} else if (typeof cell.v === \"boolean\") {\n\t\t\t\t\tcell.t = \"b\";\n\t\t\t\t} else if (cell.v instanceof Date) {\n\t\t\t\t\tcell.z = o.dateNF || table_fmt[14];\n\t\t\t\t\tif (!o.UTC) cell.v = local_to_utc(cell.v);\n\t\t\t\t\tif (o.cellDates) {\n\t\t\t\t\t\tcell.t = \"d\";\n\t\t\t\t\t\tcell.w = SSF_format(cell.z, datenum(cell.v, o.date1904));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.t = \"n\";\n\t\t\t\t\t\tcell.v = datenum(cell.v, o.date1904);\n\t\t\t\t\t\tcell.w = SSF_format(cell.z, cell.v);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tcell.t = \"s\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (dense) {\n\t\t\t\tif (row[__C] && row[__C].z) cell.z = row[__C].z;\n\t\t\t\trow[__C] = cell;\n\t\t\t} else {\n\t\t\t\tconst cell_ref = encode_col(__C) + (__R + 1);\n\t\t\t\tif (ws[cell_ref] && ws[cell_ref].z) cell.z = ws[cell_ref].z;\n\t\t\t\tws[cell_ref] = cell;\n\t\t\t}\n\t\t}\n\t}\n\tif (seen && range.s.c < 10400000) ws[\"!ref\"] = encode_range(range);\n\treturn ws as WorkSheet;\n}\n\n/** Create a new worksheet from an array of arrays */\nexport function aoa_to_sheet(data: any[][], opts?: AOA2SheetOpts): WorkSheet {\n\treturn sheet_add_aoa(null, data, opts);\n}\n","/** Number Format (either a string or an index to the format table) */\nexport type NumberFormat = string | number;\n\n/** Basic File Properties */\nexport interface Properties {\n\tTitle?: string;\n\tSubject?: string;\n\tAuthor?: string;\n\tManager?: string;\n\tCompany?: string;\n\tCategory?: string;\n\tKeywords?: string;\n\tComments?: string;\n\tLastAuthor?: string;\n\tCreatedDate?: Date;\n}\n\n/** Extended File Properties */\nexport interface FullProperties extends Properties {\n\tModifiedDate?: Date;\n\tApplication?: string;\n\tAppVersion?: string;\n\tDocSecurity?: string;\n\tHyperlinksChanged?: boolean;\n\tSharedDoc?: boolean;\n\tLinksUpToDate?: boolean;\n\tScaleCrop?: boolean;\n\tWorksheets?: number;\n\tSheetNames?: string[];\n\tContentStatus?: string;\n\tLastPrinted?: string;\n\tRevision?: string | number;\n\tVersion?: string;\n\tIdentifier?: string;\n\tLanguage?: string;\n}\n\nexport interface CommonOptions {\n\tWTF?: boolean;\n\tbookVBA?: boolean;\n\tcellDates?: boolean;\n\tsheetStubs?: boolean;\n\tcellStyles?: boolean;\n\tpassword?: string;\n}\n\nexport interface ReadOptions extends CommonOptions {\n\ttype?: \"base64\" | \"buffer\" | \"array\";\n\tcellFormula?: boolean;\n\tcellHTML?: boolean;\n\tcellNF?: boolean;\n\tcellText?: boolean;\n\tdateNF?: string;\n\tsheetRows?: number;\n\tbookDeps?: boolean;\n\tbookFiles?: boolean;\n\tbookProps?: boolean;\n\tbookSheets?: boolean;\n\tsheets?: number | string | Array<number | string>;\n\tnodim?: boolean;\n\txlfn?: boolean;\n\tdense?: boolean;\n\tUTC?: boolean;\n}\n\nexport interface WriteOptions extends CommonOptions {\n\ttype?: \"base64\" | \"buffer\" | \"array\";\n\tbookSST?: boolean;\n\tcompression?: boolean;\n\tthemeXLSX?: string;\n\tignoreEC?: boolean;\n\tProps?: Properties;\n}\n\n/** The Excel data type for a cell: b Boolean, n Number, e Error, s String, d Date, z Empty */\nexport type ExcelDataType = \"b\" | \"n\" | \"e\" | \"s\" | \"d\" | \"z\";\n\n/** Comment element */\nexport interface Comment {\n\ta?: string;\n\tt: string;\n\tT?: boolean;\n}\n\n/** Cell comments */\nexport interface Comments extends Array<Comment> {\n\thidden?: boolean;\n}\n\n/** Link object */\nexport interface Hyperlink {\n\tTarget: string;\n\tTooltip?: string;\n}\n\n/** Worksheet Cell Object */\nexport interface CellObject {\n\tv?: string | number | boolean | Date;\n\tw?: string;\n\tt: ExcelDataType;\n\tf?: string;\n\tF?: string;\n\tD?: boolean;\n\tr?: any;\n\th?: string;\n\tc?: Comments;\n\tz?: NumberFormat;\n\tl?: Hyperlink;\n\ts?: any;\n\tXF?: { numFmtId?: number };\n}\n\n/** Simple Cell Address */\nexport interface CellAddress {\n\tc: number;\n\tr: number;\n}\n\n/** Range object (representing ranges like \"A1:B2\") */\nexport interface Range {\n\ts: CellAddress;\n\te: CellAddress;\n}\n\n/** Column Properties Object */\nexport interface ColInfo {\n\thidden?: boolean;\n\twidth?: number;\n\twpx?: number;\n\twch?: number;\n\tlevel?: number;\n\tMDW?: number;\n}\n\n/** Row Properties Object */\nexport interface RowInfo {\n\thidden?: boolean;\n\thpx?: number;\n\thpt?: number;\n\tlevel?: number;\n}\n\n/** Sheet Protection Properties */\nexport interface ProtectInfo {\n\tpassword?: string;\n\tselectLockedCells?: boolean;\n\tselectUnlockedCells?: boolean;\n\tformatCells?: boolean;\n\tformatColumns?: boolean;\n\tformatRows?: boolean;\n\tinsertColumns?: boolean;\n\tinsertRows?: boolean;\n\tinsertHyperlinks?: boolean;\n\tdeleteColumns?: boolean;\n\tdeleteRows?: boolean;\n\tsort?: boolean;\n\tautoFilter?: boolean;\n\tpivotTables?: boolean;\n\tobjects?: boolean;\n\tscenarios?: boolean;\n}\n\n/** Page Margins */\nexport interface MarginInfo {\n\tleft?: number;\n\tright?: number;\n\ttop?: number;\n\tbottom?: number;\n\theader?: number;\n\tfooter?: number;\n}\n\n/** AutoFilter properties */\nexport interface AutoFilterInfo {\n\tref: string;\n}\n\nexport type DenseSheetData = ((CellObject | undefined)[] | undefined)[];\n\n/** General object representing a Sheet */\nexport interface Sheet {\n\t[cell: string]: any;\n\t\"!data\"?: DenseSheetData;\n\t\"!type\"?: \"sheet\" | \"chart\";\n\t\"!ref\"?: string;\n\t\"!margins\"?: MarginInfo;\n}\n\n/** Worksheet Object */\nexport interface WorkSheet extends Sheet {\n\t\"!cols\"?: ColInfo[];\n\t\"!rows\"?: RowInfo[];\n\t\"!merges\"?: Range[];\n\t\"!protect\"?: ProtectInfo;\n\t\"!autofilter\"?: AutoFilterInfo;\n}\n\n/** Sheet Properties */\nexport interface SheetProps {\n\tname?: string;\n\tHidden?: 0 | 1 | 2;\n\tCodeName?: string;\n}\n\n/** Defined Name Object */\nexport interface DefinedName {\n\tName: string;\n\tRef: string;\n\tSheet?: number;\n\tComment?: string;\n\tHidden?: boolean;\n}\n\n/** Workbook View */\nexport interface WBView {\n\tRTL?: boolean;\n}\n\n/** Other Workbook Properties */\nexport interface WorkbookProperties {\n\tdate1904?: boolean;\n\tfilterPrivacy?: boolean;\n\tCodeName?: string;\n}\n\n/** Workbook-Level Attributes */\nexport interface WBProps {\n\tSheets?: SheetProps[];\n\tNames?: DefinedName[];\n\tViews?: WBView[];\n\tWBProps?: WorkbookProperties;\n}\n\n/** Workbook Object */\nexport interface WorkBook {\n\tSheets: { [sheet: string]: WorkSheet };\n\tSheetNames: string[];\n\tProps?: FullProperties;\n\tCustprops?: Record<string, any>;\n\tWorkbook?: WBProps;\n\tvbaraw?: any;\n\tbookType?: string;\n}\n\n/** CSV output options */\nexport interface Sheet2CSVOpts {\n\tFS?: string;\n\tRS?: string;\n\tstrip?: boolean;\n\tblankrows?: boolean;\n\tskipHidden?: boolean;\n\tforceQuotes?: boolean;\n\trawNumbers?: boolean;\n\tdateNF?: NumberFormat;\n}\n\n/** HTML output options */\nexport interface Sheet2HTMLOpts {\n\tid?: string;\n\teditable?: boolean;\n\theader?: string;\n\tfooter?: string;\n\tsanitizeLinks?: boolean;\n}\n\n/** JSON output options */\nexport interface Sheet2JSONOpts {\n\theader?: \"A\" | number | string[];\n\trange?: any;\n\tblankrows?: boolean;\n\tdefval?: any;\n\traw?: boolean;\n\tskipHidden?: boolean;\n\trawNumbers?: boolean;\n\tUTC?: boolean;\n\tdateNF?: NumberFormat;\n}\n\n/** AOA to sheet options */\nexport interface AOA2SheetOpts extends CommonOptions {\n\tdense?: boolean;\n\tsheetStubs?: boolean;\n\tdateNF?: NumberFormat;\n\tcellDates?: boolean;\n\tUTC?: boolean;\n\tdate1904?: boolean;\n\torigin?: number | string | CellAddress;\n\tnullError?: boolean;\n}\n\n/** JSON to sheet options */\nexport interface JSON2SheetOpts extends CommonOptions {\n\theader?: string[];\n\tskipHeader?: boolean;\n\tdense?: boolean;\n\tdateNF?: NumberFormat;\n\tcellDates?: boolean;\n\tUTC?: boolean;\n\tdate1904?: boolean;\n\torigin?: number | string | CellAddress;\n\tnullError?: boolean;\n}\n\n/** Error codes */\nexport const BErr: Record<number, string> = {\n\t0x00: \"#NULL!\",\n\t0x07: \"#DIV/0!\",\n\t0x0f: \"#VALUE!\",\n\t0x17: \"#REF!\",\n\t0x1d: \"#NAME?\",\n\t0x24: \"#NUM!\",\n\t0x2a: \"#N/A\",\n\t0x2b: \"#GETTING_DATA\",\n};\n\n/** Reverse error map */\nexport const RBErr: Record<string, number> = {};\nfor (const [k, v] of Object.entries(BErr)) {\n\tRBErr[v] = +k;\n}\n","import type { CellObject } from \"../types.js\";\nimport { BErr } from \"../types.js\";\nimport { SSF_format } from \"../ssf/format.js\";\nimport { datenum } from \"../utils/date.js\";\n\nfunction safe_format_cell(cell: CellObject, v: any): string {\n\tconst q = cell.t === \"d\" && v instanceof Date;\n\tif (cell.z != null) {\n\t\ttry {\n\t\t\treturn (cell.w = SSF_format(cell.z, q ? datenum(v) : v));\n\t\t} catch {}\n\t}\n\ttry {\n\t\treturn (cell.w = SSF_format((cell.XF || {}).numFmtId || (q ? 14 : 0), q ? datenum(v) : v));\n\t} catch {\n\t\treturn \"\" + v;\n\t}\n}\n\nexport function format_cell(cell: CellObject, v?: any, o?: any): string {\n\tif (cell == null || cell.t == null || cell.t === \"z\") return \"\";\n\tif (cell.w !== undefined) return cell.w;\n\tif (cell.t === \"d\" && !cell.z && o && o.dateNF) cell.z = o.dateNF;\n\tif (cell.t === \"e\") return BErr[cell.v as number] || String(cell.v);\n\tif (v == null) return safe_format_cell(cell, cell.v);\n\treturn safe_format_cell(cell, v);\n}\n","import type { WorkSheet, Sheet2JSONOpts, JSON2SheetOpts, CellObject, Range } from \"../types.js\";\nimport { BErr } from \"../types.js\";\nimport { decode_cell, encode_col, encode_row, encode_range, safe_decode_range } from \"../utils/cell.js\";\nimport { datenum, numdate, utc_to_local, local_to_utc } from \"../utils/date.js\";\nimport { fmt_is_date } from \"../ssf/format.js\";\nimport { table_fmt } from \"../ssf/table.js\";\nimport { SSF_format } from \"../ssf/format.js\";\nimport { keys } from \"../utils/helpers.js\";\nimport { format_cell } from \"./format.js\";\n\nfunction make_json_row(\n\tsheet: WorkSheet,\n\tr: Range,\n\tR: number,\n\tcols: string[],\n\theader: number,\n\thdr: any[],\n\to: any,\n): { row: any; isempty: boolean } {\n\tconst rr = encode_row(R);\n\tconst defval = o.defval;\n\tconst raw = o.raw || !Object.prototype.hasOwnProperty.call(o, \"raw\");\n\tlet isempty = true;\n\tconst dense = (sheet as any)[\"!data\"] != null;\n\tconst row: any = header === 1 ? [] : {};\n\n\tif (header !== 1) {\n\t\ttry {\n\t\t\tObject.defineProperty(row, \"__rowNum__\", { value: R, enumerable: false });\n\t\t} catch {\n\t\t\trow.__rowNum__ = R;\n\t\t}\n\t}\n\n\tif (!dense || (sheet as any)[\"!data\"][R]) {\n\t\tfor (let C = r.s.c; C <= r.e.c; ++C) {\n\t\t\tconst val: CellObject | undefined = dense\n\t\t\t\t? ((sheet as any)[\"!data\"][R] || [])[C]\n\t\t\t\t: (sheet as any)[cols[C] + rr];\n\t\t\tif (val == null || val.t === undefined) {\n\t\t\t\tif (defval === undefined) continue;\n\t\t\t\tif (hdr[C] != null) row[hdr[C]] = defval;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tlet v: any = val.v;\n\t\t\tswitch (val.t) {\n\t\t\t\tcase \"z\":\n\t\t\t\t\tif (v == null) break;\n\t\t\t\t\tcontinue;\n\t\t\t\tcase \"e\":\n\t\t\t\t\tv = v === 0 ? null : undefined;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"s\":\n\t\t\t\tcase \"b\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"n\":\n\t\t\t\t\tif (!val.z || !fmt_is_date(String(val.z))) break;\n\t\t\t\t\tv = numdate(v as number);\n\t\t\t\t\tif (typeof v === \"number\") break;\n\t\t\t\t/* falls through */\n\t\t\t\tcase \"d\":\n\t\t\t\t\tif (!(o && (o.UTC || o.raw === false))) v = utc_to_local(new Date(v));\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error(\"unrecognized type \" + val.t);\n\t\t\t}\n\t\t\tif (hdr[C] != null) {\n\t\t\t\tif (v == null) {\n\t\t\t\t\tif (val.t === \"e\" && v === null) row[hdr[C]] = null;\n\t\t\t\t\telse if (defval !== undefined) row[hdr[C]] = defval;\n\t\t\t\t\telse if (raw && v === null) row[hdr[C]] = null;\n\t\t\t\t\telse continue;\n\t\t\t\t} else {\n\t\t\t\t\trow[hdr[C]] =\n\t\t\t\t\t\t(val.t === \"n\" && typeof o.rawNumbers === \"boolean\" ? o.rawNumbers : raw)\n\t\t\t\t\t\t\t? v\n\t\t\t\t\t\t\t: format_cell(val, v, o);\n\t\t\t\t}\n\t\t\t\tif (v != null) isempty = false;\n\t\t\t}\n\t\t}\n\t}\n\treturn { row, isempty };\n}\n\n/** Convert a worksheet to an array of JSON objects */\nexport function sheet_to_json<T = any>(sheet: WorkSheet, opts?: Sheet2JSONOpts): T[] {\n\tif (sheet == null || sheet[\"!ref\"] == null) return [];\n\tlet header = 0,\n\t\toffset = 1;\n\tconst hdr: any[] = [];\n\tconst o: any = opts || {};\n\tconst range = o.range != null ? o.range : sheet[\"!ref\"];\n\n\tif (o.header === 1) header = 1;\n\telse if (o.header === \"A\") header = 2;\n\telse if (Array.isArray(o.header)) header = 3;\n\telse if (o.header == null) header = 0;\n\n\tlet r: Range;\n\tswitch (typeof range) {\n\t\tcase \"string\":\n\t\t\tr = safe_decode_range(range);\n\t\t\tbreak;\n\t\tcase \"number\":\n\t\t\tr = safe_decode_range(sheet[\"!ref\"]!);\n\t\t\tr.s.r = range;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tr = range;\n\t}\n\tif (header > 0) offset = 0;\n\n\tconst rr = encode_row(r.s.r);\n\tconst cols: string[] = [];\n\tconst out: any[] = [];\n\tlet outi = 0;\n\tconst dense = (sheet as any)[\"!data\"] != null;\n\tlet R = r.s.r;\n\tconst header_cnt: Record<string, number> = {};\n\tif (dense && !(sheet as any)[\"!data\"][R]) (sheet as any)[\"!data\"][R] = [];\n\tconst colinfo: any[] = (o.skipHidden && sheet[\"!cols\"]) || [];\n\tconst rowinfo: any[] = (o.skipHidden && sheet[\"!rows\"]) || [];\n\n\tfor (let C = r.s.c; C <= r.e.c; ++C) {\n\t\tif ((colinfo[C] || {}).hidden) continue;\n\t\tcols[C] = encode_col(C);\n\t\tconst val: CellObject | undefined = dense\n\t\t\t? (sheet as any)[\"!data\"][R][C]\n\t\t\t: (sheet as any)[cols[C] + rr];\n\t\tlet v: any, vv: any;\n\t\tswitch (header) {\n\t\t\tcase 1:\n\t\t\t\thdr[C] = C - r.s.c;\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\thdr[C] = cols[C];\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\thdr[C] = (o.header as string[])[C - r.s.c];\n\t\t\t\tbreak;\n\t\t\tdefault: {\n\t\t\t\tconst _val = val == null ? { w: \"__EMPTY\", t: \"s\" } : val;\n\t\t\t\tvv = v = format_cell(_val as CellObject, null, o);\n\t\t\t\tlet counter = header_cnt[v] || 0;\n\t\t\t\tif (!counter) header_cnt[v] = 1;\n\t\t\t\telse {\n\t\t\t\t\tdo {\n\t\t\t\t\t\tvv = v + \"_\" + counter++;\n\t\t\t\t\t} while (header_cnt[vv]);\n\t\t\t\t\theader_cnt[v] = counter;\n\t\t\t\t\theader_cnt[vv] = 1;\n\t\t\t\t}\n\t\t\t\thdr[C] = vv;\n\t\t\t}\n\t\t}\n\t}\n\n\tfor (R = r.s.r + offset; R <= r.e.r; ++R) {\n\t\tif ((rowinfo[R] || {}).hidden) continue;\n\t\tconst row = make_json_row(sheet, r, R, cols, header, hdr, o);\n\t\tif (row.isempty === false || (header === 1 ? o.blankrows !== false : !!o.blankrows))\n\t\t\tout[outi++] = row.row;\n\t}\n\tout.length = outi;\n\treturn out;\n}\n\n/** Add JSON data to a worksheet */\nexport function sheet_add_json(\n\t_ws: WorkSheet | null,\n\tjs: any[],\n\topts?: JSON2SheetOpts,\n): WorkSheet {\n\tconst o: any = opts || {};\n\tconst dense = _ws ? (_ws as any)[\"!data\"] != null : !!o.dense;\n\tconst offset = +!o.skipHeader;\n\tconst ws: any = _ws || {};\n\tif (!_ws && dense) ws[\"!data\"] = [];\n\n\tlet _R = 0,\n\t\t_C = 0;\n\tif (ws && o.origin != null) {\n\t\tif (typeof o.origin === \"number\") _R = o.origin;\n\t\telse {\n\t\t\tconst _origin = typeof o.origin === \"string\" ? decode_cell(o.origin) : o.origin;\n\t\t\t_R = _origin.r;\n\t\t\t_C = _origin.c;\n\t\t}\n\t}\n\n\tconst range: Range = { s: { c: 0, r: 0 }, e: { c: _C, r: _R + js.length - 1 + offset } };\n\tif (ws[\"!ref\"]) {\n\t\tconst _range = safe_decode_range(ws[\"!ref\"]);\n\t\trange.e.c = Math.max(range.e.c, _range.e.c);\n\t\trange.e.r = Math.max(range.e.r, _range.e.r);\n\t\tif (_R === -1) {\n\t\t\t_R = _range.e.r + 1;\n\t\t\trange.e.r = _R + js.length - 1 + offset;\n\t\t}\n\t} else {\n\t\tif (_R === -1) {\n\t\t\t_R = 0;\n\t\t\trange.e.r = js.length - 1 + offset;\n\t\t}\n\t}\n\n\tconst hdr: string[] = o.header || [];\n\tlet C = 0;\n\tjs.forEach((JS, R) => {\n\t\tif (dense && !ws[\"!data\"][_R + R + offset]) ws[\"!data\"][_R + R + offset] = [];\n\t\tconst ROW = dense ? ws[\"!data\"][_R + R + offset] : null;\n\t\tkeys(JS).forEach((k: string) => {\n\t\t\tif ((C = hdr.indexOf(k)) === -1) hdr[(C = hdr.length)] = k;\n\t\t\tlet v = JS[k];\n\t\t\tlet t = \"z\";\n\t\t\tlet z = \"\";\n\t\t\tconst ref = dense ? \"\" : encode_col(_C + C) + encode_row(_R + R + offset);\n\t\t\tconst cell: any = dense ? ROW[_C + C] : ws[ref];\n\n\t\t\tif (v && typeof v === \"object\" && !(v instanceof Date)) {\n\t\t\t\tif (dense) ROW[_C + C] = v;\n\t\t\t\telse ws[ref] = v;\n\t\t\t} else {\n\t\t\t\tif (typeof v === \"number\") t = \"n\";\n\t\t\t\telse if (typeof v === \"boolean\") t = \"b\";\n\t\t\t\telse if (typeof v === \"string\") t = \"s\";\n\t\t\t\telse if (v instanceof Date) {\n\t\t\t\t\tt = \"d\";\n\t\t\t\t\tif (!o.UTC) v = local_to_utc(v);\n\t\t\t\t\tif (!o.cellDates) {\n\t\t\t\t\t\tt = \"n\";\n\t\t\t\t\t\tv = datenum(v);\n\t\t\t\t\t}\n\t\t\t\t\tz = (cell != null && cell.z && fmt_is_date(String(cell.z))) ? String(cell.z) : (o.dateNF || table_fmt[14]);\n\t\t\t\t} else if (v === null && o.nullError) {\n\t\t\t\t\tt = \"e\";\n\t\t\t\t\tv = 0;\n\t\t\t\t}\n\n\t\t\t\tif (!cell) {\n\t\t\t\t\tconst newCell: any = { t, v };\n\t\t\t\t\tif (z) newCell.z = z;\n\t\t\t\t\tif (dense) ROW[_C + C] = newCell;\n\t\t\t\t\telse ws[ref] = newCell;\n\t\t\t\t} else {\n\t\t\t\t\tcell.t = t;\n\t\t\t\t\tcell.v = v;\n\t\t\t\t\tdelete cell.w;\n\t\t\t\t\tif (z) cell.z = z;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n\n\trange.e.c = Math.max(range.e.c, _C + hdr.length - 1);\n\tconst __R = encode_row(_R);\n\tif (dense && !ws[\"!data\"][_R]) ws[\"!data\"][_R] = [];\n\tif (offset) {\n\t\tfor (C = 0; C < hdr.length; ++C) {\n\t\t\tif (dense) ws[\"!data\"][_R][C + _C] = { t: \"s\", v: hdr[C] };\n\t\t\telse ws[encode_col(C + _C) + __R] = { t: \"s\", v: hdr[C] };\n\t\t}\n\t}\n\tws[\"!ref\"] = encode_range(range);\n\treturn ws as WorkSheet;\n}\n\n/** Create a new worksheet from JSON data */\nexport function json_to_sheet(js: any[], opts?: JSON2SheetOpts): WorkSheet {\n\treturn sheet_add_json(null, js, opts);\n}\n","import type { WorkSheet, Sheet2CSVOpts, Range } from \"../types.js\";\nimport { encode_col, encode_row, safe_decode_range } from \"../utils/cell.js\";\nimport { format_cell } from \"./format.js\";\n\nconst qreg = /\"/g;\n\nfunction make_csv_row(\n\tsheet: WorkSheet,\n\tr: Range,\n\tR: number,\n\tcols: string[],\n\tfs: number,\n\trs: number,\n\tFS: string,\n\tw: number,\n\to: any,\n): string | null {\n\tlet isempty = true;\n\tconst row: string[] = [];\n\tconst rr = encode_row(R);\n\tconst dense = (sheet as any)[\"!data\"] != null;\n\tconst datarow = dense ? (sheet as any)[\"!data\"][R] || [] : [];\n\n\tfor (let C = r.s.c; C <= r.e.c; ++C) {\n\t\tif (!cols[C]) continue;\n\t\tconst val = dense ? datarow[C] : (sheet as any)[cols[C] + rr];\n\t\tlet txt = \"\";\n\t\tif (val == null) txt = \"\";\n\t\telse if (val.v != null) {\n\t\t\tisempty = false;\n\t\t\ttxt = \"\" + (o.rawNumbers && val.t === \"n\" ? val.v : format_cell(val, null, o));\n\t\t\tfor (let i = 0, cc = 0; i !== txt.length; ++i) {\n\t\t\t\tif (\n\t\t\t\t\t(cc = txt.charCodeAt(i)) === fs ||\n\t\t\t\t\tcc === rs ||\n\t\t\t\t\tcc === 10 ||\n\t\t\t\t\tcc === 13 ||\n\t\t\t\t\tcc === 34 ||\n\t\t\t\t\to.forceQuotes\n\t\t\t\t) {\n\t\t\t\t\ttxt = '\"' + txt.replace(qreg, '\"\"') + '\"';\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (txt === \"ID\" && w === 0 && row.length === 0) txt = '\"ID\"';\n\t\t} else if (val.f != null && !val.F) {\n\t\t\tisempty = false;\n\t\t\ttxt = \"=\" + val.f;\n\t\t\tif (txt.indexOf(\",\") >= 0) txt = '\"' + txt.replace(qreg, '\"\"') + '\"';\n\t\t} else txt = \"\";\n\t\trow.push(txt);\n\t}\n\tif (o.strip) while (row[row.length - 1] === \"\") --row.length;\n\tif (o.blankrows === false && isempty) return null;\n\treturn row.join(FS);\n}\n\n/** Convert a worksheet to CSV string */\nexport function sheet_to_csv(sheet: WorkSheet, opts?: Sheet2CSVOpts): string {\n\tconst out: string[] = [];\n\tconst o: any = opts == null ? {} : opts;\n\tif (sheet == null || sheet[\"!ref\"] == null) return \"\";\n\tconst r = safe_decode_range(sheet[\"!ref\"]);\n\tconst FS = o.FS !== undefined ? o.FS : \",\";\n\tconst fs = FS.charCodeAt(0);\n\tconst RS = o.RS !== undefined ? o.RS : \"\\n\";\n\tconst rs = RS.charCodeAt(0);\n\tconst cols: string[] = [];\n\tconst colinfo: any[] = (o.skipHidden && sheet[\"!cols\"]) || [];\n\tconst rowinfo: any[] = (o.skipHidden && sheet[\"!rows\"]) || [];\n\n\tfor (let C = r.s.c; C <= r.e.c; ++C) {\n\t\tif (!((colinfo[C] || {}).hidden)) cols[C] = encode_col(C);\n\t}\n\n\tlet w = 0;\n\tfor (let R = r.s.r; R <= r.e.r; ++R) {\n\t\tif ((rowinfo[R] || {}).hidden) continue;\n\t\tconst row = make_csv_row(sheet, r, R, cols, fs, rs, FS, w, o);\n\t\tif (row == null) continue;\n\t\tif (row || o.blankrows !== false) out.push((w++ ? RS : \"\") + row);\n\t}\n\treturn out.join(\"\");\n}\n\n/** Convert a worksheet to tab-separated text */\nexport function sheet_to_txt(sheet: WorkSheet, opts?: Sheet2CSVOpts): string {\n\tconst o: any = opts || {};\n\to.FS = \"\\t\";\n\to.RS = \"\\n\";\n\treturn sheet_to_csv(sheet, o);\n}\n","import type { WorkSheet, Sheet2HTMLOpts, Range } from \"../types.js\";\nimport { BErr } from \"../types.js\";\nimport { encode_col, encode_row, decode_range } from \"../utils/cell.js\";\nimport { escapehtml } from \"../xml/escape.js\";\nimport { writextag } from \"../xml/writer.js\";\nimport { format_cell } from \"./format.js\";\n\nconst HTML_BEGIN = '<html><head><meta charset=\"utf-8\"/><title>SheetJS Table Export</title></head><body>';\nconst HTML_END = \"</body></html>\";\n\nfunction make_html_row(ws: WorkSheet, r: Range, R: number, o: Sheet2HTMLOpts): string {\n\tconst M = ws[\"!merges\"] || [];\n\tconst oo: string[] = [];\n\tconst dense = (ws as any)[\"!data\"] != null;\n\n\tfor (let C = r.s.c; C <= r.e.c; ++C) {\n\t\tlet RS = 0,\n\t\t\tCS = 0;\n\t\tfor (let j = 0; j < M.length; ++j) {\n\t\t\tif (M[j].s.r > R || M[j].s.c > C) continue;\n\t\t\tif (M[j].e.r < R || M[j].e.c < C) continue;\n\t\t\tif (M[j].s.r < R || M[j].s.c < C) {\n\t\t\t\tRS = -1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tRS = M[j].e.r - M[j].s.r + 1;\n\t\t\tCS = M[j].e.c - M[j].s.c + 1;\n\t\t\tbreak;\n\t\t}\n\t\tif (RS < 0) continue;\n\n\t\tconst coord = encode_col(C) + encode_row(R);\n\t\tlet cell: any = dense ? ((ws as any)[\"!data\"][R] || [])[C] : (ws as any)[coord];\n\n\t\tif (cell && cell.t === \"n\" && cell.v != null && !isFinite(cell.v)) {\n\t\t\tif (isNaN(cell.v)) cell = { t: \"e\", v: 0x24, w: BErr[0x24] };\n\t\t\telse cell = { t: \"e\", v: 0x07, w: BErr[0x07] };\n\t\t}\n\n\t\tlet w =\n\t\t\t((cell && cell.v != null) && (cell.h || escapehtml(cell.w || (format_cell(cell), cell.w) || \"\"))) || \"\";\n\n\t\tconst sp: Record<string, any> = {};\n\t\tif (RS > 1) sp.rowspan = String(RS);\n\t\tif (CS > 1) sp.colspan = String(CS);\n\n\t\tif (o.editable) {\n\t\t\tw = '<span contenteditable=\"true\">' + w + \"</span>\";\n\t\t} else if (cell) {\n\t\t\tsp[\"data-t\"] = (cell && cell.t) || \"z\";\n\t\t\tif (cell.v != null) sp[\"data-v\"] = escapehtml(cell.v instanceof Date ? cell.v.toISOString() : String(cell.v));\n\t\t\tif (cell.z != null) sp[\"data-z\"] = String(cell.z);\n\t\t\tif (cell.f != null) sp[\"data-f\"] = escapehtml(cell.f);\n\t\t\tif (\n\t\t\t\tcell.l &&\n\t\t\t\t(cell.l.Target || \"#\").charAt(0) !== \"#\" &&\n\t\t\t\t(!o.sanitizeLinks ||\n\t\t\t\t\t(cell.l.Target || \"\").slice(0, 11).toLowerCase() !== \"javascript:\")\n\t\t\t) {\n\t\t\t\tw = '<a href=\"' + escapehtml(cell.l.Target) + '\">' + w + \"</a>\";\n\t\t\t}\n\t\t}\n\t\tsp.id = (o.id || \"sjs\") + \"-\" + coord;\n\t\too.push(writextag(\"td\", w, sp));\n\t}\n\n\treturn \"<tr>\" + oo.join(\"\") + \"</tr>\";\n}\n\nfunction make_html_preamble(_ws: WorkSheet, _r: Range, o: Sheet2HTMLOpts): string {\n\treturn \"<table\" + (o && o.id ? ' id=\"' + o.id + '\"' : \"\") + \">\";\n}\n\n/** Convert a worksheet to an HTML table string */\nexport function sheet_to_html(ws: WorkSheet, opts?: Sheet2HTMLOpts): string {\n\tconst o: Sheet2HTMLOpts = opts || {};\n\tconst header = o.header != null ? o.header : HTML_BEGIN;\n\tconst footer = o.footer != null ? o.footer : HTML_END;\n\tconst out: string[] = [header];\n\tconst r = decode_range(ws[\"!ref\"] || \"A1\");\n\tout.push(make_html_preamble(ws, r, o));\n\tif (ws[\"!ref\"]) {\n\t\tfor (let R = r.s.r; R <= r.e.r; ++R) out.push(make_html_row(ws, r, R, o));\n\t}\n\tout.push(\"</table>\" + footer);\n\treturn out.join(\"\");\n}\n","// xlsx-format - Modern TypeScript XLSX parser and writer\n// Public API\n\n// Types\nexport type {\n\tWorkBook,\n\tWorkSheet,\n\tCellObject,\n\tCellAddress,\n\tRange,\n\tProperties,\n\tFullProperties,\n\tReadOptions,\n\tWriteOptions,\n\tExcelDataType,\n\tComment,\n\tComments,\n\tHyperlink,\n\tColInfo,\n\tRowInfo,\n\tMarginInfo,\n\tProtectInfo,\n\tAutoFilterInfo,\n\tDenseSheetData,\n\tSheet,\n\tSheetProps,\n\tDefinedName,\n\tWBView,\n\tWorkbookProperties,\n\tWBProps,\n\tSheet2CSVOpts,\n\tSheet2HTMLOpts,\n\tSheet2JSONOpts,\n\tAOA2SheetOpts,\n\tJSON2SheetOpts,\n\tNumberFormat,\n} from \"./types.js\";\n\n// Read / Write\nexport { read, readFile } from \"./read.js\";\nexport { write, writeFile } from \"./write.js\";\n\n// Utilities - workbook/sheet manipulation\nexport {\n\tbook_new,\n\tbook_append_sheet,\n\tbook_set_sheet_visibility,\n\tsheet_new,\n\twb_sheet_idx,\n\tcell_set_number_format,\n\tcell_set_hyperlink,\n\tcell_set_internal_link,\n\tcell_add_comment,\n\tsheet_set_array_formula,\n\tsheet_to_formulae,\n} from \"./api/book.js\";\n\n// Utilities - format conversions\nexport { aoa_to_sheet, sheet_add_aoa } from \"./api/aoa.js\";\nexport { json_to_sheet, sheet_to_json, sheet_add_json } from \"./api/json.js\";\nexport { sheet_to_csv, sheet_to_txt } from \"./api/csv.js\";\nexport { sheet_to_html } from \"./api/html.js\";\nexport { format_cell } from \"./api/format.js\";\n\n// Cell utilities\nexport {\n\tdecode_cell,\n\tencode_cell,\n\tdecode_range,\n\tencode_range,\n\tdecode_col,\n\tencode_col,\n\tdecode_row,\n\tencode_row,\n} from \"./utils/cell.js\";\n\n// SSF (Number Formatting)\nexport { SSF_format } from \"./ssf/format.js\";\n\n// Version\nexport const version = \"1.0.0-alpha.0\";\n"]}